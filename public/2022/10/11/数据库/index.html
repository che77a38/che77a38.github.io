<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">


<link rel="stylesheet" href="/blog/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zeroko14.gitee.io","root":"/blog/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="数据库是为了实现一定的目的按某种规则组织起来的数据的集合, 简单的说,数据库就是存储数据的库.">
<meta property="og:type" content="article">
<meta property="og:title" content="数据库">
<meta property="og:url" content="http://zeroko14.gitee.io/blog/2022/10/11/%E6%95%B0%E6%8D%AE%E5%BA%93/index.html">
<meta property="og:site_name" content="ZEROKO14的个人博客">
<meta property="og:description" content="数据库是为了实现一定的目的按某种规则组织起来的数据的集合, 简单的说,数据库就是存储数据的库.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210121542288.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210151419807.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210151421976.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210151421152.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210151428318.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210261717113.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210261732808.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210151722300.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210151735254.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210151738265.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191639980.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191720152.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210161727853.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210161727812.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191135012.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191138144.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191146163.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191149773.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191431201.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191613017.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191532530.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210201658550.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210201801063.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210211432867.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210211602703.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210281618481.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210231341844.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210231519944.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210241436648.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301136512.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301356829.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301443749.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301726678.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301732417.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301742376.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301750340.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301802641.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301808026.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301811721.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210311123690.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210311420970.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210311558213.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210311738498.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202211141522005.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202211221646758.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202211221724158.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202212241530981.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202212311521546.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202212311525657.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202212311543694.png">
<meta property="og:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202212311543177.png">
<meta property="article:published_time" content="2022-10-11T06:06:33.431Z">
<meta property="article:modified_time" content="2023-02-10T11:01:59.821Z">
<meta property="article:author" content="ZEROKO14">
<meta property="article:tag" content="数据库">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210121542288.png">

<link rel="canonical" href="http://zeroko14.gitee.io/blog/2022/10/11/%E6%95%B0%E6%8D%AE%E5%BA%93/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>数据库 | ZEROKO14的个人博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ZEROKO14的个人博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">zeroko14's blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/blog/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/blog/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://zeroko14.gitee.io/blog/2022/10/11/%E6%95%B0%E6%8D%AE%E5%BA%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="ZEROKO14">
      <meta itemprop="description" content="你好，欢迎来到ZEROKO14的个人博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZEROKO14的个人博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          数据库
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-10-11 14:06:33" itemprop="dateCreated datePublished" datetime="2022-10-11T14:06:33+08:00">2022-10-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-02-10 19:01:59" itemprop="dateModified" datetime="2023-02-10T19:01:59+08:00">2023-02-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/%E6%8A%80%E6%9C%AF/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>数据库是为了实现一定的目的按某种规则组织起来的数据的集合, 简单的说,数据库就是存储数据的库.</p>
<span id="more"></span>

<p><strong>常见数据库</strong></p>
<p>1 oracle公司的oracle数据库<br>2 IBM公司的DB2数据库<br>3 Informix公司的Informix数据库<br>4 sysbase公司的sysbase数据库<br>5 Microsoft公司的SQL Server<br>6 oracle的MySQL数据库（开始属于mysql公司，后来mysql被sun收购，sun又被oracle收购）<br>7 MongoDB数据库(json键值对的非关系数据库)</p>
<h1 id="oracle"><a href="#oracle" class="headerlink" title="oracle"></a>oracle</h1><p>Oracle是殷墟（yīn Xu）出土的甲骨文（oracle bone inscriptions）的英文翻译的第一个单词。</p>
<p>Oracle公司成立于1977年，总部位于美国加州；</p>
<p>Oracle数据库是Oracle（中文名称叫甲骨文）公司的核心产品，Oracle数据库是一个适合于大中型企业的数据库管理系统。在所有的数据库管理系统中（比如：微软的SQL Server，IBM的DB2等），Oracle的主要用户涉及面非常广, 包括: 银行、电信、移动通信、航空、保险、金融、电子商务和跨国公司等。</p>
<p>Oracle数据库的一些版本有：Oracle7、Oracle8i、Oracle9i，Oracle10g到Oracle11g，Oracle12c， 各个版本之间的操作存在一定的差别，但是<strong>操作oracle数据库都使用的是标准的SQL语句，因此对于各个版本的差别不大</strong>。</p>
<p>2008年1月16日 收购bea，目的是为了得到weblogic（web服务器的框架，免费的对应的tomcat）。<br>2008年1月16日 sun公司收购了mysql 。<br>2009年4月20日 oracle收购了sun 。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zouxun660/article/details/126232529">windows oracle数据库安装参考</a></p>
<p><a target="_blank" rel="noopener" href="https://www.oracle.com/database/technologies/oracle-database-software-downloads.html">官网安装路径</a></p>
<p><strong>Oracle服务器</strong>：是一个<strong>数据管理系统(RDBMS)<strong>，它提供开放的, 全面的, 近乎完整的信息管理。由</strong>1个数据库和一个（或多个）实例(可以简单理解成就是进程)组成</strong>。数据库位于硬盘上，实例位于内存中。</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210121542288.png" alt="image-20221012154245368"></p>
<p>oracle非常耗费内存</p>
<p><strong>表空间和数据文件</strong></p>
<p>逻辑概念：表空间是由多个数据文件组成，位于实例上，在内存中。<br>物理概念：数据文件，在磁盘上（&#x2F;home&#x2F;oracle_11&#x2F;app&#x2F;oradata&#x2F;orcl目录中的.DBF文件）；<br>          一个表空间包含一个或者多个数据文件。</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210151419807.png" alt="image-20221015141839715"></p>
<p>段存在于表空间中，段是区的集合，区是数据块的集合，数据块会被映射到磁盘块。</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210151421976.png" alt="image-20221015142120134"></p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210151421152.png" alt="image-20221015142151286"></p>
<h2 id="DBA"><a href="#DBA" class="headerlink" title="DBA"></a>DBA</h2><p>数据库管理员（Database Administrator，简称DBA），是从事管理和维护数据库管理系统(DBMS)的相关工作人员的统称，属于运维工程师的一个分支，主要负责业务数据库从设计、测试到部署交付的全生命周期管理。DBA的核心目标是保证数据库管理系统的稳定性、安全性、完整性和高性能。从时间开销上看：安装占用6%，创建和配置占用12%，装载和存档数据占6%, 软件维护占6%，管理数据库系统占55%，可见，管理数据库系统占用了大部分的时间开销。</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210151428318.png" alt="image-20221015142827073"></p>
<h2 id="启动数据库服务"><a href="#启动数据库服务" class="headerlink" title="启动数据库服务"></a>启动数据库服务</h2><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>Windows启动oracle数据库服务：<br>启动服务：services.msc，找到下列两个服务，并启动。</p>
<ul>
<li><code>OracleServiceORCL</code>： oracle数据库服务系统</li>
<li><code>home1TNSListene</code>： 监听服务，用于远程连接的侦听</li>
</ul>
<p>注意：若把数据库默认设置为自启动，则开机时间会延长。</p>
<h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><p>Linux启动oracle数据库服务步骤(oracle数据库系统安装到linux系统上)</p>
<ol>
<li>执行<code>sqlplus / as sysdba</code>或<code>sqlplus sys/sys as sysdba</code>进入到命令行界面</li>
<li>执行<code>startup</code>启动数据库服务</li>
<li>执行<code>exit</code>退出<code>sqlplus命令行界面</code></li>
<li>执行<code>lsnrctl start</code>启动监听服务</li>
</ol>
<p>注意：通过远程客户端连接oracle服务端必须要启动监听服务，否则客户端连接不上。</p>
<p>sqlplus命令行界面下还可以使用 <code>shutdown immeidate</code>停止数据库服务</p>
<h2 id="登录数据库服务"><a href="#登录数据库服务" class="headerlink" title="登录数据库服务"></a>登录数据库服务</h2><h3 id="本机登陆"><a href="#本机登陆" class="headerlink" title="本机登陆"></a>本机登陆</h3><ul>
<li><p>普通用户身份登陆</p>
<p>sqlplus  ↙ 用户名 ↙	密码 ↙</p>
<p><code>sqlplus 用户名/密码</code>，如sqlplus scott&#x2F;tiger</p>
</li>
<li><p>以管理员身份登陆</p>
<p><code>sqlplus  /  as  sysdba</code>（此处不用输入密码，在安装的时候已经输入密码）</p>
<p><code>sqlplus sys/sys as sysdba</code></p>
</li>
</ul>
<h3 id="远程登陆"><a href="#远程登陆" class="headerlink" title="远程登陆"></a>远程登陆</h3><p> 远程通过网络登陆数据库需要安装oracle客户端软件，并进行配置才能使用，可通过使用net manager进行配置，配置完成之后可以使用连接字符串进行登陆，连接字符串中包含了数据库服务的IP地址和端口，以及实例名。</p>
<p>注意：安装oracle客户端的时候，安装路径中不能出现中文和空格，安装的时候选择管理员模式。</p>
<ul>
<li><p>普通用户登陆</p>
<p><code>sqlplus 用户名/密码@连接字符串</code>，如<code>sqlplus scott/tiger@oracle_orcl</code></p>
</li>
<li><p>管理员用户登陆</p>
<p><code>sqlplus sys/sys@oracle_orcl as sysdba</code></p>
</li>
</ul>
<p> 此外：还可以执行： <code>sqlplus scott/tiger@//IP地址/实例名</code>        进行登陆。<br>    使用scott用户或者sys用户登陆完之后，可以使用<code>show user</code>测试一下，如果显示用户名就表明已经登陆成功了，或者是执行<code>select * from tab；</code>进行一次查询, 有结果显示就表名已经登陆成功了.</p>
<p>相关命令</p>
<ul>
<li><p>解锁用户：<code>alter user scott account unlock</code> (管理员身份登陆，给scott用户解锁。用户默认锁定)</p>
</li>
<li><p>锁定用户：<code>alter user scott account lock</code>，（必须用管理员用户登陆）</p>
</li>
<li><p>修改用户密码：<code>alter user scott identified by 新密码</code>    (管理员身份登陆，给scott用户修改密码)</p>
<p>修改用户密码也可以直接 <code>password scott 新密码</code>(scott用户本身修改自身密码的话可以省略scott)</p>
</li>
<li><p>查看当前语言环境：<code>select userenv(&#39;language&#39;) from dual;</code></p>
</li>
</ul>
<p>加锁后,对应加锁的用户就不能登录了,解锁后该用户才能登录</p>
<h3 id="oracle创建案例脚本"><a href="#oracle创建案例脚本" class="headerlink" title="oracle创建案例脚本"></a>oracle创建案例脚本</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 01 创建表空间</span></span><br><span class="line"><span class="comment">-- 注意表空间的路径 根据实际安装环境进行调整</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span>SPACE ts_seckey_admin </span><br><span class="line">    LOGGING  </span><br><span class="line">    DATAFILE <span class="string">&#x27;/u01/app/oracle/oradata/orcl/ts_seckeymng_admin.dbf&#x27;</span> SIZE <span class="number">50</span>M </span><br><span class="line">    EXTENT MANAGEMENT <span class="keyword">LOCAL</span>;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span>SPACE ts_seckey_op</span><br><span class="line">    LOGGING </span><br><span class="line">    DATAFILE <span class="string">&#x27;/u01/app/oracle/oradata/orcl/ts_seckeymng_op.dbf&#x27;</span> SIZE <span class="number">200</span>M</span><br><span class="line">    EXTENT MANAGEMENT <span class="keyword">LOCAL</span>;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">ALTER</span> DATABASE DATAFILE <span class="string">&#x27;/u01/app/oracle/oradata/orcl/ts_seckeymng_admin.dbf&#x27;</span> AUTOEXTEND <span class="keyword">ON</span> NEXT   <span class="number">50</span>M MAXSIZE UNLIMITED;</span><br><span class="line"><span class="keyword">ALTER</span> DATABASE DATAFILE <span class="string">&#x27;/u01/app/oracle/oradata/orcl/ts_seckeymng_op.dbf&#x27;</span> AUTOEXTEND <span class="keyword">ON</span> NEXT  <span class="number">200</span>M MAXSIZE UNLIMITED; </span><br><span class="line"></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 02 创建方案 (创建用户)</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> SECMNG  PROFILE <span class="keyword">DEFAULT</span> </span><br><span class="line">    IDENTIFIED <span class="keyword">BY</span> SECMNG <span class="keyword">DEFAULT</span> TABLESPACE USERS</span><br><span class="line">    ACCOUNT UNLOCK;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 资源和登录权限</span></span><br><span class="line"><span class="keyword">GRANT</span> resource <span class="keyword">TO</span> SECMNG;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">create</span> session <span class="keyword">TO</span> SECMNG;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建 网点信息表 --编号 名称 描述 授权码 状态(0可用  1不可用)</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SECMNG.SECNODE(</span><br><span class="line">	id     				<span class="type">char</span>(<span class="number">4</span>) <span class="keyword">PRIMARY</span> KEY, </span><br><span class="line">	name     			VARCHAR2(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> 	nodedesc      		VARCHAR2(<span class="number">512</span>),</span><br><span class="line"> 	createtime			<span class="type">date</span>,</span><br><span class="line"> 	authcode			NUMBER(<span class="number">12</span>),</span><br><span class="line"> 	state     			NUMBER(<span class="number">4</span>)</span><br><span class="line">)TABLESPACE ts_seckey_admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> SECMNG.secnode <span class="keyword">VALUES</span>(<span class="string">&#x27;0001&#x27;</span>, <span class="string">&#x27;网银中心&#x27;</span>, <span class="string">&#x27;北京金融街23号&#x27;</span>, <span class="string">&#x27;15-7月-15&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> SECMNG.secnode <span class="keyword">VALUES</span>(<span class="string">&#x27;1111&#x27;</span>, <span class="string">&#x27;广东分中心1111&#x27;</span>, <span class="string">&#x27;广州天河金融&#x27;</span>, <span class="string">&#x27;15-7月-15&#x27;</span>, <span class="number">1111</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建 网点密钥表, 客户端网点 服务器端网点 密钥号 密钥产生时间 密钥状态 </span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SECMNG.SECKEYINFO(</span><br><span class="line">	clientid          	<span class="type">char</span>(<span class="number">4</span>) <span class="keyword">constraint</span> secmng_seckeynode_clientid_fk <span class="keyword">references</span> SECMNG.SECNODE(id),</span><br><span class="line">	serverid          	<span class="type">char</span>(<span class="number">4</span>) <span class="keyword">constraint</span> secmng_seckeynode_serverid_fk <span class="keyword">references</span> SECMNG.SECNODE(id),</span><br><span class="line">	keyid            	NUMBER(<span class="number">9</span>) <span class="keyword">PRIMARY</span> KEY, </span><br><span class="line">	createtime			<span class="type">date</span>,</span><br><span class="line">	state				NUMBER(<span class="number">4</span>),</span><br><span class="line">	seckey				VARCHAR2(<span class="number">512</span>)</span><br><span class="line">)TABLESPACE ts_seckey_admin;</span><br><span class="line"></span><br><span class="line"><span class="comment">--创建索引 在新的表空间上</span></span><br><span class="line"><span class="keyword">CREATE</span>  INDEX SECMNG.IX_SECKEYINFO_clientid <span class="keyword">ON</span> SECMNG.SECKEYINFO(clientid) TABLESPACE ts_seckey_admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- keysn序列号</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SECMNG.KEYSN(</span><br><span class="line">	ikeysn 		number(<span class="number">12</span>)  <span class="keyword">PRIMARY</span> KEY</span><br><span class="line">) TABLESPACE ts_seckey_admin;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> SECMNG.KEYSN(ikeysn) <span class="keyword">VALUES</span> (<span class="number">1</span>);</span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SECMNG.SRVCFG(</span><br><span class="line">	key				VARCHAR2(<span class="number">64</span>),</span><br><span class="line">	valude			VARCHAR2(<span class="number">128</span>)</span><br><span class="line">)TABLESPACE ts_seckey_admin;</span><br><span class="line">	</span><br><span class="line"><span class="comment">-- 创建 交易信息表 交易者 交易时间 交易事件 交易描述 （什么人 在什么时间 干了什么事）</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> SECMNG.TRAN(</span><br><span class="line">	iID					Number(<span class="number">12</span>) <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line"> 	tran_operator     	NUMBER,</span><br><span class="line"> 	trantime			<span class="type">date</span>,</span><br><span class="line"> 	tranid          	NUMBER(<span class="number">4</span>),</span><br><span class="line"> 	trandesc      		VARCHAR2(<span class="number">512</span>)	</span><br><span class="line">)TABLESPACE ts_seckey_op;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建索引</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX SECMNG.IX_TRAN_tran_operator <span class="keyword">ON</span> SECMNG.TRAN(tran_operator) TABLESPACE ts_seckey_op;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建触发器 自增字段</span></span><br><span class="line"><span class="keyword">CREATE</span> SEQUENCE SECMNG.SEQiID INCREMENT <span class="keyword">BY</span> <span class="number">1</span> <span class="keyword">START</span> <span class="keyword">WITH</span> <span class="number">1</span> </span><br><span class="line">    MAXVALUE <span class="number">1.0E28</span> MINVALUE <span class="number">1</span> NOCYCLE </span><br><span class="line">    CACHE <span class="number">20</span> NOORDER;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">TRIGGER</span> SECMNG.SEQiID</span><br><span class="line">  BEFORE <span class="keyword">INSERT</span> <span class="keyword">ON</span> SECMNG.TRAN</span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">select</span> SECMNG.SEQiID.nextval <span class="keyword">into</span> :new.iID <span class="keyword">from</span> dual;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> SECMNG.TRAN(tran_operator, trantime, tranid, trandesc) <span class="keyword">VALUES</span>(<span class="number">1</span>, <span class="string">&#x27;15-7月-15&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;创建网银总节点-测试数据&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">------停止-----</span></span><br><span class="line"><span class="comment">-- 04创建新用户方案 	通过 SECMNGUSER1 来访问数据库, 让管理终端系统用   </span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> &quot;SECMNGADMIN&quot;  PROFILE &quot;DEFAULT&quot; IDENTIFIED <span class="keyword">BY</span> &quot;123456&quot; <span class="keyword">DEFAULT</span> TABLESPACE &quot;USERS&quot; ACCOUNT UNLOCK;</span><br><span class="line"></span><br><span class="line"><span class="keyword">GRANT</span> &quot;CONNECT&quot; <span class="keyword">TO</span> &quot;SECMNGADMIN&quot;;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span> <span class="keyword">ANY</span> <span class="keyword">TABLE</span> <span class="keyword">TO</span> &quot;SECMNGADMIN&quot;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">GRANT</span> resource <span class="keyword">TO</span> SECMNGADMIN;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">create</span> session <span class="keyword">TO</span> SECMNGADMIN;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">DELETE</span> <span class="keyword">ON</span> SECMNG.SRVCFG <span class="keyword">TO</span> &quot;SECMNGADMIN&quot;;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">INSERT</span> <span class="keyword">ON</span> SECMNG.SRVCFG <span class="keyword">TO</span> &quot;SECMNGADMIN&quot;;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">UPDATE</span> <span class="keyword">ON</span> SECMNG.SRVCFG <span class="keyword">TO</span> &quot;SECMNGADMIN&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">DELETE</span> <span class="keyword">ON</span> SECMNG.SECNODE <span class="keyword">TO</span> &quot;SECMNGADMIN&quot;;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">INSERT</span> <span class="keyword">ON</span> SECMNG.SECNODE <span class="keyword">TO</span> &quot;SECMNGADMIN&quot;;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">UPDATE</span> <span class="keyword">ON</span> SECMNG.SECNODE <span class="keyword">TO</span> &quot;SECMNGADMIN&quot;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">DELETE</span> <span class="keyword">ON</span> SECMNG.SECKEYINFO <span class="keyword">TO</span> &quot;SECMNGADMIN&quot;;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">INSERT</span> <span class="keyword">ON</span> SECMNG.SECKEYINFO <span class="keyword">TO</span> &quot;SECMNGADMIN&quot;;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">UPDATE</span> <span class="keyword">ON</span> SECMNG.SECKEYINFO <span class="keyword">TO</span> &quot;SECMNGADMIN&quot;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">DELETE</span> <span class="keyword">ON</span> SECMNG.TRAN <span class="keyword">TO</span> &quot;SECMNGADMIN&quot;;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">INSERT</span> <span class="keyword">ON</span> SECMNG.TRAN <span class="keyword">TO</span> &quot;SECMNGADMIN&quot;;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">UPDATE</span> <span class="keyword">ON</span> SECMNG.TRAN <span class="keyword">TO</span> &quot;SECMNGADMIN&quot;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"> </span><br><span class="line"><span class="comment">-- Insert Into SECMNG.SECKEYINFO(clientid, serverid, keyid, createtime, state, seckey)</span></span><br><span class="line"><span class="comment">-- values (&#x27;1111&#x27;, &#x27;0001&#x27;, 1, to_date(&#x27;2015-07-14 21:09:09&#x27;, &#x27;yyyy-mm-dd hh24:mi:ss&#x27;), 0, &#x27;zzz&#x27;)  ;</span></span><br></pre></td></tr></table></figure>

<h1 id="sql和sqlplus"><a href="#sql和sqlplus" class="headerlink" title="sql和sqlplus"></a>sql和sqlplus</h1><p>sql和sqlplus的区别:</p>
<ul>
<li>SQL是语言，关键字不能缩写。</li>
<li>sqlplus是oracle提供的工具，可在里面执行SQL语句，它配有自己的命令(ed、c、set、col、spool) 特点是缩写关键字。</li>
</ul>
<h2 id="sqlplus常用命令"><a href="#sqlplus常用命令" class="headerlink" title="sqlplus常用命令"></a>sqlplus常用命令</h2><ul>
<li><p>显示当前用户： 	<code>SQL&gt; show user;</code></p>
</li>
<li><p>查看当前用户下的表：	<code>SQL&gt; select * from tab;</code>		</p>
<p>​	tab:	数据字典（记录数据库和应用程序源数据的目录），包含当前用户下的表。</p>
</li>
<li><p>查看员工表的结构：	<code>SQL&gt; desc emp;</code>		(desc  →  description 描述)</p>
</li>
<li><p>设置行宽：<code>set linesize 120;</code></p>
</li>
<li><p>设置页面：<code>set pagesize 100;</code></p>
<p>或者将上述两行写入如下两个配置文件，可永久设置：</p>
<ul>
<li><code>C:\app\Administrator\product\11.2.0\client_1\sqlplus\admin\glogin.sql</code> </li>
<li><code>C:\app\Administrator\product\11.2.0\dbhome_1\sqlplus\admin\glogin.sql</code></li>
</ul>
</li>
<li><p>设置员工名列宽：<code>col ename for a20</code>			(a表示字符串)</p>
</li>
<li><p>设置薪水列为4位数子：<code>col sal for 9999</code>		(一个9表示一位数字)</p>
</li>
<li><p>若想将显示结果保存到文件中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spool d:\result.txt;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp;</span><br><span class="line">spool off;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ed(或者edit)命令打开文件来编写sql语句,注意, sql语句末尾不要加<code>;</code>  , 然后换行加上<code>/</code>表示结束</p>
</li>
<li><p>修改日期格式,日期格式默认为<code>DD-MON-RR</code>,修改日期格式方式为: <code>alter session set NLS_DATE_FORMAT = &#39;yyyy-mm-dd hh24:mi:ss&#39;;</code>  查看当前会话使用的日期格式 : <code>select * from v$nls_parameters;</code></p>
</li>
<li><p>开关显示SQL的执行时间： <code>set timing on/off</code></p>
</li>
<li><p><code>/</code>表示重复刚刚执行过的sql语句.</p>
</li>
<li><p><code>start sql脚本路径</code>或 <code>@ sql脚本路径</code> 可以运行sql脚本</p>
</li>
<li><p><code>set feedback on/off</code>开关回显</p>
</li>
</ul>
<h3 id="管理员创建用户"><a href="#管理员创建用户" class="headerlink" title="管理员创建用户"></a>管理员创建用户</h3><p><code>create user 用户名 identified by 密码;</code>  创建用户(刚创建的用户连连接数据库的权限都没有)</p>
<p><code>grant connect ,resource to 用户名;</code>  一般都要赋予最基本的连接数据库权限<code>connect</code>和访问资源的权限 <code>resource</code></p>
<h2 id="SQL语言的类型"><a href="#SQL语言的类型" class="headerlink" title="SQL语言的类型"></a>SQL语言的类型</h2><ol>
<li>数据库中，称呼 <strong><a href="#sql%E6%8F%92%E5%85%A5%E7%9B%B8%E5%85%B3">增</a> <a href="#sql%E5%88%A0%E9%99%A4%E7%9B%B8%E5%85%B3">删</a> <a href="#sql%E4%BF%AE%E6%94%B9%E7%9B%B8%E5%85%B3">改</a> <a href="#sql%E6%9F%A5%E8%AF%A2%E7%9B%B8%E5%85%B3">查</a><strong>，为</strong>DML语句</strong>。(<strong>Data Manipulation Language 数据操纵</strong><br><strong>语言</strong>)，就是指代：<code>insert</code>、<code>update</code>、<code>delete</code>、<code>select</code>这四个操作。</li>
<li>**<a href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1">DDL语句</a>**。(<strong>Data Definition Language 数据定义语言</strong>)。	<br>如：<code>truncate table(截断/清空一张表)</code><br><code>create table(表)</code>、<code>create view(视图)</code>、<code>create index(索引)</code>、<code>create sequence(序列)</code>、<br><code>create synonym(同义词)</code>、<code>alter table</code>、<code>drop table</code>。</li>
<li><strong>DCL语句</strong>。DCL（<strong>Data Control Language数据控制语言</strong>）如：<br><code>commit(提交)</code>、<code>rollback(回滚)</code></li>
</ol>
<h1 id="数据库对象"><a href="#数据库对象" class="headerlink" title="数据库对象"></a>数据库对象</h1><p>数据库对象共有12个,分别是:  表,视图,索引,序列,同义词,存储过程,存储函数,触发器,包,包体,数据库链路(datalink),快照</p>
<p><strong>常见的数据库对象</strong></p>
<ul>
<li><a href="#%E8%A1%A8">表</a>		    基本的数据存储集合，由行和列组成。</li>
<li>视图	    从表中抽出的逻辑上相关的数据集合。</li>
<li>序列	    提供有规律的数值。</li>
<li>索引        提高查询的效率</li>
<li>同义词	给对象起别名</li>
</ul>
<h2 id="表"><a href="#表" class="headerlink" title="表"></a>表</h2><p>基本的数据存储集合，由行和列组成。表名和列名遵循如下<strong>命名规则</strong>：</p>
<ul>
<li>必须以字母开头</li>
<li>必须在 1–30 个字符之间</li>
<li>必须只能包含 A–Z, a–z, 0–9, _, $, 和#</li>
<li>必须不能和用户定义的其他对象重名</li>
<li>必须不能是Oracle 的保留字</li>
<li>Oracle默认存储是都存为大写</li>
<li>数据库名只能是1~8位, datalink可以是128位, 和其他一些特殊字符</li>
</ul>
<h3 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h3><p>关键词   <strong><code>Create Table</code></strong></p>
<p>创建一张表必须具备：1. Create Table的权限 2. 存储空间。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test1 (tid number, tname varchar2(<span class="number">20</span>), hiredate <span class="type">date</span> <span class="keyword">default</span> sysdate);</span><br></pre></td></tr></table></figure>

<p><code>default</code>的作用是, 当向表中插入数据的时候, 没有指定时间的时候, 使用默认值<code>sysdate</code>。</p>
<p>创建表时，列所使用的数据类型：	</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210261717113.png" alt="image-20221026171754801"></p>
<ul>
<li><p><code>varchar2(size)</code>中的<code>size</code>表示可变长的最大值</p>
</li>
<li><p><code>number(p,s)</code>中的p表示数值的总长度,s表示小数点长度(6200.00,p为6,s为2)</p>
</li>
<li><p><code>rowid</code>：行地址 ——伪列<br><code>select rowid, empno, deptno from emp;</code><br>看到该列存储的是一系列的地址(指针), 创建索引用.</p>
<img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210261732808.png" alt="image-20221026173208069" style="zoom:67%;" /></li>
</ul>
<p><strong>[[注意]]</strong> <code>create table as select子句</code>的格式中,后面select后的<strong>表达式要取别名(语法要求)</strong></p>
<p><a href="#%E6%89%B9%E5%A4%84%E7%90%86">相关语法参考批处理标题</a></p>
<h3 id="修改表"><a href="#修改表" class="headerlink" title="修改表"></a>修改表</h3><p>关键词	<strong><code>ALTER TABLE</code></strong>	</p>
<ul>
<li><p><strong>追加一列</strong>: <strong><code>add</code></strong>  向test1表中加入新列 image 类型是blob</p>
<p><code>alter table test1 add image blob;</code>			</p>
</li>
<li><p><strong>修改一列</strong>: <strong><code>modify</code></strong>  将tname列的大小由20→40.</p>
<p><code>alter table test1 modify tname varchar2(40);</code></p>
</li>
<li><p><strong>删除一列</strong>: <strong><code>dropcolumn</code></strong>  将刚加入的新列image删除.</p>
<p><code>alter table test1 dropcolumn image;</code></p>
</li>
<li><p><strong>重命名一列</strong>: <strong><code>renamecolumn</code></strong>  将列tname重命名为username.</p>
<p><code>alter table test1 renamecolumn tname to username;</code></p>
</li>
</ul>
<p><strong>注意</strong>: 若是修改表的字段的长度, 若是增加长度没有问题, 若是减少字段的长度, 有可能会报错.</p>
<p>修改表名:   <code>rename 原表名 to  新表名</code></p>
<h3 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h3><p>关键词   <strong><code>drop table</code></strong></p>
<p>当表被删除：</p>
<ul>
<li>数据和结构都被删除</li>
<li>所有正在运行的相关事物被提交</li>
<li>所有相关索引被删除</li>
<li><code>DROP TABLE</code>语句不能回滚，但是可以闪回</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tab;		查看当前用户下有哪些表, 拷贝保存表名。</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> testsp;		将测试保存点的表删除。	</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tab;		再次查询跟刚刚保存的表名比对，少了testsp，但多了另外一张命名复杂的表。</span><br></pre></td></tr></table></figure>

<h4 id="Oracle的回收站"><a href="#Oracle的回收站" class="headerlink" title="Oracle的回收站"></a>Oracle的回收站</h4><ul>
<li>查看回收站：<code>show recyclebin</code>(sqlplus 命令)那个复杂的命名即是testsp在回收站中的名字。</li>
<li>清空回收站：<code>purge recyclebin</code></li>
<li>将表从回收站<strong>闪回</strong><code>flashback table t2 to before drop;</code></li>
</ul>
<p><strong>注意：并不是所有的用户都有“回收站”，对于没有回收站的用户（管理员）来说，删除操作是不可逆的.</strong></p>
<h4 id="两种删除方式"><a href="#两种删除方式" class="headerlink" title="两种删除方式"></a>两种删除方式</h4><ul>
<li><code>drop table tbl;</code>      删除的表可以闪回</li>
<li><code>drop table tbl purge;</code>       purge的作用:删除不经过回收站,删除的表不可以闪回</li>
</ul>
<h3 id="表的约束"><a href="#表的约束" class="headerlink" title="表的约束"></a>表的约束</h3><p>表的约束有5种:   (<strong><code>关键词</code></strong>)</p>
<ul>
<li><strong>检查</strong>   值是否符合预设的规则(比如性别只能男或女)  (<strong><code>check</code></strong>)</li>
<li><strong>非空 **    (</strong><code>not null</code>**)</li>
<li><strong>唯一</strong>   不能重复   (<strong><code>unique</code></strong>)</li>
<li><strong>主键</strong>    非空+唯一   (<strong><code>primary key</code></strong>)</li>
<li><strong>外键</strong>(foreign key)    取值必须在另外一个表中存在  (<strong><code>references</code></strong>)</li>
</ul>
<p><strong>[注意]   设置外键的目标必须是父表的主键.</strong></p>
<p>修改表增加主键约束</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> dept_bak <span class="keyword">add</span> <span class="keyword">constraint</span> pk_dept_bak <span class="keyword">primary</span> key (deptno);</span><br></pre></td></tr></table></figure>

<p>create table中设置约束:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student </span><br><span class="line">(</span><br><span class="line">		sid number <span class="keyword">constraint</span> student_PK <span class="keyword">primary</span> key,  			     </span><br><span class="line">  	#学生Id主键约束</span><br><span class="line">		sname varchar2(<span class="number">20</span>) <span class="keyword">constraint</span> student_name_notnull <span class="keyword">not</span> <span class="keyword">null</span>, 	</span><br><span class="line">  	#学生姓名非空约束</span><br><span class="line">		email varchar2(<span class="number">20</span>) <span class="keyword">constraint</span> student_email_unique <span class="keyword">unique</span>		</span><br><span class="line">  	#学生邮件唯一约束</span><br><span class="line">		<span class="keyword">constraint</span> student_email_notnull <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">  	#同时邮件可再设非空，没有,</span><br><span class="line">		age number <span class="keyword">constraint</span> student_age_min <span class="keyword">check</span>(age <span class="operator">&gt;</span> <span class="number">10</span>),	      </span><br><span class="line">  	#学生年龄设置<span class="keyword">check</span>约束</span><br><span class="line">		gender varchar2(<span class="number">6</span>) <span class="keyword">constraint</span> gender_female_or_male <span class="keyword">check</span>(gender <span class="keyword">in</span> (<span class="string">&#x27;男&#x27;</span>, <span class="string">&#x27;女&#x27;</span>)),</span><br><span class="line">  	#学生性别设置<span class="keyword">check</span>约束</span><br><span class="line">		deptno number <span class="keyword">constraint</span> student_FK <span class="keyword">references</span> dept(deptno) <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">SET</span> <span class="keyword">NULL</span> </span><br><span class="line">  	#学生部门号设置外键</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>上述代码中,<code>deptno number constraint student_FK references dept</code> 设置了删除了dept表中的某个deptno后,student表中的所有那个值的deptno的全部设置空.如果不加 <code>ON DELETE SET NULL</code>则删除dept表中的值会报错,除非删除行的deptno值在student表中不存在.</p>
<h4 id="外键的删除相关"><a href="#外键的删除相关" class="headerlink" title="外键的删除相关"></a>外键的删除相关</h4><ul>
<li><p><strong>cascade</strong>  级联删除,主表记录删除的时候,子表引用了该字段的数据跟着删除</p>
<p><code>drop table dept_bak cascade constraints;</code></p>
</li>
<li><p><strong>set null</strong>  设置为null,主表删除的时候,子表该字段设为null</p>
</li>
<li><p><strong>默认方式</strong>  主表删除的时候,如果子表引用了该字段的数据,不能删除,要先删子表</p>
</li>
</ul>
<p>通过<code>references</code>定义外键的时候可以用如下参数</p>
<ul>
<li><code>on delete cascade</code> </li>
<li><code>on delete set null</code>(多数情况下使用这种方法)</li>
</ul>
<h4 id="check检查性约束"><a href="#check检查性约束" class="headerlink" title="check检查性约束"></a>check检查性约束</h4><p>格式  <strong><code>check(条件)</code></strong></p>
<p>违反检查约束插入报错: ORA-02290：违反检查约束条件</p>
<p>定义约束时没有显式指定名字，系统会默认给一个名称.建议创建约束的时候自定义一个含义清晰的约束名</p>
<p><strong><code>constraint</code></strong>: 使用该关键字，来给约束起别名。</p>
<hr>
<p><strong>查看指定表的约束:</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> constraint_name, constraint_Type, search_condition <span class="keyword">from</span> user_constraints <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;STUDENT&#x27;</span>;	</span><br></pre></td></tr></table></figure>

<p><strong>注意:上面STUDENT位置的表名必须大写</strong></p>
<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><p>视图是一种常见数据库对象, 它是<strong>从表中抽出的逻辑上相关的数据集合</strong>。</p>
<ul>
<li>视图基于表</li>
<li>视图是<strong>逻辑概念</strong></li>
<li>视图本身没有数据</li>
</ul>
<p>使用视图的好处:</p>
<ul>
<li>可以简化查询,将视图看做是表的复杂的SQL一种封装</li>
<li>可以<strong>限制用户对某些数据的访问</strong></li>
</ul>
<p>[注意] 建议不要通过视图去修改表的数据,即使不是只读视图</p>
<h3 id="视图相关操作"><a href="#视图相关操作" class="headerlink" title="视图相关操作"></a>视图相关操作</h3><ul>
<li><p><strong>创建视图</strong>    <code>create view 视图名 as  sql查询语句;</code></p>
<p>创建视图需要 <code>create view</code> 权限</p>
<p>创建<strong>只读视图</strong>  <code>create view 视图名 as sql查询语句 with read only;</code></p>
<p><code>with check option</code>  要符合视图创建时的条件才能修改原数据</p>
</li>
<li><p><strong>创建或更新视图</strong>  <code>create or replace view 视图名 as 查询语句;</code>   (<code>replace</code>不能单独使用)</p>
</li>
<li><p><strong>查看所有已创建的视图</strong>    <code>select view_name from user_views;</code></p>
</li>
<li><p><strong>删除视图</strong>    <code>drop view 视图名;</code></p>
</li>
</ul>
<p>创建视图需要 <code>create view</code> 权限,添加权限步骤:</p>
<ol>
<li>使用管理员登陆：<code>sqlplus / as sysdba</code></li>
<li>给scott用户增加权限 <code>grant create view to scott;</code> (<code>revoke</code>关键词可以撤销权限)</li>
</ol>
<p>视图中使用DML的规定：														<br>一：<br>当视图定义中包含以下元素之一时不能使用delete:<br>	组函数<br>	GROUP BY 子句<br>	DISTINCT 关键字<br>	ROWNUM 伪列<br>二：<br>    当视图定义中包含以下元素之一时不能使用update :<br>	组函数<br>	GROUP BY子句<br>	DISTINCT 关键字<br>	ROWNUM 伪列<br>	列的定义为表达式<br>三：<br>    当视图定义中包含以下元素之一时不能使用insert :<br>	组函数<br>	GROUP BY 子句<br>	DISTINCT 关键字<br>	ROWNUM 伪列<br>	列的定义为表达式<br>	表中非空的列在视图定义中未包括<br>总结一句话：<strong>不通过视图做<code>insert</code>、<code>update</code>、<code>delete</code>操作。因为视图提供的目的就是为了简化查询。</strong></p>
<h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><p>索引，相当于书的目录，提高数据检索速度。提高效率（视图不可以提高效率）</p>
<ul>
<li>一种独立于表的模式对象, 可以存储在与表不同的磁盘或表空间中</li>
<li>索引被删除或损坏, 不会对表产生影响, 其影响的只是查询的速度</li>
<li>索引一旦建立, Oracle 管理系统会对其进行自动维护, 而且由 Oracle 管理系统决定何时使用索引. 用户不用在查询语句中指定使用哪个索引</li>
<li>在删除一个表时, 所有基于该表的索引会自动被删除</li>
<li>通过指针加速 Oracle 服务器的查询速度</li>
<li>通过快速定位数据的方法，减少磁盘 I&#x2F;O</li>
</ul>
<p><strong>使用索引注意点</strong>: 使用索引的列值的<strong>分布要广泛</strong>,重复的概率非常低,<strong>唯一最好</strong>.</p>
<p>索引的原理:若一个表有索引,则oracle会在内部维护一个索引表,查询的时候要使用索引的列,优先会到索引表中去查,通过索引的列找到对应的行地址,找到行地址就可以找到数据.</p>
<p><strong>索引表中的列的值是有序的.</strong></p>
<p>使用主键查询数据最快速，因为主键本身就是“唯一索引”，所以检索比较快</p>
<p>Oracle的数据库中，索引有 B树索引（默认）和位图索引两种。</p>
<p>推荐创建索引的三种情况:</p>
<ul>
<li>列中数据值分布范围很广</li>
<li>列经常在 WHERE 子句或连接条件中出现</li>
<li>表经常被访问而且数据量很大, 访问的数据大概占数据总量的2%到4%</li>
</ul>
<p>下列情况不要创建索引</p>
<ul>
<li>表很小</li>
<li>列不经常作为连接条件或出现在WHERE子句中</li>
<li>查询的数据大于2%到4%</li>
<li>表经常更新</li>
</ul>
<p>对索引的理解可以理解为: 系统自动维护的一张顺序表加快了他查询的速度.</p>
<h3 id="索引的操作"><a href="#索引的操作" class="headerlink" title="索引的操作"></a>索引的操作</h3><ul>
<li><p><strong>查看所有已创建的索引</strong>  <code>select index_name from user_indexes;</code></p>
</li>
<li><p><strong>创建索引</strong>  <code>create index 索引名  on  表名(列名1，列名2…);</code> </p>
<p><strong>创键唯一索引</strong>  <code>create unique index 索引名  on  表名(列名1，列名2…);</code>    (唯一索引要求列值不重复)</p>
</li>
<li><p>删除索引   <code>drop index 索引名;</code></p>
</li>
</ul>
<h2 id="序列"><a href="#序列" class="headerlink" title="序列"></a>序列</h2><p>可以理解成数组：默认，从[1]开始，长度[20]		[1, 2, 3, 4, 5, 6, …, 20]		在内存中。</p>
<p>由于序列是被保存在内存中，访问内存的速率要高于访问硬盘的速率。所以序列可以提高效率。</p>
<p><strong>序列的用处</strong>:主要用于插入主键,并保证他的非空和唯一性</p>
<h3 id="序列的操作"><a href="#序列的操作" class="headerlink" title="序列的操作"></a>序列的操作</h3><ul>
<li><strong>创建序列</strong>  <code>create sequence 序列名;</code></li>
<li><strong>删除序列</strong>  <code>drop sequence 序列名;</code></li>
<li><strong>显示所有已创建序列</strong>   <code>select sequence_name from user_sequences;</code></li>
</ul>
<p><strong>序列的使用</strong></p>
<ol>
<li>初始状态下：指针*指向1前面的位置。欲取出第一个值，应该将指针向后移动。每取出一个值指针都向后移。</li>
<li>常常用序列来指定表中的主键。</li>
</ol>
<p>	</p>
<p>创建序列的完整格式</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> SEQUENCE sequence</span><br><span class="line">       [INCREMENT <span class="keyword">BY</span> n]    #步长</span><br><span class="line">       [<span class="keyword">START</span> <span class="keyword">WITH</span> n]      #起始值 </span><br><span class="line">       [&#123;MAXVALUE n <span class="operator">|</span> NOMAXVALUE&#125;]    #最大值</span><br><span class="line">       [&#123;MINVALUE n <span class="operator">|</span> NOMINVALUE&#125;]    #最小值</span><br><span class="line">       [&#123;<span class="keyword">CYCLE</span> <span class="operator">|</span> NOCYCLE&#125;]    #序列是否循环</span><br><span class="line">       [&#123;CACHE n <span class="operator">|</span> NOCACHE&#125;]; #序列的项个数,默认<span class="number">20</span>个(NOCACHE表示没有缓存，一次不产生<span class="number">20</span>个，而只产生一个。)</span><br></pre></td></tr></table></figure>

<p>序列的两个属性  </p>
<ul>
<li><code>currval</code>    当前值</li>
<li><code>nextval</code>    下一个值</li>
</ul>
<p><strong><code>NextVal</code> 必须在<code>CurrVal</code>之前被指定</strong>。因为初始状态下，CurrVal指向1前面的位置，无值</p>
<p>对于新创建的序列使用select myseq.currval from dual;		得到出错。<br>但select myseq.nextval from dual;		可以得到序列的第一值1.<br>此时再执行select myseq.currval from dual;	currval的值也得到1</p>
<p>只有nextval取完会向后移动，使用currval不会移动。</p>
<p>使用时按如下方式插入序列值</p>
<p><code>insert into tableA values(myseq.nextval, &amp;name)</code> </p>
<p><strong>修改序列：</strong>															<br>	必须是序列的拥有者或对序列有 ALTER 权限<br>	只有将来的序列值会被改变<br>	改变序列的初始值只能通过删除序列之后重建序列的方法实现</p>
<h3 id="使用序列需要注意的问题"><a href="#使用序列需要注意的问题" class="headerlink" title="使用序列需要注意的问题"></a>使用序列需要注意的问题</h3><ul>
<li><p>序列是公有对象，所以多张表同时使用序列，会造成主键不连续。</p>
</li>
<li><p>回滚也可能造成主键不连续。	</p>
<p>如：多次调用insert操作使用序列创建主键。但是当执行了rollback后再次使用insert借助序列创建主键的时候，nextval不会随着回滚操作回退。</p>
</li>
<li><p>掉电等原因，也可能造成不连续。由于代表序列的数组保存在内存中，断电的时候内存的内容丢失。恢复供电时候，序列直接从21开始。</p>
</li>
<li><p>插入失败的情况,但序列的值已经取了,此时的情况也会造成主键不连续</p>
</li>
</ul>
<h2 id="同义词"><a href="#同义词" class="headerlink" title="同义词"></a>同义词</h2><p><strong>同义词</strong>就是指表的别名。</p>
<h3 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h3><ol>
<li><p>scott用户想访问hr用户下的表employees。默认是不能访问的。需要hr用户为scott用户授权.</p>
<p><code>sqplus hr/11</code>		或		<code>conn hr/11</code>（已登录界面，切换登陆）</p>
</li>
<li><p>hr用户为scott用户开放了employees表的查询权限。</p>
</li>
</ol>
<p>   授权  <code>grant select on employees to scott;</code>	</p>
<ol start="3">
<li><p>这时scott用户就可以使用select语句，来查询hr用户下的employees表的信息了。</p>
<p><code>select count(*) from hr.employees;</code>   (若用户名叫zhangsanfeng则zhangsanfeng.employees)</p>
</li>
<li><p>hr.employees名字过长，为了方便操作，scott用户为它重设别名(<strong>同义词</strong>):<br><code>create synonym hremp for hr.employees;</code>  为hr.employees创建了同义词。</p>
</li>
</ol>
<p>创建同义词需要权限:管理员添加设置同义词权限操作如下:</p>
<ol>
<li><code>conn / as sysdba</code></li>
<li><code>grant create synonym to scott;</code></li>
<li><code>select count(*) from hremp;</code>	使用同义词进行表查询操作。</li>
</ol>
<p>同义词、视图等用法在数据<strong>保密要求较高</strong>的机构使用广泛，如银行机构。好处是既不影响对数据的操作，同时又能保证数据的安全。</p>
<h3 id="同义词的操作"><a href="#同义词的操作" class="headerlink" title="同义词的操作"></a>同义词的操作</h3><ul>
<li>创建同义词  <code>create synonym 同义词名(想设置的别名) fot 表名</code></li>
<li>删除同义词 <code>drop synonym 同义词名;</code></li>
<li>查询所有已经创建的同义词  <code>select synonym_name from user_synonyms;</code></li>
</ul>
<h1 id="sql插入相关"><a href="#sql插入相关" class="headerlink" title="sql插入相关"></a>sql插入相关</h1><p>关键字: <strong><code>insert into</code></strong></p>
<p>格式如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span>	<span class="keyword">table</span> [(<span class="keyword">column</span> [, column...])]</span><br><span class="line"><span class="keyword">VALUES</span>			(<span class="keyword">value</span> [, value...]);</span><br></pre></td></tr></table></figure>

<p><strong>案例</strong></p>
<ul>
<li><p>插入<strong>全部列</strong></p>
<p><code>insert into dept values(51,&#39;51name&#39;,&#39;51loc&#39;);</code></p>
</li>
<li><p>插入<strong>部分列</strong>(没有写出的列自动填NULL)</p>
<p><code>insert into dept(deptno,dname) values(55,&#39;55name&#39;);</code></p>
</li>
<li><p><strong>&amp;符号的使用</strong> (使用&amp;会让用户输入值)</p>
<p><code>insert into dept(deptno,dname,loc) values(&amp;t1,&amp;t2,&amp;t3);</code></p>
</li>
</ul>
<p>&amp;符号可以用于所有DML语句中供用户输入,并不仅仅是插入语句.</p>
<h2 id="批处理"><a href="#批处理" class="headerlink" title="批处理"></a>批处理</h2><ul>
<li><p>拷贝表结构(不拷贝数据)     通过<code>where 1=2</code>这个必定错条件不让数据拷贝过去</p>
<p><code>create table tname_YYYY_MM_DD as select * from tname_xxxxx where 1=2;</code>      (as不能省略)</p>
</li>
<li><p>拷贝表(拷贝数据)    </p>
<p><code>create table tname_YYYY_MM_DD as select * from tname_xxxxx; </code>        (as不能省略)</p>
</li>
<li><p>批量插入</p>
<p><code>insert into tname_bak select * from tname where .....;</code></p>
</li>
</ul>
<h1 id="sql修改相关"><a href="#sql修改相关" class="headerlink" title="sql修改相关"></a>sql修改相关</h1><p>关键词 :  <strong><code>update</code></strong></p>
<p>格式: <code>update 表名 set col=值 where condtion</code></p>
<p>对于更新操作来说，一般会有一个“where”条件，如果没有这限制条件，更新的就是整张表[危险]。</p>
<p>案例  :  <code>update emp10 set sal=4000, comm=300 where ename = &#39;CLARK&#39;;</code></p>
<h1 id="sql删除相关"><a href="#sql删除相关" class="headerlink" title="sql删除相关"></a>sql删除相关</h1><p>关键词  :  <strong><code>delete</code></strong></p>
<p>格式: <code>delete from 表名 where condtion</code></p>
<p>注意: 如不加“where”会将整张表的数据删除。[危险]</p>
<p><code>from</code>关键字在<strong>Oracle</strong>中可以省略不写，但<strong>MySQL</strong>中不可以;<br>但在使用的时候建议还是加上<code>from</code>. </p>
<p>案例: <code>delete from emp10 where empno=7782;</code></p>
<p><code>truncate table dept_0915</code> 也可以清空一张表,但留下表结构</p>
<h2 id="truncate和delete的区别"><a href="#truncate和delete的区别" class="headerlink" title="truncate和delete的区别"></a>truncate和delete的区别</h2><ol>
<li>delete 逐条删除表“内容”，truncate 先摧毁表再重建。<br>(由于delete使用频繁，Oracle对delete优化后delete快于truncate)      <strong>truncate不能加where条件,只能整张表删除</strong></li>
<li><code>delete</code> 是<strong>DML语句</strong>，<code>truncate</code> 是<strong>DDL语句</strong>。<br>**DML语句可以<a href="#Oracle%E7%9A%84%E5%9B%9E%E6%94%B6%E7%AB%99">闪回(flashback)</a>**，DDL语句不可以闪回。<br>（闪回：做错了一个操作并且commit了，对应的撤销行为。了解）</li>
<li>由于delete是逐条操作数据，所以delete会产生碎片，truncate不会产生碎片。<br>（同样是由于Oracle对delete进行了优化，让delete不产生碎片）。<br>两个数据之间的数据被删除，删除的数据——碎片，整理碎片，数据连续，行移动</li>
<li><strong>delete不会释放空间，truncate 会释放空间</strong><br>用delete删除一张10M的表，空间不会释放。而truncate会。所以当确定表不再使用，应truncate</li>
<li><strong>delete可以回滚rollback, truncate不可以回滚rollback。</strong></li>
</ol>
<h1 id="sql查询相关"><a href="#sql查询相关" class="headerlink" title="sql查询相关"></a>sql查询相关</h1><h2 id="基本select语句"><a href="#基本select语句" class="headerlink" title="基本select语句"></a>基本select语句</h2><p>下面所有说法均以此图为案例</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210151722300.png" alt="image-20221015172212283"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span>语句的整体形式：</span><br><span class="line"><span class="keyword">select</span> col1, col2…  </span><br><span class="line"><span class="keyword">from</span> table_name</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">condition</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> col…</span><br><span class="line"><span class="keyword">having</span> condtion</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> col…</span><br></pre></td></tr></table></figure>

<p>p.s.  oracle中sql关键字不区分大小写</p>
<p>语法格式为：<code>SELECT  *|&#123;[DISTINCT] column|expression [alias],...&#125;FROM table;</code></p>
<p><strong>字符和日期要包含在单引号中</strong>  转义单引号本身使用两个单引号来完成转义</p>
<h3 id="去重"><a href="#去重" class="headerlink" title="去重"></a>去重</h3><p><code>DISTINCT</code>表示去重</p>
<p>查看不同部门的不同工种</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> detpno,job <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p><strong><code>distinct</code>的作用范围是作用于后面出现的所有的列名和表达式.</strong>   (有别于升降序是针对单个最近的列名)</p>
<p>上面的例句中,不会出现重复的[detpno和job的组合].</p>
<h3 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h3><p>select后可以接列名或表达式</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select empno,ename,sal,comm,sal*<span class="number">12</span> 年薪,sal*<span class="number">12</span>+nvl 年收入 from emp;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210151735254.png" alt="image-20221015173450512"></p>
<p><strong>包含NULL值的表达式都返回为空</strong>,因此所有COMM为空的,年收入也为空</p>
<p>解决方案如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> empno,ename,sal,comm,sal<span class="operator">*</span><span class="number">12</span> 年薪,sal<span class="operator">*</span><span class="number">12</span><span class="operator">+</span>nvl(comm,<span class="number">0</span>) 年收入 <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p><code>nvl(comm,0)</code>表示<code>nvl</code>如果<code>comm</code>为空,则当成0处理   <a href="#%E9%80%9A%E7%94%A8%E5%87%BD%E6%95%B0">滤空函数参考</a></p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210151738265.png" alt="image-20221015173808216"></p>
<h3 id="别名"><a href="#别名" class="headerlink" title="别名"></a>别名</h3><p>select后接的列名或表达式或from后接的表名(<a href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2">多表查询</a>)可以起别名   关键词: <code>as</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> empno,ename,sal <span class="keyword">as</span> 工资,comm 奖金,sal<span class="operator">*</span><span class="number">12</span> &quot;年 薪&quot; <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p>注意:  </p>
<ul>
<li>as可以省略</li>
<li>如果别名中间有空格,需要使用<code>&quot;&quot;</code>引起来(不加双引号,英语别名统一显示为大写)</li>
</ul>
<p><strong>别名不能在where中直接替代表达式和列名使用.</strong></p>
<h3 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h3><p>使用关键词  <strong><code>where</code></strong>  过滤出需要的数据行</p>
<h4 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">=  等于(不是==)		&gt;	大于</span><br><span class="line">&gt;= 大于等于		    &lt;	小于</span><br><span class="line">&lt;= 小于等于			  &lt;&gt;	不等于(也可以是!=)</span><br><span class="line">between…and:介于两值之间,闭区间,包含两边的值.</span><br><span class="line"><span class="comment">//过滤col1为空的数据,不能使用 where col1 = null(不正确);</span></span><br><span class="line">过滤col1为空的数据: where coll is null;</span><br><span class="line">过滤col1不为空的数据: where coll is not null;</span><br><span class="line"><span class="comment">//col1 = null  和  col1 != null 的这两个条件都返回假,不管他col1是什么值</span></span><br></pre></td></tr></table></figure>

<h4 id="集合运算符"><a href="#集合运算符" class="headerlink" title="集合运算符"></a>集合运算符</h4><ul>
<li><code>IN</code>	等于列表中的任意一个</li>
<li><code>ANY</code>	和集合返回的任意一个值比较   <a href="#%E5%A4%9A%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2">配合子查询使用</a></li>
<li><code>ALL</code>	和集合返回的所有值比较     <a href="#%E5%A4%9A%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2">配合子查询使用</a></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">in</span>：在集合中       <span class="keyword">not</span> <span class="keyword">in</span> 不在集合中</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>col <span class="keyword">in</span>(<span class="number">1</span>,<span class="number">2</span>)等同于 col<span class="operator">=</span><span class="number">1</span> <span class="keyword">or</span> col<span class="operator">=</span><span class="number">2</span></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>col <span class="keyword">not</span> <span class="keyword">in</span>(<span class="number">1</span>,<span class="number">2</span>)等同于col<span class="operator">!=</span><span class="number">1</span> <span class="keyword">and</span> col<span class="operator">!=</span><span class="number">2</span></span><br></pre></td></tr></table></figure>

<p><a href="#%E5%AD%90%E6%9F%A5%E8%AF%A2%E4%B8%ADnull"> <code>not in</code> 的<code>null</code>注意点参考</a></p>
<h4 id="模糊查找"><a href="#模糊查找" class="headerlink" title="模糊查找"></a>模糊查找</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">like</span>：模糊查询  <span class="operator">/</span><span class="operator">/</span><span class="operator">%</span>匹配任意多个字符,  _匹配一个字符, 使用<span class="keyword">escape</span>表示转义字符(下面案例有使用方式),转义单引号本身使用两个单引号来完成转义</span><br></pre></td></tr></table></figure>

<h4 id="逻辑运算"><a href="#逻辑运算" class="headerlink" title="逻辑运算"></a>逻辑运算</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AND		逻辑并  (优先级依次往下)</span><br><span class="line">OR 		逻辑或</span><br><span class="line">NOT		逻辑非</span><br><span class="line"><span class="comment">//小括号可以调整优先级</span></span><br></pre></td></tr></table></figure>

<p>SQL优化：SQL在解析where的时候，是<strong>从右至左解析</strong>的。</p>
<p>所以： </p>
<ul>
<li><code>and</code>时应该将易假的值放在右侧;</li>
<li><code>or</code>时应该将易真的值放在右侧.</li>
</ul>
<h4 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="operator">=</span> <span class="string">&#x27;KING&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> hiredate<span class="operator">=</span> <span class="string">&#x27;17-11月-81&#x27;</span></span><br><span class="line">日期格式要与查询的时候一样,日期格式默认是DD<span class="operator">-</span>MON<span class="operator">-</span>RR</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal<span class="operator">&gt;=</span><span class="number">1000</span> <span class="keyword">and</span> sal<span class="operator">&lt;=</span><span class="number">2000</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="keyword">between</span> <span class="number">1000</span> <span class="keyword">and</span> <span class="number">2000</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">where</span> deptno <span class="keyword">in</span>(<span class="number">10</span>,<span class="number">20</span>);</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>查询员工首字母为S的员工信息</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">&#x27;S%&#x27;</span>;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>查询员工编号为<span class="number">79</span>开头的员工信息</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> empno <span class="keyword">like</span> <span class="string">&#x27;79%&#x27;</span>;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>查询员工姓名为<span class="number">4</span>个字母长度的员工信息</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">&#x27;____&#x27;</span>;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>查询员工姓名包含下划线_的员工信息</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> ename <span class="keyword">like</span> <span class="string">&#x27;%\_%&#x27;</span> <span class="keyword">escape</span> <span class="string">&#x27;\&#x27;</span>;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span><span class="keyword">escape</span>后接的字符表示他是转义字符</span><br></pre></td></tr></table></figure>

<p><strong>[重点]</strong> <strong>escape后接的字符表示他是转义字符</strong></p>
<p>注意:表中的列的值是区分大小写的,但关键词不区分大小写</p>
<h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><p>关键词: <code>order by</code></p>
<p>基本格式: <code>select ... from ... where condition order by colname|alias|expr(表达式)|number(序号)</code>   (序号表示select后面出现的次序,从1开始)</p>
<p>ORDER BY子句在<strong>SELECT语句的最末尾</strong>, 是对select查询的最后的结果进行排序.</p>
<p>使用 ORDER BY 子句排序<br>•	<code>ASC（ascend）</code>: 升序。默认采用升序方式。<br>•	<code>DESC（descend）</code>: 降序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>员工信息按入职日期先后排序</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> hiredate <span class="keyword">asc</span>;(<span class="keyword">asc</span>可以省略)</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>查询员工信息按奖金逆序</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> comm <span class="keyword">desc</span> nulls <span class="keyword">last</span>;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>查询员工编号,员工姓名和工资,按照序号(工资)进行排序</span><br><span class="line"><span class="keyword">select</span> empno,ename,sal <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<p><strong>[注意]  NULL在排序中表现为无穷大</strong>    可以使用<code>nulls last</code>使null的信息放到最后.</p>
<p><strong>多元素排序</strong>  : 对多个元素进行排序时,优先排序第一个元素,仅在第一个元素相同时对第二个元素进行排序,以此类推.</p>
<h3 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h3><p>分组数据使用**<code>group by</code>**关键字.	可以配合<a href="#%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0">分组函数</a>使用<br>$$<br>select\ \ …,count()\ \ from\ \ emp \ \ where\ \ …\ \ group\ \ by\ \ …<br>$$<br>按照group by 后给定的表达式，将from后面的table进行分组。针对每一组，使用<a href="#%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0">组函数</a>, 即先分组, 再分组统计.(<a href="#%E8%BF%87%E6%BB%A4">where过滤部分数据</a>可写可不写)</p>
<p><strong>[[注意]]</strong>    <strong>select后面存在没有出现在分组函数中的列名,一定要出现在group by子句中</strong>  ,不然会报错.(常数可以不出现在group by子句中)</p>
<p>因为分组数据会限制行数,如果select出现了别的列名,那么这一组的别的列名的值会出现多个,但只能显示一行,显然就冲突了.</p>
<p>案例: 统计各个部门的平均工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191639980.png" alt="image-20221019163924637"></p>
<hr>
<p>统计各个部分不同工种的平均工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno, job, <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno, job; </span><br></pre></td></tr></table></figure>

<p>按照<strong>deptno, job的组合</strong>来分组.</p>
<img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191720152.png" alt="image-20221019172030679" style="zoom: 67%;" />

<h3 id="分组函数过滤"><a href="#分组函数过滤" class="headerlink" title="分组函数过滤"></a>分组函数过滤</h3><p>只有使用关键词 **<code>having</code>**才能对<a href="#%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0"><strong>分组函数</strong></a>进行过滤.(不能用where)</p>
<p><strong>[注意]</strong> </p>
<ul>
<li><strong>having必须配合group by使用</strong>   不能单独存在</li>
<li><strong>having后面不能使用别名</strong>(where可以),可以使用函数</li>
<li>不能在where中使用组函数,<strong>可以在having中使用组函数</strong></li>
</ul>
<p>p.s.分组的情况下,having和where均可以对<strong>非分组函数</strong>进行过滤,下面两句效果一致:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno<span class="operator">!=</span><span class="number">10</span> <span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno <span class="keyword">having</span> deptno<span class="operator">!=</span><span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<p><strong>分组函数过滤案例</strong></p>
<p>查询平均薪水大于2000的部门 ：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno, <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno <span class="keyword">having</span> <span class="built_in">avg</span>(sal)<span class="operator">&gt;</span><span class="number">2000</span>;</span><br></pre></td></tr></table></figure>

<h4 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h4><p>在子句中没有使用组函数的情况下，where、having都可以，应该怎么选择？	</p>
<p>SQL优化： <strong>尽量采用where</strong>。<br>如果有分组的话，where是先过滤再分组，而having是先分组再过滤。当数据量庞大如1亿条，where优势明显。</p>
<h2 id="单行函数"><a href="#单行函数" class="headerlink" title="单行函数"></a>单行函数</h2><p>单行函数:只对一行进行变换，产生一个结果。函数可以没有参数，但必须要有返回值。</p>
<ul>
<li>操作数据对象</li>
<li>接受参数返回一个结果</li>
<li>只对一行进行变换</li>
<li>每行返回一个结果</li>
<li>可以转换数据类型</li>
<li>可以嵌套</li>
<li>参数可以是一列或一个值</li>
</ul>
<h3 id="字符函数"><a href="#字符函数" class="headerlink" title="字符函数"></a>字符函数</h3><ul>
<li><p><code>lower</code> 小写, <code>upper</code> 大写, <code>initcap</code>单词的首字母大写</p>
</li>
<li><p><code>concat</code>(连接符<code>||</code>)</p>
<p>concat函数只能连接两个字符串, 若想连接三个的话只能嵌套调用;<code>||</code> 可以连接多个字符串, 建议使用||来连接字符串.</p>
</li>
<li><p><code>substr(str,pos,len)</code>截取字符串str,从pos位置开始截取len个</p>
<p>注意:pos是从1开始的, 若len为0表示从pos开始, 截取到最后, 若pos为负数, 表示从末尾倒数开始截取</p>
</li>
<li><p><code>instr(str, substr)</code>:判断substr是否在str中存在, 若存在返回第一次出现的位置, 若不存在则返回0</p>
</li>
<li><p>lpad和rpad–<code>l(r)pad(str, len, ch)</code>:返回len长度的字符串, 如果str不够len的话, 在左(右)填充ch这个字符</p>
</li>
<li><p><code>trim(str)</code>:去掉字符串str首部和尾部的空格,中间的空格不去掉</p>
<p>也可以<code>trim(c from str)</code>:去掉str中的c字符</p>
</li>
<li><p><code>replace(str, old, new)</code>:将str字符串中的old字符串替换成new字符串</p>
</li>
<li><p>length和lengthb</p>
<p><code>select length(&#39;hello world&#39;) 字符数, lengthb(&#39;hello world&#39;) 字节数 from dual;</code><br>注意:<strong>对于length函数一个汉字是一个字符</strong>, <strong>对于lengthb函数,一个汉字占两个</strong>,这两个函数对于普通字符串没有什么区别.</p>
</li>
</ul>
<h3 id="数值函数"><a href="#数值函数" class="headerlink" title="数值函数"></a>数值函数</h3><ul>
<li><code>round(n,m)</code>: 四舍五入,对n这个数值四舍五入保留小数点后m位</li>
<li><code>trunc(n,m)</code>: 截取,对n这个数值截取小数点后m位前的内容</li>
<li><code>mod(n,m)</code>:n对m取余</li>
<li><code>ceil(n)</code>:对n向上取整;<code>floor(n)</code>:对n向下取整</li>
</ul>
<h3 id="转换函数"><a href="#转换函数" class="headerlink" title="转换函数"></a>转换函数</h3><p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210161727853.png" alt="image-20221016172705248"></p>
<p><strong>显示转换</strong>：借助to_char(数据，格式)、to_number、to_date函数来完成转换。</p>
<p><strong>[注意]</strong> 如果隐式、显示都可以使用，应该首选显示，这样可以省去oracle的解析过程。</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210161727812.png" alt="image-20221016172746213"></p>
<h4 id="to-char函数"><a href="#to-char函数" class="headerlink" title="to_char函数"></a>to_char函数</h4><p><strong>功能</strong>:将date或number类型转换成字符串类型</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191135012.png" alt="image-20221019113415897"></p>
<p>案例:</p>
<p>查询员工的薪水: 使用2位小数, 本地货币代码, 千位符 	</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> to_char(sal, <span class="string">&#x27;L9,999.99&#x27;</span>) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p>特别注意:’L9,999.99’之间没有空格</p>
<img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191138144.png" alt="image-20221019113747079" style="zoom: 50%;" />

<hr>
<p><a href="#date%E7%9A%84%E6%A0%BC%E5%BC%8F">参考date的格式</a></p>
<p>在屏幕上显示如下字符串：<br>2015-05-11 16:17:06 今天是 星期一       </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> to_char(sysdate, <span class="string">&#x27;yyyy-mm-dd hh24:mi:ss &quot;今天是&quot; day&#x27;</span>) <span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<p><strong>说明</strong>: 在<strong>固定的格式里加入自定义的格式是可以</strong>的，必须要加<code>””</code>。</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191146163.png" alt="image-20221019114539105"></p>
<h4 id="to-number函数"><a href="#to-number函数" class="headerlink" title="to_number函数"></a>to_number函数</h4><p><strong>功能</strong>:将字符串转换成number类型</p>
<p>案例:</p>
<p>将￥2,975.00转化成数字2975：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> to_number(<span class="string">&#x27;￥2,975.00&#x27;</span>, <span class="string">&#x27;L9,999.99&#x27;</span>) 转成数字 <span class="keyword">from</span> dual;  </span><br></pre></td></tr></table></figure>

<h4 id="to-date函数"><a href="#to-date函数" class="headerlink" title="to_date函数"></a>to_date函数</h4><p><strong>功能</strong>:将字符串转换成date类型</p>
<p>已知字符串’2015-05-11 15:17:06 今天是 星期一’转化成日期.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> to_date(<span class="string">&#x27;2015-05-11 15:17:06 今天是 星期一&#x27;</span>, <span class="string">&#x27;yyyy-mm-dd hh24:mi:ss &quot;今天是&quot; day&#x27;</span>) 	<span class="keyword">from</span> dual;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191149773.png" alt="image-20221019114858405"></p>
<hr>
<p>求1980年12月17日入职的员工信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> hiredate <span class="operator">=</span> to_date(<span class="string">&#x27;17-12月-80&#x27;</span>,<span class="string">&#x27;DD-MON-RR&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="date的格式"><a href="#date的格式" class="headerlink" title="date的格式"></a>date的格式</h4><p>(格式不区分大小写)</p>
<table>
<thead>
<tr>
<th>格式</th>
<th>说明</th>
<th>举例</th>
</tr>
</thead>
<tbody><tr>
<td>YYYY</td>
<td>Full year in numbers</td>
<td>2011</td>
</tr>
<tr>
<td>RR</td>
<td>年份的后两个数字</td>
<td>11</td>
</tr>
<tr>
<td>YEAR</td>
<td>Year spelled out(年的英文全称)</td>
<td>twenty eleven</td>
</tr>
<tr>
<td>MM</td>
<td>Two-digit value of month 月份（两位数字）</td>
<td>04</td>
</tr>
<tr>
<td>MONTH&#x2F;mon</td>
<td>Full name of the month（月的全称）</td>
<td>4月</td>
</tr>
<tr>
<td>DY</td>
<td>Three-letter abbreviation of the day of the week(星期几)</td>
<td>星期一</td>
</tr>
<tr>
<td>DAY</td>
<td>Full name of the day of the week</td>
<td>星期一</td>
</tr>
<tr>
<td>DD</td>
<td>Numeric day of the month</td>
<td>02</td>
</tr>
<tr>
<td>HH24</td>
<td>2位数字的24小时制的小时数</td>
<td>11</td>
</tr>
<tr>
<td>MI</td>
<td>2位数字的分钟数</td>
<td>52</td>
</tr>
<tr>
<td>ss</td>
<td>2位数字的秒数</td>
<td>44</td>
</tr>
</tbody></table>
<h4 id="时间和日期函数"><a href="#时间和日期函数" class="headerlink" title="时间和日期函数"></a>时间和日期函数</h4><p><code>sysdate</code> 当前的系统时间    如:  <code>select sysdate from dual;</code></p>
<p>oracle日期型+1 &#x3D; 加一天</p>
<p>日期和日期可以<strong>相减表示相隔多少天</strong>, 但是<strong>不允许相加</strong>, 两个日期相加没有意义(报错: <code>ORA-00975</code>: 不允许日期 + 日期), <strong>日期只能和数字相加</strong></p>
<p>上面方式如果计算月差,年差,周差,等可以分别除以30,365,7.但这样计算显然是不精确的</p>
<p>如下日期函数才来精确计算</p>
<ul>
<li><code>months_between(date1,date2)</code>   计算date1-date2的月差</li>
<li><code>add_months(date,n)</code>   date日期增加n个月</li>
<li><code>last_day(date)</code>  date日期的这个月的最后一天</li>
<li><code>next_day(date,&#39;星期一&#39;)</code>   date日期的下一个星期一</li>
<li><code>round(date,&#39;month&#39;)</code>  date日期按月份四舍五入(过了一半就加1,没过一半就不加)</li>
<li><code>trunc(date,&#39;year&#39;)</code> date日期按年份截断(月份和日数归最小),按月截断的话表示日数归最小</li>
</ul>
<h3 id="通用函数"><a href="#通用函数" class="headerlink" title="通用函数"></a>通用函数</h3><p>这些函数适用于任何数据类型，同时也适用于空值：</p>
<ul>
<li><p><strong><code>NVL (expr1, expr2)</code></strong>     滤空函数： 如果expr1为NULL，返回expr2</p>
</li>
<li><p><strong><code>NVL2 (expr1, expr2, expr3)</code></strong>    滤空函数： 如果expr1为NULL，返回expr3,否则返回expr2</p>
</li>
<li><p><strong><code>NULLIF (expr1, expr2)</code></strong>   当 expr1 &#x3D; expr2 时返回null, 不相等的时候返回expr1值。</p>
</li>
<li><p><strong><code>COALESCE (expr1, expr2, ..., exprn)</code></strong>   找非空值函数  从左向右找参数中第一个不为空的值。</p>
<img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191431201.png" alt="image-20221019143055678" style="zoom:67%;" /></li>
</ul>
<h2 id="分组函数"><a href="#分组函数" class="headerlink" title="分组函数"></a>分组函数</h2><p>分组函数:也称之为组函数或者聚合函数,oracle提供的常用的有5个函数: avg、count、max、min、sum操作的是一组数据，返回一个结果。     可以配合<a href="#%E5%88%86%E7%BB%84">分组数据</a>使用(select后同时存在分组函数和非分组函数的情况下,必须配合<a href="#%E5%88%86%E7%BB%84">分组数据</a>使用)</p>
<ul>
<li><p><strong><code>count(列名或1)</code></strong>  计算行数(滤空)  1表示只要有值,都算+1;列名表示按照该列名算行数</p>
<p><code>select count(distinct job) from emp</code>显示工作总数(去重才能计算到工作总数) </p>
</li>
<li><p><strong><code>avg(列名)</code></strong>  求平均列值(滤空)      注意: <code>avg(comm)</code>   等同于   <code>sum(comm)/count(comm)</code> (滤空) 而非<code>sum(comm)/count(empno)</code> (不滤空),前者是有奖金的人的奖金平均值,后者是全部人平均奖金的值</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191613017.png" alt="image-20221019161354607"></p>
</li>
<li><p><strong><code>max(列名)</code></strong>  求列值最大值(滤空)</p>
</li>
<li><p><strong><code>min(列名)</code></strong>  求列值最小值(滤空)</p>
</li>
<li><p><strong><code>sum(总和)</code></strong>   求列值总和(滤空)</p>
</li>
</ul>
<p><strong>总结 : 分组函数自带滤空功能</strong></p>
<p>可以通过 <a href="#%E9%80%9A%E7%94%A8%E5%87%BD%E6%95%B0">nvl函数</a> 去掉分组函数的滤空功能,如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(nvl(comm,<span class="number">0</span>)) <span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h4 id="count注意点"><a href="#count注意点" class="headerlink" title="count注意点"></a>count注意点</h4><p><code>count(*)</code>和<code>count(e.empno)</code>的区别:</p>
<ul>
<li><code>count(*)</code> 只要一行中有一个字段不为空就被统计上</li>
<li><code>count(e.empno)</code> 只有<code>e.empno</code>不为空才会被统计上</li>
<li><strong>[注意]</strong> 不能使用<code>count(e.*)</code>, 会报错.应该写成某个表的具体的列.</li>
</ul>
<h2 id="条件表达式与条件函数"><a href="#条件表达式与条件函数" class="headerlink" title="条件表达式与条件函数"></a>条件表达式与条件函数</h2><p>在SQL中无法实现if else 逻辑。当有这种需求的时候，可以使用case 或者 decode</p>
<h3 id="case条件表达式"><a href="#case条件表达式" class="headerlink" title="case条件表达式"></a>case条件表达式</h3><p>case:是一个<strong>表达式</strong>，其语法为：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CASE</span> expr  <span class="keyword">WHEN</span> comparison_expr1 <span class="keyword">THEN</span> return_expr1</span><br><span class="line">[<span class="keyword">WHEN</span> comparison_expr2 <span class="keyword">THEN</span> return_expr2</span><br><span class="line"> <span class="keyword">WHEN</span> comparison_exprn <span class="keyword">THEN</span> return_exprn</span><br><span class="line"> <span class="keyword">ELSE</span> else_expr]</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure>

<p>上面代码解释,根据expr列名或表达式来判断,when后面的为判断值,如果expr &#x3D; 该值,则返回return_expr1表达式.else后接when没提到的情况的返回值else_expr.</p>
<p><strong>案例</strong></p>
<p>老板打算给员工涨工资, 要求：<br>总裁(PRESIDENT)涨1000, 经理(MANAGER)涨800, 其他人涨400. 请将涨前, 涨后的薪水列出。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename, job, sal 涨前薪水, 	</span><br><span class="line"><span class="keyword">case</span> job </span><br><span class="line"><span class="keyword">when</span> <span class="string">&#x27;PRESIDENT&#x27;</span> <span class="keyword">then</span> sal<span class="operator">+</span><span class="number">1000</span> </span><br><span class="line"><span class="keyword">when</span> <span class="string">&#x27;MANAGER&#x27;</span>   <span class="keyword">then</span> sal<span class="operator">+</span><span class="number">800</span> </span><br><span class="line"><span class="keyword">else</span>  sal <span class="operator">+</span> <span class="number">400</span></span><br><span class="line"><span class="keyword">end</span> 涨后薪水 </span><br><span class="line"><span class="keyword">from</span> emp;  </span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210191532530.png" alt="image-20221019153254072" style="zoom:67%;" />

<h3 id="decode函数"><a href="#decode函数" class="headerlink" title="decode函数"></a>decode函数</h3><p>decode：是一个<strong>函数</strong>，其语法为：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DECODE(col<span class="operator">|</span>expression, search1, result1 </span><br><span class="line">			[, search2, result2,...,]</span><br><span class="line">			[, <span class="keyword">default</span>])</span><br></pre></td></tr></table></figure>

<p>除第一个和最后一个参数之外，中间的参数都是成对呈现的 <code>(参1, 条件, 值, 条件, 值, …, 条件, 值, 尾参)</code></p>
<p><strong>案例</strong></p>
<p>题目与效果图等同于case条件变量案例</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename, job, sal 涨前薪水, decode(job, <span class="string">&#x27;PRESIDENT&#x27;</span>, sal <span class="operator">+</span> <span class="number">1000</span>,  </span><br><span class="line"><span class="string">&#x27;MANAGER&#x27;</span>, sal <span class="operator">+</span> <span class="number">800</span>,  </span><br><span class="line">sal <span class="operator">+</span> <span class="number">400</span>) <span class="keyword">as</span> 涨后薪水 </span><br><span class="line"><span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<h2 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h2><p>只要select后出现多表重复存在的列名,则需要标识列名属于谁,如:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.deptno <span class="keyword">from</span> emp e,dept d;</span><br></pre></td></tr></table></figure>

<p>否则报错:  <code>ORA-00918: 未明确定义列</code></p>
<h3 id="笛卡尔积"><a href="#笛卡尔积" class="headerlink" title="笛卡尔积"></a>笛卡尔积</h3><p>两个表的笛卡尔积 &#x3D; 两个表的项之间组合的所有可能的集合</p>
<p>笛卡尔积的行数 &#x3D; table1的行数 x table2的行数<br>笛卡尔积的列数 &#x3D; table1的列数 + table2的列数</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210201658550.png" alt="image-20221020165843162"></p>
<p>笛卡尔积中包含不正确的无用数据.上图中很显然左表(黄)和右表(绿)的deptno匹配会出现不相等的情况,即无效数据.(添加图中连接条件可以去除无效行)</p>
<p>多表查询就是按照给定条件(连接条件)，从笛卡尔全集中选出正确的结果。</p>
<h3 id="连接条件"><a href="#连接条件" class="headerlink" title="连接条件"></a>连接条件</h3><ul>
<li><code>Equijoin</code>：等值连接</li>
<li><code>Non-equijoin</code>：不等值连接</li>
<li><code>Outerjoin</code>：外连接</li>
<li><code>Selfjoin</code>：自连接</li>
</ul>
<h4 id="等值连接"><a href="#等值连接" class="headerlink" title="等值连接"></a>等值连接</h4><p>只返回满足连接条件的数据（两边都有的才显示）。</p>
<p>where子句后面的条件，是“&#x3D;”为等值连接。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>,d.<span class="operator">*</span> <span class="keyword">from</span> emp e, dept d <span class="keyword">where</span> e.deptno <span class="operator">=</span> d.deptno;</span><br></pre></td></tr></table></figure>

<h4 id="不等值连接"><a href="#不等值连接" class="headerlink" title="不等值连接"></a>不等值连接</h4><p>where子句后面的条件，不是“&#x3D;”为不等值连接。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.sal,s.grade <span class="keyword">from</span> emp e,salgrade s <span class="keyword">where</span> e.sal<span class="operator">&lt;=</span>s.hisal <span class="keyword">and</span> e.sal<span class="operator">&gt;=</span> s.losal;</span><br></pre></td></tr></table></figure>

<h4 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h4><p>按部门统计员工人数，显示： 部门号 部门名称 人数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> d.deptno,dname,<span class="built_in">count</span>(e.empno) <span class="keyword">from</span> dept d,emp e <span class="keyword">where</span> d.deptno <span class="operator">=</span> e.deptno <span class="keyword">group</span> <span class="keyword">by</span> dname,d.deptno;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210201801063.png" alt="image-20221020180059609"></p>
<p>虽然显示了如上结果,但因为<code>where d.deptno = e.deptno</code>,缺失了40号部门</p>
<h5 id="右外连接"><a href="#右外连接" class="headerlink" title="右外连接"></a>右外连接</h5><p>右边deptno显示全</p>
<p>写法：与叫法相反：<code>where e.deptno(+)=d.deptno</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> d.deptno,dname,<span class="built_in">count</span>(e.empno) <span class="keyword">from</span> dept d,emp e <span class="keyword">where</span> e.deptno(<span class="operator">+</span>)<span class="operator">=</span>d.deptno <span class="keyword">group</span> <span class="keyword">by</span> dname,d.deptno;</span><br></pre></td></tr></table></figure>

<h5 id="左外连接"><a href="#左外连接" class="headerlink" title="左外连接"></a>左外连接</h5><p>左边deptno显示全</p>
<p>写法：与叫法相反：<code>where d.deptno=e.deptno(+)</code> </p>
<p>左外连接和右外连接效果完全一样,只是顺序不同.</p>
<p><strong>[重点]</strong>  <strong><code>(+)</code>符号加在哪就看两边的行数想要显示全,就在另一边加上该符号</strong></p>
<h4 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h4><p>核心，通过表的别名，将同一张表视为多张表。</p>
<p>查询员工信息：xxx的老板是 yyy </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.ename <span class="operator">||</span> <span class="string">&#x27;  的老板是 &#x27;</span> <span class="operator">||</span> b.ename <span class="keyword">from</span> emp e, emp b <span class="keyword">where</span> e.mgr<span class="operator">=</span>b.empno;</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210211432867.png" alt="image-20221021143252478" style="zoom:50%;" />

<p>由于KING没有老板,所以可以使用外连接的方式把king也显示出来:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.ename <span class="operator">||</span> <span class="string">&#x27;  的老板是 &#x27;</span> <span class="operator">||</span> nvl(b.ename,<span class="string">&#x27;没有&#x27;</span>) <span class="keyword">from</span> emp e, emp b <span class="keyword">where</span> e.mgr<span class="operator">=</span>b.empno(<span class="operator">+</span>);</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210211602703.png" alt="image-20221021160247799" style="zoom:67%;" />

<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><p>子查询语法很简单，就是select 语句的嵌套使用,即<strong>sql嵌套sql</strong>。</p>
<p>语法格式: 主查询的where、select、having、from后都可以放置子查询,如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>	select_list</span><br><span class="line"><span class="keyword">FROM</span>	<span class="keyword">table</span></span><br><span class="line"><span class="keyword">WHERE</span>	expr operator</span><br><span class="line">			(<span class="keyword">SELECT</span>	select_list</span><br><span class="line">		   <span class="keyword">FROM</span>		<span class="keyword">table</span>);</span><br></pre></td></tr></table></figure>

<p>查询工资比SCOTT高的员工信息.</p>
<ol>
<li><p>查出SCOTT的工资</p>
<p><code>select ename, sal from emp where ename=&#39;SCOTT&#39;; 结果为3000</code></p>
</li>
<li><p>查询比3000高的员工</p>
<p><code>select * from emp where sal&gt;3000;  </code></p>
</li>
</ol>
<p>通过两步可以将问题结果得到。子查询，可以将两步合成一步。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">from</span> emp  </span><br><span class="line"><span class="keyword">where</span> sal  <span class="operator">&gt;</span>  (<span class="keyword">select</span> sal  </span><br><span class="line">					     <span class="keyword">from</span> emp  </span><br><span class="line">					      <span class="keyword">where</span> ename<span class="operator">=</span><span class="string">&#x27;SCOTT&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>写一个较复杂的子查询的时候,要合理的添加换行,缩进</li>
<li>主查询的where、<a href="#select%E5%90%8E%E5%AD%90%E6%9F%A5%E8%AF%A2%E6%A1%88%E4%BE%8B">select</a>、<a href="#having%E5%90%8E%E5%AD%90%E6%9F%A5%E8%AF%A2%E6%A1%88%E4%BE%8B">having</a>、<a href="#from%E5%90%8E%E5%AD%90%E6%9F%A5%E8%AF%A2%E6%A1%88%E4%BE%8B">from</a>后都可以放置子查询</li>
<li>强调：在from后面放置的子查询(…), from后面放置是一个集合(表、查询结果)</li>
<li>一般不在子查询中使用order by, 但在<a href="#top-N%E9%97%AE%E9%A2%98">Top-N分析问题</a>中，必须使用<code>order by</code>  </li>
<li><strong>子查询可以放在select后，但，要求该子查询必须是单行子查询：(该子查询本身只返回一条记录，2+叫多行子查询)</strong></li>
<li><strong>单行子查询只能使用单行操作符；多行子查询只能使用多行操作符</strong></li>
</ul>
<h3 id="where后子查询案例"><a href="#where后子查询案例" class="headerlink" title="where后子查询案例"></a>where后子查询案例</h3><p>参考第一个例子.</p>
<h3 id="select后子查询案例"><a href="#select后子查询案例" class="headerlink" title="select后子查询案例"></a>select后子查询案例</h3><p>查询10号部分员工号,员工姓名,部门编号,部门名称</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.empno,e.ename,e.deptno,(<span class="keyword">select</span> dname <span class="keyword">from</span> dept <span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">10</span>) <span class="keyword">from</span> emp e <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<p>此处的子查询(select后)必须是<strong>单行子查询</strong>.</p>
<h3 id="having后子查询案例"><a href="#having后子查询案例" class="headerlink" title="having后子查询案例"></a>having后子查询案例</h3><p>查询部门平均工资高于20号部门平均工资的部门和平均工资</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,<span class="built_in">avg</span>(sal) </span><br><span class="line"><span class="keyword">from</span> emp </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> deptno </span><br><span class="line"><span class="keyword">having</span> <span class="built_in">avg</span>(sal)<span class="operator">&gt;</span>(<span class="keyword">select</span> <span class="built_in">avg</span>(sal) </span><br><span class="line">                 <span class="keyword">from</span> emp </span><br><span class="line">                 <span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">20</span>);</span><br></pre></td></tr></table></figure>

<h3 id="from后子查询案例"><a href="#from后子查询案例" class="headerlink" title="from后子查询案例"></a>from后子查询案例</h3><p>查询员工的姓名、薪水和年薪：要求格式为:<code>select * from ___________________</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> ename 姓名,sal 薪水,sal<span class="operator">*</span><span class="number">12</span><span class="operator">+</span>nvl(comm,<span class="number">0</span>) 年薪 <span class="keyword">from</span> emp);</span><br></pre></td></tr></table></figure>

<h3 id="多行子查询"><a href="#多行子查询" class="headerlink" title="多行子查询"></a>多行子查询</h3><p>子查询返回2条记录以上就叫多行。</p>
<p>多行操作符有：	</p>
<ul>
<li><code>IN</code>		等于列表中的任意一个</li>
<li><code>ANY</code>	  和子查询返回的任意一个值比较</li>
<li><code>ALL</code>		和子查询返回的所有值比较</li>
</ul>
<p><strong>案例</strong></p>
<p>查询薪水比30号部门任意一个员工高的员工信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">单行子查询方式min实现:</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> (<span class="keyword">select</span> <span class="built_in">min</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">30</span>);  </span><br><span class="line">多行子查询方式<span class="keyword">ANY</span>实现</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="keyword">any</span>(<span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">30</span>);</span><br></pre></td></tr></table></figure>

<hr>
<p>查询薪水比30号部门所有员工高的员工信息。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">单行子查询方式max实现:</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> (<span class="keyword">select</span> <span class="built_in">max</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">30</span>);</span><br><span class="line">多行子查询方式<span class="keyword">ALL</span>实现</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> <span class="keyword">all</span> (<span class="keyword">select</span> sal <span class="keyword">from</span> emp <span class="keyword">where</span> deptno<span class="operator">=</span><span class="number">30</span>); </span><br></pre></td></tr></table></figure>

<h3 id="单行子查询"><a href="#单行子查询" class="headerlink" title="单行子查询"></a>单行子查询</h3><p>单行子查询就是该条子查询执行结束时, 只返回一条记录(一行数据)。</p>
<p>使用单行操作符:<br>&#x3D;、&gt;、&gt;&#x3D;、&lt;、&lt;&#x3D;、&lt;&gt;或者!&#x3D;	</p>
<h3 id="子查询中null"><a href="#子查询中null" class="headerlink" title="子查询中null"></a>子查询中null</h3><p>判断一个值等于、不等于空，不能使用&#x3D;和!&#x3D;号，而应该使用is 和 not。</p>
<p><strong>[[特别注意]]</strong>  如果<strong>集合中有NULL值，不能使用not in</strong>。如： not in (10， 20， NULL)，但是可以使用in。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用等于号与不等于号和null做比较都返回假</span></span><br><span class="line">值 =  null   <span class="comment">//返回假</span></span><br><span class="line">值 != null   <span class="comment">//返回假</span></span><br></pre></td></tr></table></figure>

<p>因为, not in操作符等价于 !&#x3D;All，最后一个表达式为假，整体假;<br>而a in (10, 20, NULL)等价于(a &#x3D; 10) or (a &#x3D; 20) or (a &#x3D; null)只要有一个为真即为真。<br>        in 操作符等价于 &#x3D; Any </p>
<h3 id="子查询优化"><a href="#子查询优化" class="headerlink" title="子查询优化"></a>子查询优化</h3><blockquote>
<p>一般情况下，子查询使用order by或是不使用order by对主查询来说没有什么意义。子查询的结果给主查询当成集合来使用，所以没有必要将子查询order by。<br>但，在Top-N分析问题中，必须使用order by</p>
</blockquote>
<p><strong>SQL优化</strong>: 理论上，既可以使用子查询，也可以使用多表查询，尽量使用“多表查询”。子查询有2次from, 与数据库服务的交互多.</p>
<h3 id="top-N问题"><a href="#top-N问题" class="headerlink" title="top-N问题"></a>top-N问题</h3><p>Top-N指排名前N相关的问题</p>
<p>解决top-N问题使用了一个关键词   <strong><code>rownum</code>   (行号)</strong></p>
<p><strong><code>rownum</code>的生成是在集合第一次产生的时候就生成了.</strong>  可以将查询的结果看成一个表来用</p>
<p>通过子查询排序的方式得到一个临时表,在外部查询中按照rownum来区分排名.   参考如下案例:</p>
<p>查询emp表中工资在5-8的员工信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> rn 排名,d.<span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> rownum rn,e.<span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal) e) d <span class="keyword">where</span> rn<span class="operator">&lt;=</span><span class="number">8</span> <span class="keyword">and</span> rn<span class="operator">&gt;=</span><span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<p><strong>[讲解]</strong> 二级子查询中,子集合中的rownum不是列名的话,不能在上级查询中被作为筛选条件,解决方式是给rownum提供一个别名,再多加一层子查询,使最外部查询中<code>rownum的别名</code>成为一个列名,以此参与筛选.</p>
<p>结果:<img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210281618481.png" alt="image-20221028161825421"></p>
<h2 id="集合运算"><a href="#集合运算" class="headerlink" title="集合运算"></a>集合运算</h2><p>集合运算的操作符。<code>A ∩ B</code>、<code>A ∪ B</code>、<code>A - B</code>  			</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210231341844.png" alt="image-20221023134056913"></p>
<p><strong><code>union</code>和<code>union all</code>的区别</strong>: <code>union</code>会去掉重复的, 而<code>union all</code>会全部显示</p>
<p><strong>集合运算注意点</strong></p>
<ul>
<li>参与运算的各个集合必须<strong>列数相同</strong>，且对应<strong>每个列的类型一致</strong>。(不然会报错类型不一致:<code>ORA-01790</code> 或 列数不同:<code>ORA-01789</code>)</li>
<li>采用第一个集合的表头作为最终使用的表头.</li>
<li>可以使用括号()先执行后面的语句。</li>
</ul>
<p><strong>案例</strong></p>
<p>按照部门统计各部门不同工种的工资情况，要求按如下格式输出：</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210231519944.png" alt="image-20221023151906466"></p>
<p>照集合的要求,必须列数相同,类型一致,所以写法如下,使用null强行占位!</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> deptno,job,<span class="built_in">sum</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno,job</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> deptno,to_char(<span class="keyword">null</span>),<span class="built_in">sum</span>(sal) <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno</span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> to_number(<span class="keyword">null</span>),to_char(<span class="keyword">null</span>),<span class="built_in">sum</span>(sal) <span class="keyword">from</span> emp;	</span><br></pre></td></tr></table></figure>

<p><strong>sql优化</strong>  :  集合运算的性能一般较差</p>
<h2 id="一些tips"><a href="#一些tips" class="headerlink" title="一些tips"></a>一些tips</h2><p>尽量使用列名，用列名代替* (oracle 9i之前不同， 之后一样)</p>
<p><code>sysdate</code>可以作为列名在select后使用,表示当前日期,如果from后面不来源于任何表,可以使用伪表<code>dual</code></p>
<h2 id="综合案例"><a href="#综合案例" class="headerlink" title="综合案例"></a>综合案例</h2><p><strong>查询部门工资大于本部门平均工资的员工信息</strong></p>
<p>先查询10号部门:<br>      使用子查询:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.deptno,</span><br><span class="line">		       e.empno,</span><br><span class="line">		       e.ename,</span><br><span class="line">		       e.sal,</span><br><span class="line">		       (<span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">10</span>) </span><br><span class="line">		  <span class="keyword">from</span> emp e</span><br><span class="line">		 <span class="keyword">where</span> e.deptno <span class="operator">=</span> <span class="number">10</span></span><br><span class="line">		   <span class="keyword">and</span> e.sal <span class="operator">&gt;</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> <span class="number">10</span>);</span><br></pre></td></tr></table></figure>

<p>推广到所有部门   (其实就是<code>10</code>换成<code>e.deptno</code>)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.deptno,</span><br><span class="line">		       e.empno,</span><br><span class="line">		       e.ename,</span><br><span class="line">		       e.sal,</span><br><span class="line">		       (<span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> e.deptno)</span><br><span class="line">		  <span class="keyword">from</span> emp e</span><br><span class="line">		 <span class="keyword">where</span> e.sal <span class="operator">&gt;</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp <span class="keyword">where</span> deptno <span class="operator">=</span> e.deptno)</span><br><span class="line">		 <span class="keyword">order</span> <span class="keyword">by</span> e.deptno;</span><br></pre></td></tr></table></figure>

<p>上述是一种解决方案,也可以:使用多表查询:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.deptno, e.empno, e.ename, e.sal, d.avgsal</span><br><span class="line">		  <span class="keyword">from</span> emp e,</span><br><span class="line">		       (<span class="keyword">select</span> deptno, <span class="built_in">avg</span>(sal) avgsal <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno) d</span><br><span class="line">		 <span class="keyword">where</span> e.deptno <span class="operator">=</span> d.deptno</span><br><span class="line">		   <span class="keyword">and</span> e.sal <span class="operator">&gt;</span> d.avgsal;</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>从emp表中查询, 结果显示如下的格式:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Total  1980   1981  1982  1987</span><br><span class="line">-----  -----  ----- ----- -----</span><br><span class="line"> 14     1     10     1      2</span><br></pre></td></tr></table></figure>

<p>sql如下:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(empno) &quot;Total&quot;,</span><br><span class="line">          <span class="built_in">sum</span>(decode(to_char(hiredate, <span class="string">&#x27;YYYY&#x27;</span>), <span class="string">&#x27;1980&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;1980&quot;,</span><br><span class="line">          <span class="built_in">sum</span>(decode(to_char(hiredate, <span class="string">&#x27;YYYY&#x27;</span>), <span class="string">&#x27;1981&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;1981&quot;,</span><br><span class="line">          <span class="built_in">sum</span>(decode(to_char(hiredate, <span class="string">&#x27;YYYY&#x27;</span>), <span class="string">&#x27;1982&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;1982&quot;,</span><br><span class="line">          <span class="built_in">sum</span>(decode(to_char(hiredate, <span class="string">&#x27;YYYY&#x27;</span>), <span class="string">&#x27;1987&#x27;</span>, <span class="number">1</span>, <span class="number">0</span>)) &quot;1987&quot;</span><br><span class="line"><span class="keyword">from</span> emp;</span><br></pre></td></tr></table></figure>

<p><a href="#decode%E5%87%BD%E6%95%B0">decode函数跳转</a></p>
<h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><p><strong>数据库事务</strong>，是由有限的数据库操作序列组成的逻辑执行单元，这一系列操作要么全部执行，要么全部放弃执行。</p>
<p>数据库事务由以下的部分组成:</p>
<ul>
<li>一个或多个DML 语句</li>
<li>一个 DDL(Data Definition Language – 数据定义语言) 语句</li>
<li>一个 DCL(Data Control Language – 数据控制语言) 语句</li>
</ul>
<p>事务的<strong>特点</strong>：<strong>要么都成功，要么都失败</strong>。</p>
<h2 id="事务的特性"><a href="#事务的特性" class="headerlink" title="事务的特性"></a><strong>事务的特性</strong></h2><p>ACID: 原子性,一致性,隔离性,持久性</p>
<ul>
<li>**原子性(Atomicity)**：事务中的全部操作在数据库中是不可分割的，要么全部完成，要么均不执行。</li>
<li>**一致性 (Consistency)**：几个并行执行的事务, 其执行结果必须与按某一顺序串行执行的结果相一致。</li>
<li>**隔离性(Isolation)**：事务的执行不受其他事务的干扰，当数据库被多个客户端并发访问时，隔离它们的操作，防止出现：脏读、幻读、不可重复读。</li>
<li>**持久性 (Durability)**：对于任意已提交事务，系统必须保证该事务对数据库的改变不被丢失，即使数据库出现故障。</li>
</ul>
<h2 id="事务的流程"><a href="#事务的流程" class="headerlink" title="事务的流程"></a>事务的流程</h2><p>事务的<strong>起始标志</strong>：oracle中自动开启事务，以DML语句为开启标志。</p>
<blockquote>
<p>执行一个增删改查语句, 只要没有提交commit和回滚rollback, 操作都在一个事务中.</p>
</blockquote>
<p>事务的结束标志: 提交、回滚都是事务的结束标志。</p>
<h3 id="提交与回滚"><a href="#提交与回滚" class="headerlink" title="提交与回滚"></a>提交与回滚</h3><ul>
<li><p>提交</p>
<p>1.显示提交: <code>commit</code><br>2.隐式提交</p>
<ol>
<li><strong>任何DDL语句</strong>，如：<code>create table</code>除了创建表之外还会隐式提交Create之前所有没有提交的DML语句。</li>
<li><strong>正常退出</strong>(exit &#x2F; quit)</li>
</ol>
</li>
<li><p>回滚</p>
<p>1.<strong>显示回滚</strong>: <code>rollback</code><br>2.<strong>隐式回滚</strong>: 掉电、宕机、非正常退出。</p>
</li>
</ul>
<h2 id="控制事务"><a href="#控制事务" class="headerlink" title="控制事务"></a>控制事务</h2><p><strong>保存点（savepoint）</strong>可以防止错误操作影响整个事务，方便进行事务控制。</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210241436648.png" alt="image-20221024143654530"></p>
<ul>
<li><strong>设置保存点</strong>aaa   <code>savepoint aaa;</code></li>
<li><strong>回滚到保存点</strong>aaa   <code>rollback to savepoint aaa;</code></li>
</ul>
<p><code>savepoint</code>主要用于在事务上下文中声明一个中间标记, 将一个长事务分隔为多个较小的部分,和我们编写文档时, 习惯性保存一下一样, 都是为了防止出错和丢失。如果<strong>保存点设置名称重复，则会删除之前的那个保存点</strong>。一旦<strong>commit之后，所有的savepoint将失效</strong>。</p>
<p>回滚的操作,会将<strong>回滚过程中的”设置保存点行为”也回滚掉.</strong></p>
<h2 id="隔离级别"><a href="#隔离级别" class="headerlink" title="隔离级别"></a>隔离级别</h2><p>对于同时运行的多个事务, 当这些事务访问数据库中相同的数据时, 如果没有采取必要的隔离机制, 就会导致各种并发问题:</p>
<ul>
<li><strong>脏读</strong>: 对于两个事物T1, T2; T1读取了已经被T2更新但还没有被提交的字段. 之后, 若 T2 回滚, T1读取的内容就是临时且无效的</li>
<li><strong>不可重复读</strong>: 对于两个事物 T1, T2; T1 读取了一个字段, 然后 T2 更新了该字段. 之后, T1再次读取同一个字段, 值就不同了.</li>
<li><strong>幻读</strong>: 对于两个事物 T1, T2, T1 从一个表中读取了一个字段, 然后 T2 在该表中插入了一些新的行. 之后, 如果 T1 再次读取同一个表, 就会多出几行.</li>
</ul>
<p><strong>数据库事务的隔离性</strong>: 数据库系统必须具有<strong>隔离并发运行各个事务的能力, 使它们不会相互影响, 避免各种并发问题.</strong> </p>
<p>一个事务与其他事务隔离的程度称为<strong>隔离级别</strong>. 数据库规定了多种事务隔离级别, 不同隔离级别对应不同的干扰程度, <strong>隔离级别越高, 数据一致性就越好, 但并发性越弱</strong>.</p>
<h3 id="SQL99定义4中隔离级别"><a href="#SQL99定义4中隔离级别" class="headerlink" title="SQL99定义4中隔离级别"></a>SQL99定义4中隔离级别</h3><ol>
<li><code>Read Uncommitted</code>	读未提交数据。</li>
<li><code>Read Commited</code>	读已提交数据。	（Oracle默认）</li>
<li><code>Repeatable Read</code>	可重复读。		（MySQL默认）</li>
<li><code>Serializable</code>		序列化、串行化。（查询也要等前一个事务结束）</li>
</ol>
<p>Oracle支持的隔离级别： <code>Read Commited</code>（默认）和 <code>Serializable</code>，以及Oracle自定义的<code>Read Only</code>三种。</p>
<p><code>Read Only</code>：由于大多数情况下，在事务操作的过程中，不希望别人也来操作，但是如果将别人的隔离级别设置为Serializable（串行），但是单线程会导致数据库的性能太差。是应该允许别人来进行read操作的。</p>
<h1 id="oracle开发"><a href="#oracle开发" class="headerlink" title="oracle开发"></a>oracle开发</h1><p>oracle开发需要使用<strong>occi库</strong></p>
<ul>
<li>Windows下开发需要先下载开发包,具体操作参考<a target="_blank" rel="noopener" href="https://www.freesion.com/article/4985586791/">此链接</a></li>
<li>Linux下下载oracle安装包有自带,通过<code>locate libocci.so</code>查找</li>
</ul>
<h1 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h1><p>瑞典MySQL AB公司开发，由SUN收购，而后SUN被甲骨文并购，目前属于Oracle公司。</p>
<p>MySQL是一种关联数据库管理系统 由于其<strong>体积小、速度快、总体拥有成本低</strong>、MySQL软件采用了双授权政策，分为社区版和企业版。</p>
<p>oracle部分linux系统用不了,但mysql没有这个问题</p>
<h2 id="MySQL版本及下载"><a href="#MySQL版本及下载" class="headerlink" title="MySQL版本及下载"></a>MySQL版本及下载</h2><p>MySQL数据库版本相对比较繁杂。常见的有：<code>Community</code>社区版、<code>Enterprise</code>企业版。</p>
<ul>
<li><code>Community</code>版是开源免费的，这也是我们通常用的MySQL的版本。可以满足绝大多数用户需求。</li>
<li><code>Enterprise</code>版，官方指出提供30天免费试用期。可进一步划分为MySQL标准版、MySQL企业版、MySQL集群版。官方提供付费服务。</li>
</ul>
<p>其中<code>Community Server</code> 可以直接从mysql 的官网下载。但E<code>nterprice Edition</code>只能从<code>Oracle edelivery</code>上下载，而<code>Edelivery</code>有时会屏蔽中国IP。</p>
<p>下载mysql时注意区分版本细节及所应用的系统平台：linux(32&#x2F;64) 、win(32&#x2F;64)</p>
<p>GA 是指软件的通用版本，一般指正式发布的版本 <code>(Generally Available (GA) Release)</code></p>
<ul>
<li><code>mysql-essential-5.1.60-win32.msi</code>精简版，如果只需要mysql服务，就选择此版本。</li>
<li><code>mysql-5.1.60-win32.msi</code> 完整版，包含安装程序和配置向导，有MySQL文档。  </li>
<li><code>mysql-noinstall-5.1.60-win32.zip</code> 是非安装的zip压缩包，没有自动安装程序和配置向导，无安装向导</li>
<li><code>mysql-5.1.60.zip</code> 是用于windows的Mysql源码压缩包</li>
</ul>
<p>默认情况下,linux都会有mysql</p>
<h3 id="ret-hat"><a href="#ret-hat" class="headerlink" title="ret hat"></a>ret hat</h3><h4 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h4><p><strong>red hat linux演示如何卸载mysql</strong></p>
<p>在终端提示符输入：<code>rpm -aq | grep -i mysql</code>	命令。查询mysql是否安装</p>
<p><strong>卸载旧的版本操作</strong></p>
<ol>
<li><p><code>rpm -e 软件包名 --nodeps --allmatches</code> (不理会依赖关系，删除所有上一步查出来的相同的mysql)</p>
<p><code>rpm -e mysql-connector-odbc-3.51.26r1127-1.el5 --nodeps --allmatches</code></p>
<p><code>rpm -e libdbi-dbd-mysql-0.8.1a-1.2.2 --nodeps --allmatches</code></p>
<p><code>rpm -e mysql-server-5.0.77-3.el5 --nodeps --allmatches</code></p>
</li>
<li><p>将老版本的几个残留文件手动删除</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rm -f /etc/my.cnf</span><br><span class="line">rm -rf /var/lib/mysql</span><br><span class="line">rm -rf /var/share/mysql</span><br><span class="line">rm -rf /usr/bin/mysql*</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p><strong>red hat linux演示如何安装mysql</strong></p>
<p>解压.zip安装包<br><code>unzip V46610-01-MySQL Database 5.6.20 RPM for Oracle Linux RHEL 6 x86 (64bit).zip</code></p>
<p>得到如下软件包</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//下面三个必装</span></span><br><span class="line">MySQL-client-advanced<span class="number">-5.6</span><span class="number">.20</span><span class="number">-1.</span>el6.x86_64.rpm</span><br><span class="line">MySQL-devel-advanced<span class="number">-5.6</span><span class="number">.20</span><span class="number">-1.</span>el6.x86_64.rpm</span><br><span class="line">MySQL-server-advanced<span class="number">-5.6</span><span class="number">.20</span><span class="number">-1.</span>el6.x86_64.rpm</span><br><span class="line"><span class="comment">//下面可选</span></span><br><span class="line">MySQL-embedded-advanced<span class="number">-5.6</span><span class="number">.20</span><span class="number">-1.</span>el6.x86_64.rpm</span><br><span class="line">MySQL-shared-advanced<span class="number">-5.6</span><span class="number">.20</span><span class="number">-1.</span>el6.x86_64.rpm</span><br><span class="line">MySQL-shared-compat-advanced<span class="number">-5.6</span><span class="number">.20</span><span class="number">-1.</span>el6.x86_64.rpm</span><br><span class="line">MySQL-test-advanced<span class="number">-5.6</span><span class="number">.20</span><span class="number">-1.</span>el6.x86_64.rpm</span><br><span class="line"><span class="comment">//可以参考README.txt</span></span><br><span class="line">README.txt</span><br></pre></td></tr></table></figure>

<p>安装服务器  <code>rpm -ivh MySQL-server-advanced-5.6.****-1.el6.x86_64.rpm</code></p>
<p>第一次安装,会自动生成一个文件<code>/root/.mysql_secret</code>,文件内含mysql的root用户的密码.因此必须在第一次连接的时候修改此处的密码</p>
<p><code>mysql_secure_installation</code> 配置安全选项</p>
<p>默认配置设置文件在 <code>/usr/my.cnf</code> ,可以编辑这个 文件改变mysql服务器设置</p>
<h5 id="安装客户端"><a href="#安装客户端" class="headerlink" title="安装客户端"></a>安装客户端</h5><p><code>rpm -ivh MySQL-client-advanced-5.6.****-1.el6.x86_64.rpm</code></p>
<p>说明:不安装<code>mysql-client</code>是不能使用mysql工具登陆到mysql数据库</p>
<p>修改密码  <code>mysql&gt; set password=password(&#39;123456&#39;); 	将密码设置为：123456</code></p>
<h3 id="ubuntu"><a href="#ubuntu" class="headerlink" title="ubuntu"></a>ubuntu</h3><h4 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h4><p>ubuntu下安装:  <code>apt-get install mysql-server</code>     (root无初始密码)</p>
<p>设置MySQL的root初始密码:  <code>ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED WITH mysql_native_password BY &#39;your_password&#39;;</code></p>
<p><code>mysql_secure_installation</code>这个命令设置mysql安全配置向导</p>
<ol>
<li><p>是否建立密码验证插件（用以验证密码强度）：n</p>
</li>
<li><p>首次运行则会要求输入并确认root密码，设置过第2步的root初始密码则会提示是否修改密码。</p>
<p>如果遇到以下报错，请先执行上面第2步的设置root初始密码：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Failed! Error: SET PASSWORD has no significance for user ‘root’@’localhost’ as the authentication method used doesn’t store authentication data in the MySQL server. Please consider using ALTER USER instead if you want to change authentication parameters.</span><br></pre></td></tr></table></figure>
</li>
<li><p>是否删除匿名用户：y</p>
</li>
<li><p>是否禁止root远程登陆：n</p>
</li>
<li><p>是否删除test数据库：y</p>
</li>
<li><p>刷新权限：y</p>
</li>
</ol>
<p>给root账号开放所有权限:  <code>GRANT ALL PRIVILEGES ON *.* TO root@&#39;localhost&#39;;</code></p>
<p>检查mysql服务状态  <code>sudo systemctl status mysql</code></p>
<p>mysql服务的启动&#x2F;停止&#x2F;重启</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动MySQL服务</span></span><br><span class="line">service mysql start</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">停止MySQL服务</span></span><br><span class="line">service mysql stop</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重启MySQL服务</span></span><br><span class="line">service mysql restart</span><br></pre></td></tr></table></figure>

<p>如果要安装客户端和开发组件要分别执行下面语句</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install libmysqlclient-dev	</span><br><span class="line">sudo apt-get install mysql-client</span><br></pre></td></tr></table></figure>

<h4 id="卸载-1"><a href="#卸载-1" class="headerlink" title="卸载"></a>卸载</h4><p><code>apt autoremove mysql-server</code></p>
<h2 id="mysql的基本操作"><a href="#mysql的基本操作" class="headerlink" title="mysql的基本操作"></a>mysql的基本操作</h2><p><code>mysql -u用户名 -p密码</code>进入mysql命令行    e.g.<code>mysql -uroot -p12345</code></p>
<p>退出登录 <code>quit/exit</code></p>
<h3 id="数据库CURD"><a href="#数据库CURD" class="headerlink" title="数据库CURD"></a>数据库CURD</h3><p>对数据库进行增(create)、删(delete)、改(update)、查(Retrieve)操作</p>
<p><strong>[注意] mysql中数据库名和表名都区分大小写</strong></p>
<p><strong>组织结构</strong></p>
<ul>
<li>oracle是先有库,库下是用户,用户下再有表</li>
<li>mysql是先有用户,用户下是库,库下是表</li>
</ul>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301136512.png" alt="image-20221030113604065"></p>
<p>操作盘点</p>
<ul>
<li><p><strong>显示已有的所有数据库</strong> <code>show databases</code></p>
</li>
<li><p><strong>显示建数据库的语句</strong> <code>show create database 数据库名</code></p>
</li>
<li><p><strong>新建数据库</strong>  <code>create database 数据库名</code></p>
<p>创建字符集为utf-8的数据库:<code>create database 数据库名 character set utf8;</code> </p>
<p>创建字符集为utf-8并会对存入的数据进行检查是否utf8格式的数据库 <code>create database 数据库名 character set utf8 collate utf8_general_ci;</code></p>
<p>如果不存在才新建数据库  <code>create database if not exists 数据库名</code></p>
</li>
<li><p><strong>删除数据库</strong>  <code>drop database 数据库名</code></p>
</li>
<li><p>修改数据库字符集(不能修改数据库名) <code>alter database 数据库名 character set utf8;</code></p>
</li>
<li><p>进入数据库  <code>use 数据库名</code></p>
</li>
<li><p>查看当前使用的是哪个库 <code>status;</code> 或 <code>select database() from dual;</code></p>
</li>
<li><p><code>source sql脚本文件路径</code> 用该命令执行上面的sql脚本文件.<a href="#mysql%E7%9A%84%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2">点击参考</a></p>
</li>
</ul>
<p>p.s.  默认情况下,反引号 &#96;&#96; &#96; 括起来的字符串,区分大小写.</p>
<h3 id="表CURD"><a href="#表CURD" class="headerlink" title="表CURD"></a>表CURD</h3><p>mysql的表curd操作和oracle是几乎一样的,只有<a href="#mysql%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">数据类型</a>不一致.</p>
<p><a href="#%E8%A1%A8">跳转方便对比oracle的表curd</a></p>
<h4 id="mysql的数据类型"><a href="#mysql的数据类型" class="headerlink" title="mysql的数据类型"></a>mysql的数据类型</h4><p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301356829.png" alt="image-20221030135621392"></p>
<p>p.s.  (附加说明)</p>
<ul>
<li><code>bit</code>     1位　	可以指定位数，如：bit(3)</li>
<li><code>int</code>     2字节 	可以指定最大位数，如：int&lt;4&gt;　最大为4位的整数</li>
<li><code>float</code>   2个字节　可以指定最大的位数和最大的小数位数，如：float&lt;5,2&gt; 最大为一个5位的数，小数位最多2位 </li>
<li><code>double</code>　4个字节　可以指定最大的位数和最大的小数位数，如：float&lt;6,4&gt; 最大为一个6位的数，小数位最多4位</li>
<li><code>char</code>　  必须指定字符数,如char(5) 为不可变字符　即使存储的内容为’ab’,也是用5个字符的空间存储这个数据</li>
<li><code>varchar</code>　必须指定字符数,如varchar(5) 为可变字符　如果存储的内容为’ab’,占用2个字符的空间；如果为’abc’,则占用3个字符的空间</li>
<li><code>text</code>: 大文本(大字符串)</li>
<li><code>blob</code>：二进制大数据　如图片，音频文件，视频文件</li>
<li><code>date</code>: 日期　如：’1921-01-02’</li>
<li><code>datetime</code>: 日期+时间　如：’1921-01-02 12:23:43’</li>
<li><code>timeStamp</code>: 时间戳，自动赋值为当前日期时间</li>
</ul>
<p>在Mysql中显示多行数据应该在查询语句结尾处添加 <code>\G</code>或<code>\g</code>来替换结束标记<code>;</code></p>
<img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301443749.png" alt="image-20221030144335864" style="zoom: 50%;" />

<ul>
<li><strong>创建表</strong>   <code>create table t1 (id int, name varchar(20))</code></li>
<li><strong>查看当前选择的数据库中的表</strong>   <code>show tables;</code></li>
<li><strong>查看表结构</strong>  <code>desc tablename;</code></li>
<li><strong>查看创建表的语法</strong>    <code>show create table t1;</code></li>
<li><strong>更改表名</strong>    <code>rename table employee to worker;</code></li>
<li><strong>增加一个字段</strong>   <code>alter table employee add column height double;</code>   （column关键字在Oracle中，添加则语法错误）</li>
<li><strong>修改一个字段</strong>   <code>alter table employee modify column height float;</code></li>
<li><strong>删除一个字段</strong>   <code>alter table employee drop column height;</code></li>
<li><strong>修改表的字符集</strong>   <code>alter table employee character set gbk;</code></li>
<li><strong>删除employee表</strong>  <code>drop table employee;</code></li>
</ul>
<p>注意:mysql删除表不能使用purge</p>
<h3 id="数据的CURD操作"><a href="#数据的CURD操作" class="headerlink" title="数据的CURD操作"></a>数据的CURD操作</h3><p><strong>和oracle是一样的.</strong></p>
<ul>
<li><p>查询  <code>select id, name as &quot;名字&quot;, salary &quot;月薪&quot;, salary*12 年薪  from employee where id &gt;=2;</code></p>
</li>
<li><p>修改  <code>update employee set salary=10000, resume=&#39;也是一个中牛&#39; where name=&#39;王五&#39;;</code></p>
</li>
<li><p>删除  <code>delete from employee where name=&#39;王五&#39;;</code></p>
<p><code>truncate employee;</code></p>
</li>
<li><p>插入 <code>insert into employee values(1,&#39;张三&#39;,1,&#39;1983-04-27&#39;,15000,&#39;2012-06-24&#39;,&#39;一个大牛&#39;);</code></p>
</li>
</ul>
<h3 id="mysql的分组查询注意点"><a href="#mysql的分组查询注意点" class="headerlink" title="mysql的分组查询注意点"></a>mysql的分组查询注意点</h3><p>在oracle数据库中,<strong>having后面不可以使用别名,mysql可以使用别名</strong>(别名若是中文不要加<code>&quot;&quot;</code>)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#正确的</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(english<span class="operator">+</span>chinese<span class="operator">+</span>math) &quot;总分&quot;,class_id <span class="keyword">from</span> student <span class="keyword">group</span> <span class="keyword">by</span> class_id <span class="keyword">having</span> 总分<span class="operator">&gt;</span><span class="number">1300</span>;</span><br><span class="line">#正确的</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(english<span class="operator">+</span>chinese<span class="operator">+</span>math) 总分,class_id <span class="keyword">from</span> student <span class="keyword">group</span> <span class="keyword">by</span> class_id <span class="keyword">having</span> 总分<span class="operator">&gt;</span><span class="number">1300</span>;</span><br><span class="line">#错误的</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(english<span class="operator">+</span>chinese<span class="operator">+</span>math) &quot;总分&quot;,class_id <span class="keyword">from</span> student <span class="keyword">group</span> <span class="keyword">by</span> class_id <span class="keyword">having</span> &quot;总分&quot;<span class="operator">&gt;</span><span class="number">1300</span>;</span><br><span class="line">#显示<span class="keyword">Empty</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p><strong>尽量使用英文别名</strong></p>
<h3 id="mysql的top-N问题"><a href="#mysql的top-N问题" class="headerlink" title="mysql的top-N问题"></a>mysql的top-N问题</h3><p><a href="#top-N%E9%97%AE%E9%A2%98">oracle中的top-N问题</a>比较复杂,而mysql中很简单</p>
<p>关键词  <strong><code>limit</code></strong></p>
<p>在查询中，经常要返回前几条或者中间某几行数据时，用到<code>limit</code><br>$$<br>limit\ \ offset,rows<br>$$<br>参数说明：<br>**<code>offset</code>**：指定第一个返回记录行的偏移量（即从哪一行开始返回），注意：初始行的偏移量为0。<br>**<code>rows</code>**：返回具体行数。</p>
<p><strong>如果limit后面是一个参数，就是检索前多少行。如果limit后面是2个参数，就是从offset+1行开始，检索rows行记录。</strong></p>
<p><strong>案例</strong></p>
<p>将math成绩从小到大排序,求math成绩在5-8名的学生的信息</p>
<p><code>select * from student order by math limit 4,4;</code></p>
<h3 id="mysql中的函数"><a href="#mysql中的函数" class="headerlink" title="mysql中的函数"></a>mysql中的函数</h3><h4 id="日期时间函数"><a href="#日期时间函数" class="headerlink" title="日期时间函数"></a>日期时间函数</h4><p>MySQL里面时间分为三类：时间、日期、时间戳(含有时分秒的<code>sysdate</code>)。    (在mysql中使用sysdate必须加小括号)</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301726678.png" alt="image-20221030172638699"></p>
<ul>
<li><code>DATA_ADD</code> 等同于 <code>ADDDATE</code> ,<code>DATA_SUB</code>同理</li>
<li><code>CURDATE</code> 等同于 <code>CURRENT_DATE</code>,<code>current_time</code>同理</li>
</ul>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301732417.png" alt="image-20221030173143508"></p>
<p><code>now()</code>   等同于   <code>sysdate()</code>   等同于   <code>current_timestamp()</code></p>
<p>addtime函数用法参考</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301742376.png" alt="image-20221030174159636"></p>
<p>DATE_ADD函数用法参考  (<code>interval</code>是关键词,不能缺少)</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301750340.png" alt="image-20221030175035800"></p>
<p> 上述语句中的函数名, INTERVAL不区分大小写, day, month, year也可以用大写.</p>
<p>DATEDIFF函数用法参考</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301802641.png" alt="image-20221030180213902"></p>
<h5 id="日期格式函数"><a href="#日期格式函数" class="headerlink" title="日期格式函数"></a>日期格式函数</h5><p>日期转字符串<br>$$<br>DATE_FORMAT(date,format)<br>$$</p>
<p>根据format 字符串安排date 值的格式。 </p>
<p>以下说明符可用在 format 字符串中：</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301808026.png" alt="image-20221030180826827"></p>
<p>案例:   <code>select date_format(now(),&#39;%Y-%m-%d %H:%i:%s&#39;);</code></p>
<img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210301811721.png" alt="image-20221030181106873" style="zoom:67%;" />

<h4 id="数学相关函数"><a href="#数学相关函数" class="headerlink" title="数学相关函数"></a>数学相关函数</h4><p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210311123690.png" alt="image-20221031112333528"></p>
<ul>
<li><code>conv(12,10,2)</code> 将12从10进制转换成2进制为1100</li>
<li><code>format(12.015,2)</code> 将12.015保留小数点后两位为12.02</li>
<li><code>mod(3700,300)</code>  求余为100</li>
<li><code>rand</code>函数一般用<code>rand(now())</code></li>
</ul>
<p>还有三角函数,指数等等的一大堆数学函数</p>
<h4 id="字符串相关函数"><a href="#字符串相关函数" class="headerlink" title="字符串相关函数"></a>字符串相关函数</h4><p><strong><code>||</code> 连接字符串 在 MySQL不可以使用。</strong>但mysql的<code>concat</code>函数可以连接多个字符串</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210311420970.png" alt="image-20221031142000017"></p>
<ul>
<li><code>replace</code>  会替换所有符合的字串</li>
<li><code>strcmp</code>  相等返回0,小于返回-1,大于返回1</li>
<li><code>substring</code> 的<code>position</code>可以为负数表示倒数第几个位置开始</li>
</ul>
<h4 id="转换函数-1"><a href="#转换函数-1" class="headerlink" title="转换函数"></a>转换函数</h4><ul>
<li>日期转字符串 :    <code>date_format(date,format)</code>函数</li>
<li>字符串转日期:     <code>str_to_date(string,format)</code>函数</li>
</ul>
<h4 id="滤空函数"><a href="#滤空函数" class="headerlink" title="滤空函数"></a>滤空函数</h4><p>mysql不支持<a href="#%E9%80%9A%E7%94%A8%E5%87%BD%E6%95%B0">nvl函数</a>,取而代之是**<code>ifnull</code>**函数,用法与nvl函数一致.</p>
<blockquote>
<p>注意：<br>Oracle中有一个通用函数，与MYSQL中的<code>ifnull</code>函数名字相近：<code>nullif</code>：如<code>nullif(a, b)</code> 当 a &#x3D; b 时返回null, 不相等的时候返回a值。<code>nullif(&#39;L9,999.99&#39;, &#39;L9,999.99&#39;)</code></p>
</blockquote>
<p>mysql中<code>nullif()</code>函数也存在。</p>
<h3 id="mysql的多表查询"><a href="#mysql的多表查询" class="headerlink" title="mysql的多表查询"></a>mysql的多表查询</h3><p>准备数据</p>
<p>新建scott.sql文件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> scott <span class="type">character</span> <span class="keyword">set</span> utf8;</span><br><span class="line"></span><br><span class="line">use scott;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> bonus</span><br><span class="line">(</span><br><span class="line">        ename <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">        job   <span class="type">VARCHAR</span>(<span class="number">9</span>),</span><br><span class="line">        sal   <span class="type">int</span>,</span><br><span class="line">        comm  <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept</span><br><span class="line">(</span><br><span class="line">        deptno  <span class="type">int</span>  <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">        dname  <span class="type">varchar</span>(<span class="number">14</span>),</span><br><span class="line">        loc    <span class="type">varchar</span>(<span class="number">13</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> dept <span class="keyword">add</span> <span class="keyword">constraint</span> PK_DEPT <span class="keyword">primary</span> key(deptno);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp</span><br><span class="line">(</span><br><span class="line">        empno  <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">        ename  <span class="type">varchar</span>(<span class="number">10</span>),</span><br><span class="line">        job    <span class="type">varchar</span>(<span class="number">9</span>),</span><br><span class="line">        mgr    <span class="type">int</span>,</span><br><span class="line">        hiredate  <span class="type">date</span>,</span><br><span class="line">        sal   <span class="type">int</span>,</span><br><span class="line">        comm    <span class="type">int</span>,</span><br><span class="line">        deptno   <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">add</span> <span class="keyword">constraint</span> PK_EMP <span class="keyword">primary</span> key (empno);</span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">add</span> <span class="keyword">constraint</span> FK_DEPTNO <span class="keyword">foreign</span> key (DEPTNO) <span class="keyword">references</span> dept(deptno);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> salgrade</span><br><span class="line">(</span><br><span class="line">        grade <span class="type">int</span>,</span><br><span class="line">        losal <span class="type">int</span>,</span><br><span class="line">        hisal <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dept <span class="keyword">VALUES</span> (<span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;ACCOUNTING&#x27;</span>, <span class="string">&#x27;NEW YORK&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dept <span class="keyword">VALUES</span> (<span class="string">&#x27;20&#x27;</span>, <span class="string">&#x27;RESEARCH&#x27;</span>, <span class="string">&#x27;DALLAS&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dept <span class="keyword">VALUES</span> (<span class="string">&#x27;30&#x27;</span>, <span class="string">&#x27;SALES&#x27;</span>, <span class="string">&#x27;CHICAGO&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dept <span class="keyword">VALUES</span> (<span class="string">&#x27;40&#x27;</span>, <span class="string">&#x27;OPERATIONS&#x27;</span>, <span class="string">&#x27;BOSTON&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">7369</span>, <span class="string">&#x27;SMITH&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span>, <span class="number">7902</span>,<span class="string">&#x27;1980-12-17&#x27;</span>, <span class="number">800</span>, <span class="keyword">NULL</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">7499</span>, <span class="string">&#x27;ALLEN&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>, <span class="number">7698</span>,<span class="string">&#x27;1981-2-20&#x27;</span>, <span class="number">1600</span>, <span class="number">300</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">7521</span>, <span class="string">&#x27;WARD&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>, <span class="number">7698</span>,<span class="string">&#x27;1981-2-22&#x27;</span>, <span class="number">1250</span>, <span class="number">500</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">7566</span>, <span class="string">&#x27;JONES&#x27;</span>, <span class="string">&#x27;MANAGER&#x27;</span>, <span class="number">7839</span>,<span class="string">&#x27;1981-4-2&#x27;</span>, <span class="number">2975</span>, <span class="keyword">NULL</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">7654</span>, <span class="string">&#x27;MARTIN&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>, <span class="number">7698</span>,<span class="string">&#x27;1981-9-28&#x27;</span>, <span class="number">1250</span>, <span class="number">1400</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">7698</span>, <span class="string">&#x27;BLAKE&#x27;</span>, <span class="string">&#x27;MANAGER&#x27;</span>, <span class="number">7839</span>,<span class="string">&#x27;1981-5-1&#x27;</span>, <span class="number">2850</span>, <span class="keyword">NULL</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">7782</span>, <span class="string">&#x27;CLARK&#x27;</span>, <span class="string">&#x27;MANAGER&#x27;</span>, <span class="number">7839</span>,<span class="string">&#x27;1981-1-9&#x27;</span>, <span class="number">2450</span>, <span class="keyword">NULL</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">7788</span>, <span class="string">&#x27;SCOTT&#x27;</span>, <span class="string">&#x27;ANALYST&#x27;</span>, <span class="number">7566</span>,<span class="string">&#x27;1982-12-9&#x27;</span>, <span class="number">3000</span>, <span class="keyword">NULL</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">7839</span>, <span class="string">&#x27;KING&#x27;</span>, <span class="string">&#x27;PRESIDENT&#x27;</span>, <span class="keyword">NULL</span>,<span class="string">&#x27;1981-11-17&#x27;</span>, <span class="number">5000</span>, <span class="keyword">NULL</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">7844</span>, <span class="string">&#x27;TURNER&#x27;</span>, <span class="string">&#x27;SALESMAN&#x27;</span>, <span class="number">7698</span>,<span class="string">&#x27;1981-9-8&#x27;</span>, <span class="number">1500</span>, <span class="number">0</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">7876</span>, <span class="string">&#x27;ADAMS&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span>, <span class="number">7788</span>,<span class="string">&#x27;1983-1-12&#x27;</span>, <span class="number">1100</span>, <span class="keyword">NULL</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">7900</span>, <span class="string">&#x27;JAMES&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span>, <span class="number">7698</span>,<span class="string">&#x27;1981-12-3&#x27;</span>, <span class="number">950</span>, <span class="keyword">NULL</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">7902</span>, <span class="string">&#x27;FORD&#x27;</span>, <span class="string">&#x27;ANALYST&#x27;</span>, <span class="number">7566</span>,<span class="string">&#x27;1981-12-3&#x27;</span>, <span class="number">3000</span>, <span class="keyword">NULL</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp <span class="keyword">VALUES</span> (<span class="number">7934</span>, <span class="string">&#x27;MILLER&#x27;</span>, <span class="string">&#x27;CLERK&#x27;</span>, <span class="number">7782</span>,<span class="string">&#x27;1982-12-3&#x27;</span>, <span class="number">1300</span>, <span class="keyword">NULL</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> salgrade <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">700</span>,<span class="number">1200</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> salgrade <span class="keyword">values</span>(<span class="number">2</span>,<span class="number">1201</span>,<span class="number">1400</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> salgrade <span class="keyword">values</span>(<span class="number">3</span>,<span class="number">1401</span>,<span class="number">2000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> salgrade <span class="keyword">values</span>(<span class="number">4</span>,<span class="number">2001</span>,<span class="number">3000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> salgrade <span class="keyword">values</span>(<span class="number">5</span>,<span class="number">3001</span>,<span class="number">9999</span>);</span><br></pre></td></tr></table></figure>

<p><code>source /root/scott.sql</code> 用该命令执行上面的sql脚本文件.</p>
<p>得到原始数据</p>
<h4 id="交叉连接"><a href="#交叉连接" class="headerlink" title="交叉连接"></a>交叉连接</h4><p>相当于oracle的<a href="#%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF">笛卡尔积</a></p>
<p>关键词  <strong><code>cross join</code></strong></p>
<p><code>select e.*, d.* from emp e cross join dept d;</code></p>
<h4 id="内连接"><a href="#内连接" class="headerlink" title="内连接"></a>内连接</h4><p>对应oracle中的<a href="#%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5">等值连接</a></p>
<p>只返回满足连接条件的数据（两边都有的才显示）。</p>
<h5 id="SQL99写法"><a href="#SQL99写法" class="headerlink" title="SQL99写法"></a>SQL99写法</h5><p>关键词  <strong><code>[inner] join ... on ...</code></strong>     (inner可以省略)</p>
<p><code>select e.ename,e.job,d.deptno,d.dname from emp e inner join dept d on e.deptno = d.deptno;</code></p>
<h5 id="oracle写法"><a href="#oracle写法" class="headerlink" title="oracle写法"></a>oracle写法</h5><p><code>select e.ename,e.job,d.deptno,d.dname from emp e, dept d where e.deptno = d.deptno;</code></p>
<p>区别盘点:    [,]  —&gt;  [inner join]      [where]  —&gt;  [on]</p>
<h4 id="mysql外连接"><a href="#mysql外连接" class="headerlink" title="mysql外连接"></a>mysql外连接</h4><h5 id="mysql左外连接"><a href="#mysql左外连接" class="headerlink" title="mysql左外连接"></a>mysql左外连接</h5><p>左边有值才显示。     与<a href="#%E5%B7%A6%E5%A4%96%E8%BF%9E%E6%8E%A5">oracle的左外连接</a>仅仅是写法不同,含义一致</p>
<p>关键词   <strong><code>left [outer] join ...   on  ...</code></strong>     (outer可省略)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, d.<span class="operator">*</span></span><br><span class="line">		<span class="keyword">from</span> emp e <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d</span><br><span class="line">		<span class="keyword">on</span> e.deptno<span class="operator">=</span>d.deptno</span><br></pre></td></tr></table></figure>

<h5 id="mysql右外连接"><a href="#mysql右外连接" class="headerlink" title="mysql右外连接"></a>mysql右外连接</h5><p>右边有值才显示。   与<a href="#%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5">oracle的右外连接</a>仅仅是写法不同,含义一致</p>
<p>关键词   <strong><code>right [outer] join ...   on  ... </code></strong>    (outer可省略)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, d.<span class="operator">*</span></span><br><span class="line">		<span class="keyword">from</span> emp e <span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d</span><br><span class="line">		<span class="keyword">on</span> e.deptno<span class="operator">=</span>d.deptno</span><br></pre></td></tr></table></figure>

<p>即可知: SQL99中，外链接取值与关系表达式&#x3D;号左右位置无关。取值跟from后表的书写顺序有关。 </p>
<p><strong>[案例]</strong>   统计各个部门员工总人数-要求显示部门名称</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(e.empno),d.dname <span class="keyword">from</span> emp e <span class="keyword">right</span> <span class="keyword">join</span> dept d <span class="keyword">on</span> e.deptno <span class="operator">=</span> d.deptno <span class="keyword">group</span> <span class="keyword">by</span> dname;</span><br></pre></td></tr></table></figure>

<p><strong>[自连接案例]</strong>   查询员工、老板信息，显示: xxx的老板是xxx</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> concat(e.ename,<span class="string">&#x27;的老板是&#x27;</span>,ifnull(b.ename,<span class="string">&#x27;自己&#x27;</span>)) <span class="keyword">from</span> emp e <span class="keyword">left</span> <span class="keyword">join</span> emp b <span class="keyword">on</span> e.mgr <span class="operator">=</span> b.empno;</span><br></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210311558213.png" alt="image-20221031155836798" style="zoom:67%;" />

<h5 id="mysql满外连接"><a href="#mysql满外连接" class="headerlink" title="mysql满外连接"></a>mysql满外连接</h5><p>任一边有值就会显示。     在oracle中没有对应</p>
<p>关键词    <strong><code>full [outer] join ... on ...</code></strong>      (outer可省略)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> e.<span class="operator">*</span>, d.<span class="operator">*</span></span><br><span class="line">		<span class="keyword">from</span> emp e <span class="keyword">full</span> <span class="keyword">outer</span> <span class="keyword">join</span> dept d		</span><br><span class="line">		<span class="keyword">on</span> e.deptno<span class="operator">=</span>d.deptno</span><br></pre></td></tr></table></figure>

<h3 id="mysql表的约束"><a href="#mysql表的约束" class="headerlink" title="mysql表的约束"></a>mysql表的约束</h3><ul>
<li><strong>定义主键约束</strong>　<code>primary key</code>	不允许为空，不允许重复</li>
<li><strong>定义主键自动增长</strong>　<code>auto_increment</code>  (从1开始,即使插入不填或者手动填null,也会从1开始自动增长给数)</li>
<li><strong>定义唯一约束</strong>　<code>unique</code></li>
<li><strong>定义非空约束</strong>　<code>not null</code></li>
<li><strong>定义外键约束</strong>　<code>constraint ordersid_FK foreign key(ordersid) references orders(id)</code></li>
</ul>
<p><strong>[注意]</strong>  <strong>check约束</strong>在MySQL中语法保留，但<strong>没有效果</strong></p>
<p><strong>案例</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> myclass (</span><br><span class="line">  id <span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">  name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">unique</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student (</span><br><span class="line">  id <span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">  name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">unique</span>,</span><br><span class="line">  passwd <span class="type">varchar</span>(<span class="number">15</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">  classid <span class="type">INT</span>(<span class="number">11</span>),</span><br><span class="line">  <span class="keyword">constraint</span> stu_classid_FK <span class="keyword">foreign</span> key(classid) <span class="keyword">references</span> myclass(id));</span><br></pre></td></tr></table></figure>

<h2 id="mysql中文乱码问题"><a href="#mysql中文乱码问题" class="headerlink" title="mysql中文乱码问题"></a>mysql中文乱码问题</h2><p>查看所有应用的字符集     <code>show variables like &#39;character%&#39;;</code></p>
<blockquote>
<p>关于<code>utf8mb3</code>和<code>utf8mb4</code>，其主要区别在于：<code>most bytes 3</code>和<code>most bytes 4</code>，即最多使用3 &#x2F; 4个字节来表示1个字符！所以，当使用<code>utf8mb4</code>时，可以表示更多字符，例如生僻汉字、冷门符号、emoji表情符号等。</p>
</blockquote>
<p>指定字符集登录数据库(默认是utf8mb4)   <code>mysql -uroot -p123456 --default_character_set=gbk</code></p>
<p>上面语句如果不是和插入时登录数据库使用的同一个字符集,就会中文乱码</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202210311738498.png" alt="image-20221031173810379"></p>
<p>如果使用<code>secureCRT</code>,<code>secureCRT</code>菜单中的Options-Session Options-Category-Terminal-Appearance中可以设置Character encoding设置工具的字符集(如果未设置为utf-8也会显示乱码)</p>
<p>操作系统的语言集</p>
<p>Ubuntu下查看字符集 <code>cat /etc/default/locale</code></p>
<p>red hat下查看字符集 <code>cat /etc/sysconfig/i18n</code></p>
<p>返回显示<code>LANG=&quot;en_US.UTF-8&quot;</code>   表示环境变量LANG &#x3D; 操作系统的菜单按照zh_CN显示,文件存储按照utf8</p>
<p>操作系统本身不是utf-8也会乱码</p>
<p>总结:</p>
<ul>
<li>使用哪种字符集插入的数据,就要用哪种字符集去select查看</li>
<li>操作系统本身必须支持中文的显示</li>
<li>linux客户端工具若不支持中文显示也会显示乱码</li>
</ul>
<h2 id="MYSQL-API"><a href="#MYSQL-API" class="headerlink" title="MYSQL API"></a>MYSQL API</h2><p>访问MySQL服务器，这需要使用mysqlclient库，MySQL的大多数客户端API（除Java和.NET）都是通过这个库来和MySQL服务器通讯的，而这个库正是使用C语言编写的。</p>
<p>可使用mysql -V 命令查看当前系统内所使用的mysql数据库版本信息。MySQL客户端使用 libmysqlclient 库内部的函数访问MySQL服务器。因此我们在编程过程中，如若使用到库内的函数，必须链接函数库，对应的要找到头文件所在目录位置、函数库路径。以便我们在使用gcc编译工具时可以填充参数-I、-L、-l。</p>
<p>从手册中可获知，函数库名为mysqlclient。<br>    因此我们使用命令<code>find / -name libmysqlclient*</code> 或<code>locate *libmysql*</code>(ubuntu下需要下载支持)查找该库的路径。得到<code>/usr/lib/x86_64-linux-gnu/libmysqlclient.a</code>。<br><code>nm /usr/lib/x86_64-linux-gnu/libmysqlclient.a</code>命令可查看库内包含的函数。</p>
<p><strong>链接使用该库。</strong>			<br>    用到头文件<code>&lt;mysql.h&gt;</code>可使用<code>locate mysql.h</code>查看其目录位置<code>/usr/include/mysql/mysql.h</code>。</p>
<p>编译引用库的应用程序</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc hello.c -o hello -I/usr/include/mysql/ -L/usr/lib/x86_64-linux-gnu/ -lmysqlclient </span><br></pre></td></tr></table></figure>

<p>如果链接出错,原因是<strong>某些64位Linux环境</strong>下，动态库配置不完整。需手动指定编译所用的动态库。根据错误提示分析需要加入如下函数库：</p>
<ul>
<li><code>__gxx_personality_v0</code>   		–&gt;	-lstdc++		使用g++相关的环境</li>
<li><code>dlclose/dlopen/dlsym</code>				–&gt;	-ldl			完成用一个程序加载其他动态库的作用。</li>
<li><code>pthread_*</code>						–&gt;-lpthread		线程库</li>
<li>&#96;&#96;my_getsystime’&#x2F;clock_gettime’&#96;	–&gt;-lrt			librt.so是glibc中对real-time的支持库</li>
</ul>
<p>使用<code>ldd</code>命令可以查看该可执行文件运行所依赖的库文件。</p>
<h3 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h3><p><strong>总体印象</strong></p>
<p>使用MySQL库API函数的一般步骤：</p>
<ol>
<li><p><strong>初始化</strong>. 	<code>MYSQL *mysql_init(MYSQL *mysql)</code></p>
</li>
<li><p><strong>错误处理</strong>	<code>unsigned int mysql_errno(MYSQL *mysql)</code> </p>
<p><code>char *mysql_error(MYSQL *mysql);</code></p>
</li>
<li><p><strong>建立连接</strong>.	<code>MYSQL *mysql_real_connect(MYSQL *mysql, const char *host, const char *user, const char *passwd,const char *db, unsigned int port, const char *unix_socket, unsigned long client_flag);</code></p>
</li>
<li><p><strong>执行SQL语句</strong>	<code>int mysql_query(MYSQL *mysql, const char *stmt_str)</code></p>
</li>
<li><p><strong>获取结果</strong>	<code>MYSQL_RES *mysql_store_result(MYSQL *mysql)</code></p>
<p><code>MYSQL_ROW mysql_fetch_row(MYSQL_RES *result)</code></p>
</li>
<li><p><strong>释放内存</strong>	<code>void mysql_free_result(MYSQL_RES *result)</code></p>
</li>
<li><p><strong>关闭连接</strong>	<code>void mysql_close(MYSQL *mysql)</code> </p>
</li>
<li><p><a href="#%E7%BC%96%E7%A0%81%E7%9B%B8%E5%85%B3">编码相关</a></p>
</li>
<li><p><a href="#%E7%BB%93%E6%9E%9C%E9%9B%86%E7%9B%B8%E5%85%B3">结果集相关</a></p>
</li>
</ol>
<h4 id="mysql-init函数"><a href="#mysql-init函数" class="headerlink" title="mysql_init函数"></a>mysql_init函数</h4><p>分配或初始化与<code>mysql_real_connect()</code>相适应的MYSQL对象。如果mysql是NULL指针，该函数将分配、初始化、并返回新对象。否则，将初始化对象，并返回对象的地址。如果<code>mysql_init()</code>分配了新的对象，当调用<code>mysql_close()</code>来关闭连接时。将释放该对象。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MYSQL *<span class="title function_">mysql_init</span><span class="params">(MYSQL *mysql)</span> </span><br></pre></td></tr></table></figure>

<p>返回值:   初始化的MYSQL*句柄。如果无足够内存以分配新的对象，返回NULL。</p>
<h4 id="mysql-real-connect函数"><a href="#mysql-real-connect函数" class="headerlink" title="mysql_real_connect函数"></a>mysql_real_connect函数</h4><p>mysql_real_connect()尝试与运行在主机上的MySQL数据库引擎建立连接。在你能够执行需要有效MySQL连接句柄结构的任何其他API函数之前，mysql_real_connect()必须成功完成。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MYSQL *<span class="title function_">mysql_real_connect</span><span class="params">(</span></span><br><span class="line"><span class="params">  MYSQL *mysql, <span class="comment">//mysql结构体指针</span></span></span><br><span class="line"><span class="params">  <span class="type">const</span> <span class="type">char</span> *host, <span class="comment">//ip地址,NULL或localhost视为本机</span></span></span><br><span class="line"><span class="params">  <span class="type">const</span> <span class="type">char</span> *user, <span class="comment">//用户名,NULL或空字符串视为当前用户</span></span></span><br><span class="line"><span class="params">  <span class="type">const</span> <span class="type">char</span> *passwd, <span class="comment">//密码</span></span></span><br><span class="line"><span class="params">  <span class="type">const</span> <span class="type">char</span> *db, <span class="comment">//数据库名,NULL会将默认数据库设为该值</span></span></span><br><span class="line"><span class="params">  <span class="type">unsigned</span> <span class="type">int</span> port,<span class="comment">//端口号 </span></span></span><br><span class="line"><span class="params">  <span class="type">const</span> <span class="type">char</span> *unix_socket, <span class="comment">//跨网络的话应该填NULL.如果非空,描述了应使用的套接字或命名管道.</span></span></span><br><span class="line"><span class="params">  <span class="type">unsigned</span> <span class="type">long</span> client_flag)</span> <span class="comment">//标志,通常为0,可以设置下面组合,以允许特定功能</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">//返回值,如果失败返回NULL,成功返回mysql(MYSQL结构体指针)</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>标志名称</th>
<th>标志描述</th>
</tr>
</thead>
<tbody><tr>
<td>CLIENT_COMPRESS</td>
<td>使用压缩协议。</td>
</tr>
<tr>
<td>CLIENT_FOUND_ROWS</td>
<td>返回发现的行数（匹配的），而不是受影响的行数。</td>
</tr>
<tr>
<td>CLIENT_IGNORE_SPACE</td>
<td>允许在函数名后使用空格。使所有的函数名成为保留字。</td>
</tr>
<tr>
<td>CLIENT_INTERACTIVE</td>
<td>关闭连接之前，允许interactive_timeout（取代了wait_timeout）秒的不活动时间。客户端的会话wait_timeout变量被设为会话interactive_timeout变量的值。</td>
</tr>
<tr>
<td>CLIENT_LOCAL_FILES</td>
<td>允许LOAD DATA LOCAL处理功能。</td>
</tr>
<tr>
<td>CLIENT_MULTI_STATEMENTS</td>
<td>通知服务器，客户端可能在单个字符串内发送多条语句（由‘;’隔开）。如果未设置该标志，将禁止多语句执行。</td>
</tr>
<tr>
<td>CLIENT_MULTI_RESULTS</td>
<td>通知服务器，客户端能够处理来自多语句执行或存储程序的多个结果集。如果设置了CLIENT_MULTI_STATEMENTS，将自动设置它。</td>
</tr>
<tr>
<td>CLIENT_NO_SCHEMA</td>
<td>禁止<code>db_name.tbl_name.col_name</code>语法。它用于ODBC。如果使用了该语法，它会使分析程序生成错误，在捕获某些ODBC程序中的缺陷时，它很有用。</td>
</tr>
<tr>
<td>CLIENT_ODBC</td>
<td>客户端是ODBC客户端。它将mysqld变得更为ODBC友好。</td>
</tr>
<tr>
<td>CLIENT_SSL</td>
<td>使用SSL（加密协议）。该选项不应由应用程序设置，它是在客户端库内部设置的。</td>
</tr>
</tbody></table>
<p>调用mysql_real_connect之前不要尝试加密密码,密码加密将由客户端API自动处理</p>
<p>使用</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">MYSQL *conn = mysql_real_connect(mysql,<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;@Che77a38&quot;</span>,<span class="string">&quot;myTest&quot;</span>,<span class="number">0</span>,<span class="literal">NULL</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(conn == <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[error]%s&quot;</span>,mysql_error(mysql));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="mysql-query函数"><a href="#mysql-query函数" class="headerlink" title="mysql_query函数"></a>mysql_query函数</h4><p>**[功能]**执行由“Null终结的字符串”查询指向的SQL查询。正常情况下，字符串必须包含1条SQL语句，而且不应为语句添加终结分号<code>;</code>或<code>\g</code>。如果允许多语句执行，字符串可包含多条由分号隔开的语句。</p>
<p>mysql_query函数不单单能完成查询sql的功能，还能完成非select语句在c程序中的执行。是一个十分万能的c程序中执行SQL语句的函数。并且该函数本身直接支持静态SQL。如果语句中包含二进制数据，则需要调用<code>mysql_real_query</code>来执行查询语句。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">mysql_query</span><span class="params">(MYSQL *mysql, <span class="type">const</span> <span class="type">char</span> *query)</span>;</span><br><span class="line"><span class="comment">//如果查询成功，返回0。如果出现错误，返回非0值</span></span><br><span class="line"><span class="comment">//mysql参数为mysql_real_connect返回值</span></span><br><span class="line"><span class="comment">//query为sql执行语句的字符串</span></span><br></pre></td></tr></table></figure>

<ul>
<li>若执行的是**<code>UPDATE, DELETE或INSERT语句</code>**，则可通过<code>mysql_affected_rows()</code>获知受影响的记录数。</li>
<li>若执行的是**<code>SELECT语句</code>**，查询结束后，查询结果被保存在mysql句柄中。需要使用获取结果集的API函数将结果集获取出来。有两种方式可以获取结果集。</li>
</ul>
<p><strong>注意</strong>: <code>mysql_query</code>执行的SQL语句不应为语句添加终结分号（‘;’）或“\g”。</p>
<h4 id="mysql-close函数"><a href="#mysql-close函数" class="headerlink" title="mysql_close函数"></a>mysql_close函数</h4><p>关闭前面打开的连接。如果句柄是由mysql_init()或mysql_connect()自动分配的，mysql_close()还将解除分配由mysql指向的连接句柄。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">mysql_close</span><span class="params">(MYSQL *mysql)</span>;</span><br></pre></td></tr></table></figure>

<h4 id="编码相关"><a href="#编码相关" class="headerlink" title="编码相关"></a>编码相关</h4><h5 id="mysql-character-set-name函数"><a href="#mysql-character-set-name函数" class="headerlink" title="mysql_character_set_name函数"></a>mysql_character_set_name函数</h5><p>为当前连接返回默认的字符集。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">char</span> *<span class="title function_">mysql_character_set_name</span><span class="params">(MYSQL *mysql)</span> </span><br></pre></td></tr></table></figure>

<h5 id="mysql-set-character-set函数"><a href="#mysql-set-character-set函数" class="headerlink" title="mysql_set_character_set函数"></a>mysql_set_character_set函数</h5><p>该函数用于为当前连接设置默认的字符集</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">mysql_set_character_set</span><span class="params">(MYSQL *mysql, <span class="type">char</span> *csname)</span> </span><br></pre></td></tr></table></figure>

<p>返回值:    0表示成功，非0值表示出现错误。 </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置utf8编码集例子</span></span><br><span class="line">mysql_set_charset_name(&amp;mysql, <span class="string">&quot;utf8&quot;</span>)</span><br><span class="line"><span class="comment">//下面也可以</span></span><br><span class="line">mysql_query(mysql, <span class="string">&quot;set names utf8&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="结果集相关"><a href="#结果集相关" class="headerlink" title="结果集相关"></a>结果集相关</h4><p>一种方式是通过<code>mysql_store_result()</code>将整个结果集全部取回来。另一种方式则是调用<code>mysql_use_result()</code>初始化获取操作，但暂时不取回任何记录。视结果集的条目数选择获取结果集的函数。两种方法均通过<code>mysql_fetch_row()</code>来访问每一条记录。</p>
<ul>
<li><a href="#mysql_store_result%E5%87%BD%E6%95%B0"><code>mysql_store_result函数</code></a>    获取结果集</li>
<li><a href="#mysql_fetch_row%E5%87%BD%E6%95%B0"><code>mysql_fetch_row函数</code> </a>   解析结果集</li>
<li><a href="#mysql_free_result%E5%87%BD%E6%95%B0"><code>mysql_free_result函数</code> </a>   释放结果集</li>
<li><a href="#%E8%8E%B7%E5%8F%96%E5%88%97%E6%95%B0%E5%87%BD%E6%95%B0">获取列数函数</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E8%A1%A8%E5%A4%B4%E5%87%BD%E6%95%B0">获取表头函数</a></li>
<li><a href="#mysql_affected_rows%E5%87%BD%E6%95%B0"><code>mysql_affected_rows函数</code></a>      返回影响行数</li>
</ul>
<h5 id="mysql-store-result函数"><a href="#mysql-store-result函数" class="headerlink" title="mysql_store_result函数"></a>mysql_store_result函数</h5><p><strong>获取结果集</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MYSQL_RES *<span class="title function_">mysql_store_result</span><span class="params">(MYSQL *mysql)</span> </span><br><span class="line"><span class="comment">//成功返回MYSQL_RES结果集指针，失败返回NULL。(可以通过判断返回NULL来判断mysql_query是否执行成功)</span></span><br></pre></td></tr></table></figure>

<p><code>MYSQL_RES</code>是一个结构体类型，可以从<code>mysql.h</code>头文件中找到该结构体的定义</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">MYSQL_RES</span> &#123;</span></span><br><span class="line">  <span class="type">uint64_t</span> row_count;<span class="comment">//行数,有多少行</span></span><br><span class="line">  MYSQL_FIELD *fields;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">MYSQL_DATA</span> *<span class="title">data</span>;</span></span><br><span class="line">  MYSQL_ROWS *data_cursor;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> *lengths; <span class="comment">/* column lengths of current row */</span></span><br><span class="line">  MYSQL *handle;          <span class="comment">/* for unbuffered reads */</span></span><br><span class="line">  <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">MYSQL_METHODS</span> *<span class="title">methods</span>;</span></span><br><span class="line">  MYSQL_ROW row;         <span class="comment">/* If unbuffered read */</span></span><br><span class="line">  MYSQL_ROW current_row; <span class="comment">/* buffer to current row */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">MEM_ROOT</span> *<span class="title">field_alloc</span>;</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> field_count, current_field;</span><br><span class="line">  <span class="type">bool</span> eof; <span class="comment">/* Used by mysql_fetch_row */</span></span><br><span class="line">  <span class="comment">/* mysql_stmt_close() had to cancel this result */</span></span><br><span class="line">  <span class="type">bool</span> unbuffered_fetch_cancelled;</span><br><span class="line">  <span class="class"><span class="keyword">enum</span> <span class="title">enum_resultset_metadata</span> <span class="title">metadata</span>;</span></span><br><span class="line">  <span class="type">void</span> *extension;</span><br><span class="line">&#125; MYSQL_RES;</span><br></pre></td></tr></table></figure>

<p><strong>使用案例</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">MYSQL_RES *result = mysql_store_result(mysql);</span><br><span class="line">	<span class="keyword">if</span> (result == <span class="literal">NULL</span>) &#123;</span><br><span class="line">	ret = mysql_errno(mysql);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;mysql_store_result error: %s\n&quot;</span>, mysql_error(mysql));</span><br><span class="line">	<span class="keyword">return</span> ret;	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>该函数调用成功，则SQL查询的结果被保存在result中</p>
<h5 id="mysql-fetch-row函数"><a href="#mysql-fetch-row函数" class="headerlink" title="mysql_fetch_row函数"></a>mysql_fetch_row函数</h5><p><strong>解析结果集</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MYSQL_ROW <span class="title function_">mysql_fetch_row</span><span class="params">(MYSQL_RES *result)</span></span><br><span class="line"><span class="comment">//成功返回下一行的MYSQL_ROW结构。如果没有更多要检索的行或出现了错误，返回NULL</span></span><br><span class="line"><span class="comment">//result为mysql_store_result返回的值</span></span><br></pre></td></tr></table></figure>

<p><strong>使用案例</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MYSQL_ROW row = <span class="literal">NULL</span>;				<span class="comment">//typedef char **MYSQL_ROW;	</span></span><br><span class="line"><span class="keyword">while</span> ((row = mysql_fetch_row(result))) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%s\t%s\t%s\t%s\t%s\t%s\t%s\t%s\n&quot;</span>, row[<span class="number">0</span>],row[<span class="number">1</span>],row[<span class="number">2</span>],row[<span class="number">3</span>],row[<span class="number">4</span>],row[<span class="number">5</span>],row[<span class="number">6</span>],row[<span class="number">7</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>MYSQL_ROW的本质是<code>tupedef char** MYSQL_ROW;</code>,数据信息存储的形式如下图</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202211141522005.png" alt="image-20221114152116545"></p>
<h5 id="mysql-free-result函数"><a href="#mysql-free-result函数" class="headerlink" title="mysql_free_result函数"></a>mysql_free_result函数</h5><p><strong>释放结果集</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">mysql_free_result</span><span class="params">(MYSQL_RES *result)</span>; </span><br><span class="line"><span class="comment">//成功释放参数传递的结果集。没有失败情况。</span></span><br></pre></td></tr></table></figure>

<p><strong>整体案例</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> sSql[<span class="number">255</span>] = <span class="string">&quot;select * from testTable&quot;</span>;</span><br><span class="line">    <span class="type">int</span> ret = mysql_query(conn,sSql);</span><br><span class="line">    <span class="keyword">if</span>(ret!=<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;执行失败\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;执行成功\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    MYSQL_RES* res = mysql_store_result(mysql);</span><br><span class="line">    <span class="keyword">if</span>(res == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,mysql_error(mysql));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        MYSQL_ROW row = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">while</span>((row = mysql_fetch_row(res))!=<span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;id:%s  name:%s\n&quot;</span>,row[<span class="number">0</span>],row[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        mysql_free_result(res);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h5 id="获取列数函数"><a href="#获取列数函数" class="headerlink" title="获取列数函数"></a>获取列数函数</h5><ul>
<li><code>unsigned int mysql_field_count(MYSQL *mysql)</code> 			从<strong>mysql句柄</strong>中获取连接的表有多少列。(表为连接数据库的时候指定了的某张表)</li>
<li><code>unsigned int mysql_num_fields(MYSQL_RES *result)</code> 	从<strong>返回的结果集</strong>中获取有多少列。</li>
</ul>
<h5 id="获取表头函数"><a href="#获取表头函数" class="headerlink" title="获取表头函数"></a>获取表头函数</h5><ul>
<li><code>MYSQL_FIELD *mysql_fetch_fields(MYSQL_RES *result)</code> 全部获取</li>
<li><code>MYSQL_FIELD *mysql_fetch_field(MYSQL_RES *result)</code> 获取单个</li>
</ul>
<p>返回值为**<code>MYSQL_FIELD</code>**结构体指针</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">MYSQL_FIELD</span> &#123;</span></span><br><span class="line">  <span class="type">char</span> *name;               <span class="comment">/* 列名Name of column */</span></span><br><span class="line">  <span class="type">char</span> *org_name;           <span class="comment">/* 原名(有别名的情况下)Original column name, if an alias */</span></span><br><span class="line">  <span class="type">char</span> *table;              <span class="comment">/* 表名Table of column if column was a field */</span></span><br><span class="line">  <span class="type">char</span> *org_table;          <span class="comment">/* 原表名Org table name, if table was an alias */</span></span><br><span class="line">  <span class="type">char</span> *db;                 <span class="comment">/*表的库名 Database for table */</span></span><br><span class="line">  <span class="type">char</span> *catalog;            <span class="comment">/* Catalog for table */</span></span><br><span class="line">  <span class="type">char</span> *def;                <span class="comment">/* Default value (set by mysql_list_fields) */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> length;     <span class="comment">/* Width of column (create length) */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> max_length; <span class="comment">/* Max width for selected set */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> name_length;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> org_name_length;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> table_length;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> org_table_length;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> db_length;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> catalog_length;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> def_length;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> flags;         <span class="comment">/* Div flags */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> decimals;      <span class="comment">/* Number of decimals in field */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> charsetnr;     <span class="comment">/* Character set */</span></span><br><span class="line">  <span class="class"><span class="keyword">enum</span> <span class="title">enum_field_types</span> <span class="title">type</span>;</span> <span class="comment">/* Type of field. See mysql_com.h for types */</span></span><br><span class="line">  <span class="type">void</span> *extension;</span><br><span class="line">&#125; MYSQL_FIELD;</span><br></pre></td></tr></table></figure>

<h5 id="mysql-affected-rows函数"><a href="#mysql-affected-rows函数" class="headerlink" title="mysql_affected_rows函数"></a>mysql_affected_rows函数</h5><p>返回上次UPDATE更改的行数，上次DELETE删除的行数，或上次INSERT语句插入的行数。对于UPDATE、DELETE或INSERT语句，可在mysql_query()后立刻调用。对于SELECT语句，mysql_affected_rows()的工作方式与mysql_num_rows()类似。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">my_ulonglong <span class="title function_">mysql_affected_rows</span><span class="params">(MYSQL *mysql)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>[返回值]</strong> 大于0的整数表明受影响或检索的行数。“0”表示UPDATE语句未更新记录，在查询中没有与WHERE匹配的行，或未执行查询。“-1”表示查询返回错误，或者，对于SELECT查询，在调用mysql_store_result()之前调用了mysql_affected_rows()。由于mysql_affected_rows()返回无符号值，通过比较返回值和“(my_ulonglong)-1”或等效的“(my_ulonglong)~0”，检查是否为“-1”。</p>
<p>如果在连接至mysqld时指定了标志CLIENT_FOUND_ROWS，对于UPDATE语句，mysql_affected_rows()将返回WHERE语句匹配的行数。</p>
<h3 id="mysql客户端编写案例"><a href="#mysql客户端编写案例" class="headerlink" title="mysql客户端编写案例"></a>mysql客户端编写案例</h3><ol>
<li>mysql初始化 – <a href="#mysql_init%E5%87%BD%E6%95%B0">mysql_init()</a></li>
<li>连接mysql数据库 – <a href="#mysql_real_connect%E5%87%BD%E6%95%B0">mysql_real_connect()</a></li>
<li>循环<ol>
<li>打印提示符</li>
<li>读取用户输入的sql语句,判断是否为退出</li>
<li>不是退出的话执行sql语句取出结果集或影响行数打印出来 – <a href="#mysql_store_result%E5%87%BD%E6%95%B0">mysql_store_result()</a>,<a href="#mysql_fetch_row%E5%87%BD%E6%95%B0">mysql_fetch_row()</a>,<a href="#mysql_affected_rows%E5%87%BD%E6%95%B0">mysql_affected_rows()</a></li>
<li>如果要释放结果集 – <a href="#mysql_free_result%E5%87%BD%E6%95%B0">mysql_free_result()</a></li>
</ol>
</li>
<li>关闭连接 – mysql_close()</li>
</ol>
<p><strong>代码</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mysql.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    MYSQL *mysql = mysql_init(<span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">if</span> (mysql == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;错误\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;mysql Init 成功\n&quot;</span>);</span><br><span class="line">    MYSQL *conn = mysql_real_connect(mysql, <span class="string">&quot;localhost&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;@Che77a38&quot;</span>, <span class="string">&quot;myTest&quot;</span>, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (conn == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[error]%s&quot;</span>, mysql_error(mysql));</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;链接成功\n&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">char</span> buf[<span class="number">999</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;MYSQL&gt;&quot;</span>);</span><br><span class="line">        fflush(<span class="built_in">stdout</span>);</span><br><span class="line">        read(STDIN_FILENO, buf, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">        <span class="comment">//去首尾空格</span></span><br><span class="line">        <span class="type">int</span> spaceIndex = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (spaceIndex = <span class="number">0</span>; spaceIndex &lt; <span class="built_in">strlen</span>(buf); spaceIndex++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (buf[spaceIndex] != <span class="string">&#x27; &#x27;</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> commandRealLength = <span class="built_in">strlen</span>(buf) - spaceIndex;</span><br><span class="line">        memmove(buf, buf + spaceIndex, <span class="built_in">strlen</span>(buf) - spaceIndex);</span><br><span class="line">        <span class="comment">// printf(&quot;old:%s\n&quot;,buf);</span></span><br><span class="line">        <span class="built_in">memset</span>(buf + commandRealLength, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf) - commandRealLength);</span><br><span class="line">        <span class="comment">// printf(&quot;new:%s\n&quot;,buf);</span></span><br><span class="line">        <span class="comment">//判断是否只有回车字符</span></span><br><span class="line">        <span class="keyword">if</span> (buf[<span class="number">0</span>] == <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="comment">//去末尾分号</span></span><br><span class="line">        <span class="type">char</span> *p = <span class="built_in">strrchr</span>(buf, <span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (p != <span class="literal">NULL</span>)</span><br><span class="line">            *p = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="comment">// printf(&quot;最终传递的sql指令为：%s\n&quot;, buf);</span></span><br><span class="line">        <span class="keyword">if</span> (strncasecmp(buf, <span class="string">&quot;quit&quot;</span>, <span class="number">4</span>) == <span class="number">0</span> || strncasecmp(buf, <span class="string">&quot;exit&quot;</span>, <span class="number">4</span>) == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            mysql_close(mysql);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;执行命令\n&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (strncasecmp(buf, <span class="string">&quot;select&quot;</span>, <span class="number">6</span>) == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> ret = mysql_query(conn, buf);</span><br><span class="line">            <span class="keyword">if</span> (ret != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;执行失败\n&quot;</span>);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            MYSQL_RES *res = mysql_store_result(mysql);</span><br><span class="line">            <span class="keyword">if</span> (res == <span class="literal">NULL</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, mysql_error(mysql));</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                MYSQL_ROW row = <span class="literal">NULL</span>;</span><br><span class="line">                <span class="type">int</span> colSum = mysql_num_fields(res);</span><br><span class="line">                MYSQL_FIELD *field = mysql_fetch_fields(res);</span><br><span class="line">                <span class="keyword">if</span> (field != <span class="literal">NULL</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">while</span> ((row = mysql_fetch_row(res)) != <span class="literal">NULL</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; colSum; i++)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="comment">/* code */</span></span><br><span class="line">                            <span class="built_in">printf</span>(<span class="string">&quot;%s:%s\t&quot;</span>, field[i].name, row[i]);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                mysql_free_result(res);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> ret = mysql_query(conn, buf);</span><br><span class="line">            <span class="keyword">if</span> (ret != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;执行失败\n&quot;</span>);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;query ok,%d row affected\n&quot;</span>, mysql_affected_rows(mysql));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    mysql_close(mysql);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="MYSQL的事务"><a href="#MYSQL的事务" class="headerlink" title="MYSQL的事务"></a>MYSQL的事务</h3><p>事务相关知识点参考<a href="#%E4%BA%8B%E5%8A%A1">事务章节</a></p>
<ul>
<li>MySQL的事务的默认自动提交的，每执行一个sql语句都自动commit</li>
<li>Oracle的事务是自动打开的(以你执行的一条DML语句为标志)，但每次执行需要手动commit</li>
</ul>
<p>在程序中设置**<code>autocommit</code>**修改MySQL事务的属性。(<strong>每次连接会重新恢复默认,要重新设置</strong>)</p>
<ul>
<li><code>set autocommit = 0</code> 禁止自动提交</li>
<li><code>set autocommit = 1</code> 开启自动提交MySQL中InnoDB引擎才支持事务默认自动提交机制。MYISAM引擎不支持。</li>
</ul>
<h4 id="相关sql语句"><a href="#相关sql语句" class="headerlink" title="相关sql语句"></a>相关sql语句</h4><ul>
<li>开启事务   <code>start transaction</code></li>
<li>设置手动提交   <code>set autocommit = 0</code> </li>
<li>设置自动提交   <code>set autocommit = 1</code> </li>
<li>提交   <code>commit</code></li>
<li>回滚   <code>rollback</code></li>
</ul>
<h4 id="代码案例"><a href="#代码案例" class="headerlink" title="代码案例"></a>代码案例</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;mysql.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SET_TRAN	<span class="string">&quot;SET AUTOCOMMIT=0&quot;</span>  		<span class="comment">//手动commit	</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UNSET_TRAN	<span class="string">&quot;SET AUTOCOMMIT=1&quot;</span>		<span class="comment">//自动commit</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//设置事务为手动提交</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">mysql_OperationTran</span><span class="params">(MYSQL *mysql)</span>  			</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//--开启事务</span></span><br><span class="line">	<span class="type">int</span> ret = mysql_query(mysql, <span class="string">&quot;start transaction&quot;</span>);  </span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mysql_OperationTran query start err: %s\n&quot;</span>, mysql_error(mysql));</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//--设置事务为手动提交</span></span><br><span class="line">	ret = mysql_query(mysql, SET_TRAN);</span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mysql_OperationTran query set err: %s\n&quot;</span>, mysql_error(mysql));</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line">	</span><br><span class="line"><span class="comment">//设置事务为自动提交</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">mysql_AutoTran</span><span class="params">(MYSQL *mysql)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">//--开启事务</span></span><br><span class="line">	<span class="type">int</span> ret = mysql_query(mysql, <span class="string">&quot;start transaction&quot;</span>);  </span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mysql_AutoTran query start err: %s\n&quot;</span>, mysql_error(mysql));</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//--设置事务为自动提交</span></span><br><span class="line">	ret = mysql_query(mysql, UNSET_TRAN);</span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mysql_AutoTran query set err: %s\n&quot;</span>, mysql_error(mysql));</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret;		</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//执行commit，手动提交事务</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">mysql_Commit</span><span class="params">(MYSQL *mysql)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> ret = mysql_query(mysql, <span class="string">&quot;COMMIT&quot;</span>); </span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;commit err: %s\n&quot;</span>, mysql_error(mysql));</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//执行rollback，回滚事务		</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">mysql_Rollback</span><span class="params">(MYSQL *mysql)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> ret = mysql_query(mysql, <span class="string">&quot;ROLLBACK&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;rollback err: %s\n&quot;</span>, mysql_error(mysql));</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DROP_SAMPLE_TABLE <span class="string">&quot;DROP TABLE IF EXISTS test_table&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CREATE_SAMPLE_TABLE <span class="string">&quot;CREATE TABLE test_table(col1 INT,\</span></span></span><br><span class="line"><span class="string"><span class="meta">                                                 col2 VARCHAR(10),\</span></span></span><br><span class="line"><span class="string"><span class="meta">                                                 col3 VARCHAR(10))&quot;</span></span></span><br><span class="line">                                                                                       </span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sql01 <span class="string">&quot;INSERT INTO test_table(col1,col2,col3) VALUES(10, &#x27;AAA&#x27;, &#x27;A1&#x27;)&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sql02 <span class="string">&quot;INSERT INTO test_table(col1,col2,col3) VALUES(20, &#x27;BBB&#x27;, &#x27;B2&#x27;)&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sql03 <span class="string">&quot;INSERT INTO test_table(col1,col2,col3) VALUES(30, &#x27;CCC&#x27;, &#x27;C3&#x27;)&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sql04 <span class="string">&quot;INSERT INTO test_table(col1,col2,col3) VALUES(40, &#x27;DDD&#x27;, &#x27;D4&#x27;)&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> ret = <span class="number">0</span>;</span><br><span class="line">	MYSQL *mysql = mysql_init(<span class="literal">NULL</span>);</span><br><span class="line">	</span><br><span class="line">	mysql = mysql_real_connect(mysql, <span class="string">&quot;localhost&quot;</span>, <span class="string">&quot;root&quot;</span>, <span class="string">&quot;123456&quot;</span>, <span class="string">&quot;mydb2&quot;</span>, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span> (mysql == <span class="literal">NULL</span>) &#123;</span><br><span class="line">		ret = mysql_errno(mysql);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;func mysql_real_connect() err：%d\n&quot;</span>, ret);</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125; 	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot; --- connect ok......\n&quot;</span>);	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (mysql_query(mysql, DROP_SAMPLE_TABLE)) &#123;</span><br><span class="line">	  <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot; DROP TABLE failed\n&quot;</span>);</span><br><span class="line">	  <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot; %s\n&quot;</span>, mysql_error(mysql));</span><br><span class="line">	  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (mysql_query(mysql, CREATE_SAMPLE_TABLE)) &#123;</span><br><span class="line">	  <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot; CREATE TABLE failed\n&quot;</span>);</span><br><span class="line">	  <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot; %s\n&quot;</span>, mysql_error(mysql));</span><br><span class="line">	  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">	&#125;	</span><br><span class="line">	</span><br><span class="line">	ret = mysql_OperationTran(mysql); 	<span class="comment">//开启事务，并修改事务属性为手动commit </span></span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mysql_OperationTran() err:%d\n&quot;</span>, ret);</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	ret = mysql_query(mysql, sql01);	<span class="comment">//向表中插入第一行数据 ‘AAA’</span></span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mysql_query() err:%d\n&quot;</span>, ret);</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	ret = mysql_query(mysql, sql02);	<span class="comment">//向表中插入第二行数据 ‘BBB’</span></span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mysql_query() err:%d\n&quot;</span>, ret);</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	ret = mysql_Commit(mysql); 		<span class="comment">//手动提交事务</span></span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mysql_Commit() err:%d\n&quot;</span>, ret);</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	ret = mysql_AutoTran(mysql); 		<span class="comment">// =再次= 修改事务属性为【自动】commit</span></span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mysql_OperationTran() err:%d\n&quot;</span>, ret);</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	ret = mysql_OperationTran(mysql); 	<span class="comment">// =再次= 修改事务属性为【手动】commit</span></span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mysql_OperationTran() err:%d\n&quot;</span>, ret);</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	ret = mysql_query(mysql, sql03);	<span class="comment">//向表中插入第三行数据 ‘CCC’</span></span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mysql_query() err:%d\n&quot;</span>, ret);</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	ret = mysql_query(mysql, sql04);	<span class="comment">//向表中插入第四行数据 ‘DDD’</span></span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mysql_query() err:%d\n&quot;</span>, ret);</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	ret = mysql_Rollback(mysql);		<span class="comment">//直接rollback操作</span></span><br><span class="line">	<span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mysql_Rollback() err:%d\n&quot;</span>, ret);</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//rollback操作是否能回退掉CCC、DDD的值，取决于事务属性。</span></span><br><span class="line">	mysql_close(mysql);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="预处理类API"><a href="#预处理类API" class="headerlink" title="预处理类API"></a>预处理类API</h3><p>MySQL客户端／服务器协议提供了预处理语句。该功能采用了由<code>mysql_stmt_init()</code>初始化函数返回的<code>MYSQL_STMT</code>语句处理程序数据结构。对于多次执行的语句，预处理执行是一种有效的方式。首先对语句进行解析，为执行作好准备。接下来，在以后使用初始化函数返回的语句句柄执行一次或多次。</p>
<p>对于多次执行的语句，<strong>预处理执行比直接执行快</strong>，主要原因在于，仅对查询执行一次解析操作。在直接执行的情况下，每次执行语句时，均将进行查询。此外，由于每次执行预处理语句时仅需发送参数的数据，从而<strong>减少了网络通信量</strong>。</p>
<p>预处理语句的另一个优点是，它<strong>采用了二进制协议，从而使得客户端和服务器之间的数据传输更有效率。</strong></p>
<blockquote>
<p>性能、调优是数据库编程永恒不变的主题！如果能把SQL语句框架预先处理好，当真正要执行SQL语句时只需要发送对应的参数到对应的SQL框架中，就能提高客户端访问服务器的速度，且数据量小，可以减少网络通信量，提高数据传输效率高。				</p>
</blockquote>
<h4 id="预处理相关函数"><a href="#预处理相关函数" class="headerlink" title="预处理相关函数"></a>预处理相关函数</h4><ul>
<li><a href="#mysql_stmt_init%E5%87%BD%E6%95%B0"><code>mysql_stmt_init()</code></a>				初始化预处理环境句柄。	返回一个结构体指针 <code>MYSQL_STMT *stmt</code></li>
<li><a href="#mysql_stmt_prepare%E5%87%BD%E6%95%B0"><code>mysql_stmt_prepare()</code></a>				向上面句柄中添加SQL语句，带有 <code>(?,?,?)</code> 占位符</li>
<li><a href="#mysql_stmt_param_count%E5%87%BD%E6%95%B0"><code>mysql_stmt_param_count()</code> </a>		求绑定变量的个数(辅助函数)， 有多少个’?’就返回多少</li>
<li><a href="#mysql_stmt_bind_param%E5%87%BD%E6%95%B0"><code>mysql_stmt_bind_param()</code></a>			将?对应的实参，设置到预处理环境句柄中</li>
<li><a href="#mysql_stmt_execute%E5%87%BD%E6%95%B0"><code>mysql_stmt_execute()</code></a>				执行预处理的SQL语句</li>
<li><a href="#mysql_stmt_error%E5%87%BD%E6%95%B0"><code>mysql_stmt_error()</code> </a>	    获取错误消息。</li>
<li><a href="#mysql_stmt_close%E5%87%BD%E6%95%B0"><code>mysql_stmt_close()</code> </a>	    关闭预处理语句</li>
</ul>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202211221646758.png" alt="image-20221122164501715"></p>
<h5 id="mysql-stmt-init函数"><a href="#mysql-stmt-init函数" class="headerlink" title="mysql_stmt_init函数"></a>mysql_stmt_init函数</h5><p>创建MYSQL_STMT句柄。对于该句柄，应使用<a href="#mysql_stmt_close%E5%87%BD%E6%95%B0"><code>mysql_stmt_close(MYSQL_STMT *)</code></a>释放。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MYSQL_STMT *<span class="title function_">mysql_stmt_init</span><span class="params">(MYSQL *mysql)</span>;</span><br><span class="line"><span class="comment">//成功时，返回指向MYSQL_STMT结构的指针。如果内存溢出，返回NULL。</span></span><br></pre></td></tr></table></figure>

<h5 id="mysql-stmt-prepare函数"><a href="#mysql-stmt-prepare函数" class="headerlink" title="mysql_stmt_prepare函数"></a>mysql_stmt_prepare函数</h5><p>准备sql语句框架,字符串必须包含1条SQL语句(通过将问号字符“?”嵌入到SQL字符串的恰当位置)。不应为语句添加终结用分号(‘;’)或\g。 </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">mysql_stmt_prepare</span><span class="params">(MYSQL_STMT *stmt, <span class="type">const</span> <span class="type">char</span> *query, <span class="type">unsigned</span> <span class="type">long</span> length)</span>;</span><br><span class="line"><span class="comment">//query为sql语句字符串,length为sql字符串长度</span></span><br><span class="line"><span class="comment">//如果成功处理了语句，返回0。如果出现错误，返回非0值。 </span></span><br></pre></td></tr></table></figure>

<p>可通过调用<a href="#mysql_stmt_error%E5%87%BD%E6%95%B0"><code>mysql_stmt_error() </code></a>获取错误消息。</p>
<h5 id="mysql-stmt-param-count函数"><a href="#mysql-stmt-param-count函数" class="headerlink" title="mysql_stmt_param_count函数"></a>mysql_stmt_param_count函数</h5><p>返回预处理语句中参数标记符的数目。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">long</span> <span class="title function_">mysql_stmt_param_count</span><span class="params">(MYSQL_STMT *stmt)</span>;</span><br><span class="line"><span class="comment">//表示语句中参数数目的无符号长整数。 </span></span><br></pre></td></tr></table></figure>

<h5 id="mysql-stmt-bind-param函数"><a href="#mysql-stmt-bind-param函数" class="headerlink" title="mysql_stmt_bind_param函数"></a>mysql_stmt_bind_param函数</h5><p><code>mysql_stmt_bind_param()</code>用于为SQL语句中的参数标记符绑定数据，以传递给<code>mysql_stmt_prepare()</code>。它使用<code>MYSQL_BIND</code>结构来提供数据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">my_bool <span class="title function_">mysql_stmt_bind_param</span><span class="params">(MYSQL_STMT *stmt, MYSQL_BIND *bind)</span>;</span><br><span class="line"><span class="comment">//bind应该为MYSQL_BIND数组首地址</span></span><br><span class="line"><span class="comment">//如果绑定成功，返回0。如果出现错误，返回非0值。 </span></span><br></pre></td></tr></table></figure>

<h6 id="MYSQL-BIND结构体"><a href="#MYSQL-BIND结构体" class="headerlink" title="MYSQL_BIND结构体"></a>MYSQL_BIND结构体</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">MYSQL_BIND</span> &#123;</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> *length; <span class="comment">/*问号为字符串类型该项必须赋值,表示字符串长度 output length pointer */</span></span><br><span class="line">  <span class="type">bool</span> *is_null;         <span class="comment">/* 问号缓冲区中的值是否可以为空Pointer to null indicator */</span></span><br><span class="line">  <span class="type">void</span> *buffer;          <span class="comment">/* 指向问号缓冲区的地址buffer to get/put data */</span></span><br><span class="line">  <span class="comment">/* set this if you want to track data truncations happened during fetch */</span></span><br><span class="line">  <span class="type">bool</span> *error;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">char</span> *row_ptr; <span class="comment">/* for the current data position */</span></span><br><span class="line">  <span class="type">void</span> (*store_param_func)(NET *net, <span class="keyword">struct</span> MYSQL_BIND *param);</span><br><span class="line">  <span class="type">void</span> (*fetch_result)(<span class="keyword">struct</span> MYSQL_BIND *, MYSQL_FIELD *, <span class="type">unsigned</span> <span class="type">char</span> **row);</span><br><span class="line">  <span class="type">void</span> (*skip_result)(<span class="keyword">struct</span> MYSQL_BIND *, MYSQL_FIELD *, <span class="type">unsigned</span> <span class="type">char</span> **row);</span><br><span class="line">  <span class="comment">/* output buffer length, must be set when fetching str/binary */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> buffer_length;<span class="comment">//缓冲区长度,字符串要提供</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> offset;              <span class="comment">/* offset position for char/binary fetch */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> length_value;        <span class="comment">/* Used if length is 0 */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> param_number;         <span class="comment">/* For null count and error messages */</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> pack_length;          <span class="comment">/* Internal length for packed data */</span></span><br><span class="line">  <span class="class"><span class="keyword">enum</span> <span class="title">enum_field_types</span> <span class="title">buffer_type</span>;</span> <span class="comment">/* 问号缓冲区的类别buffer type */</span></span><br><span class="line">  <span class="type">bool</span> error_value;                  <span class="comment">/* used if error is 0 */</span></span><br><span class="line">  <span class="type">bool</span> is_unsigned;                  <span class="comment">/* set if integer type is unsigned */</span></span><br><span class="line">  <span class="type">bool</span> long_data_used;               <span class="comment">/* If used with mysql_send_long_data */</span></span><br><span class="line">  <span class="type">bool</span> is_null_value;                <span class="comment">/* Used if is_null is 0 */</span></span><br><span class="line">  <span class="type">void</span> *extension;</span><br><span class="line">&#125; MYSQL_BIND;</span><br></pre></td></tr></table></figure>

<p>buffer_type成员指定的允许值:</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202211221724158.png" alt="image-20221122172303182"></p>
<h5 id="mysql-stmt-execute函数"><a href="#mysql-stmt-execute函数" class="headerlink" title="mysql_stmt_execute函数"></a>mysql_stmt_execute函数</h5><p><code>mysql_stmt_execute()</code>执行与语句句柄相关的预处理查询。在该调用期间，将当前绑定的参数标记符的值发送到服务器，服务器用新提供的数据替换标记符。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">mysql_stmt_execute</span><span class="params">(MYSQL_STMT *stmt)</span>;</span><br><span class="line"><span class="comment">//如果执行成功，返回0。如果出现错误，返回非0值。 </span></span><br></pre></td></tr></table></figure>

<h5 id="mysql-stmt-error函数"><a href="#mysql-stmt-error函数" class="headerlink" title="mysql_stmt_error函数"></a>mysql_stmt_error函数</h5><p>对于由stmt指定的语句，<code>mysql_stmt_error()</code>返回由Null终结的字符串，该字符串包含最近调用的语句API函数的错误消息，该函数或成功或失败。如果未出现错误，返回空字符串(<code>&quot;&quot;</code>)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">char</span> *<span class="title function_">mysql_stmt_error</span><span class="params">(MYSQL_STMT *stmt)</span> </span><br></pre></td></tr></table></figure>

<h5 id="mysql-stmt-close函数"><a href="#mysql-stmt-close函数" class="headerlink" title="mysql_stmt_close函数"></a>mysql_stmt_close函数</h5><p>关闭预处理句柄</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">my_bool <span class="title function_">mysql_stmt_close</span><span class="params">(MYSQL_STMT *)</span>;</span><br><span class="line"><span class="comment">//如果成功释放了语句，返回0。如果出现错误，返回非0值。 </span></span><br></pre></td></tr></table></figure>

<h1 id="oracle和mysql的区别"><a href="#oracle和mysql的区别" class="headerlink" title="oracle和mysql的区别"></a>oracle和mysql的区别</h1><p>oracle要求select和from一定要组合使用,mysql可以没有from</p>
<h1 id="加密相关"><a href="#加密相关" class="headerlink" title="加密相关"></a>加密相关</h1><p>涉及到网络数据传输的且对传输的数据有安全性需求的,就需要传输数据之前对数据进行加密操作,常用的网络通信方式有</p>
<ul>
<li>socket通信 —- 如 socket API编程</li>
<li>http协议通信 —- 如B&#x2F;S模式</li>
</ul>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202212241530981.png" alt="image-20221224153050288"></p>
<p>为保证网络通信时数据的安全,就需要对数据进行加密****</p>
<h2 id="常用的加密的方式"><a href="#常用的加密的方式" class="headerlink" title="常用的加密的方式"></a>常用的加密的方式</h2><h3 id="对称加密"><a href="#对称加密" class="headerlink" title="对称加密"></a>对称加密</h3><p>加密和解密使用的是同一个秘钥</p>
<ul>
<li>秘钥分发困难</li>
<li>加密效率高</li>
<li>安全级别低(相对与非对称加密)</li>
</ul>
<h3 id="非对称加密"><a href="#非对称加密" class="headerlink" title="非对称加密"></a>非对称加密</h3><p>加密和解密所使用的秘钥不同,是一个秘钥对,包含:</p>
<ul>
<li>公钥 — 可以公开的秘钥</li>
<li>私钥 — 不能公开的秘钥</li>
</ul>
<p>传输的数据对谁更重要,谁就拿私钥</p>
<p>加密的过程:使用公钥加密,必须使用私钥解密;使用私钥加密,必须使用公钥解密</p>
<ul>
<li>秘钥分发简单</li>
<li>加密效率低</li>
<li>安全级别高</li>
</ul>
<p>加密需要实现:</p>
<ul>
<li>秘钥生成,秘钥校验</li>
<li>秘钥生成模块应该与实际使用该模块的项目关联程度要低,耦合度要低,一个模块的修改不要影响其他模块</li>
</ul>
<h2 id="常用加密算法"><a href="#常用加密算法" class="headerlink" title="常用加密算法"></a>常用加密算法</h2><h3 id="对称加密-1"><a href="#对称加密-1" class="headerlink" title="对称加密"></a>对称加密</h3><h4 id="DES-x2F-3DES"><a href="#DES-x2F-3DES" class="headerlink" title="DES&#x2F;3DES"></a>DES&#x2F;3DES</h4><p>DES-已经被破解</p>
<ul>
<li>要求秘钥长度8字节</li>
<li>在对数据进行加密之前先对数据按每组8个字节进行分组,然后分段进行加密,最后再将每一段加密的数据进行组合</li>
</ul>
<p>3DES-效率低</p>
<ul>
<li>秘钥长度24字节,内部会将秘钥分成3份</li>
<li>同样,需要加密的数据先按每组8个字节进行分组,然后分别使用三份秘钥进行加密—&gt;解密—&gt;加密;</li>
<li>若三份秘钥都相同,其实就是DES加密方式</li>
</ul>
<h4 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h4><p>使用最广泛的对称加密算法</p>
<p>秘钥要求:</p>
<ul>
<li>16字节,24字节,32字节</li>
<li>秘钥长度越大,加密效率越低,但安全性越高</li>
</ul>
<h4 id="其他对称加密算法"><a href="#其他对称加密算法" class="headerlink" title="其他对称加密算法"></a>其他对称加密算法</h4><ul>
<li>TDEA</li>
<li>Blowfish</li>
<li>RC2&#x2F;RC4&#x2F;RC5</li>
<li>IDEA</li>
<li>SKIPJACK</li>
</ul>
<h3 id="非对称加密-1"><a href="#非对称加密-1" class="headerlink" title="非对称加密"></a>非对称加密</h3><ul>
<li>RSA(数字签名和密钥交换)</li>
<li>ECC(椭圆曲线加密算法)</li>
<li>Diffie-Hellman(DH,密钥交换)</li>
<li>El Gamal(数字签名)</li>
<li>DSA(数字签名)</li>
</ul>
<p><strong>Hash算法</strong>  –&gt;  单向散列函数 —- Hash算法不是用于加密的,只能单向转换</p>
<ul>
<li>将任意长度的数据生成一个固定长度的字符串</li>
<li>MD4&#x2F;MD5<ul>
<li>散列值长度16字节</li>
</ul>
</li>
<li>SHA-1<ul>
<li>散列值长度20字节</li>
</ul>
</li>
<li>SHA-2<ul>
<li>SHA224&#x2F;SHA256&#x2F;SHA384&#x2F;SHA512</li>
<li>sha224<ul>
<li>散列值长度:224&#x2F;8&#x3D;28字节</li>
</ul>
</li>
</ul>
</li>
<li>SHA3-224&#x2F;SHA3-256&#x2F;SHA3-384&#x2F;SHA3-512</li>
<li>HMAC</li>
</ul>
<p>注意:Hash算法由于不能逆,所以不能得到原始数据,不能用于加密,多用于数据校验</p>
<h2 id="openssl"><a href="#openssl" class="headerlink" title="openssl"></a>openssl</h2><p>OpenSSL 是一个安全套接字层密码库(由C语言实现的)，囊括主要的密码算法、常用的密钥和证书封装管理功能及SSL协议，并提供丰富的应用程序供测试或其它目的使用。</p>
<p>SSL是Secure Sockets Layer（安全套接层协议）的缩写，可以在Internet上提供秘密性传输。Netscape公司在推出第一个Web浏览器的同时，提出了SSL协议标准。其目标是保证两个应用间通信的保密性和可靠性,可在服务器端和用户端同时实现支持。已经成为Internet上保密通讯的工业标准.https协议就用到了SSL,HTTPS协议是由SSL+HTTP协议构建的可进行加密传输,身份认证的网络协议,比http协议安全</p>
<p>OpenSSL既可以在windows平台下使用,也可以在linux平台下使用,是跨平台的一套加密库</p>
<h3 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h3><h4 id="win下安装"><a href="#win下安装" class="headerlink" title="win下安装"></a>win下安装</h4><p><a target="_blank" rel="noopener" href="http://slproweb.com/products/Win32OpenSSL.html">OpenSSL win版安装路径</a></p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202212311521546.png" alt="image-20221231152119110"></p>
<h4 id="win下使用openssl"><a href="#win下使用openssl" class="headerlink" title="win下使用openssl"></a>win下使用openssl</h4><p>设置项目属性,将openssl的头文件目录和库目录添加到当前项目中</p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202212311525657.png" alt="image-20221231152435770"></p>
<ul>
<li><strong>包含目录</strong>设置为openssl安装目录下的include目录</li>
<li><strong>库目录</strong>设置为openssl安装目录下的lib目录</li>
</ul>
<p>VS中的附加依赖项设置:</p>
<p><strong>项目属性 -&gt; 链接器 -&gt; 输入 -&gt; 附加依赖项</strong></p>
<ul>
<li><strong>libssl.lib</strong></li>
<li><strong>libcrypto.lib</strong></li>
</ul>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202212311543694.png" alt="image-20221231154325461"></p>
<p><img src="https://raw.githubusercontent.com/che77a38/blogImage2/main/202212311543177.png" alt="image-20221231154349203"></p>
<p>将openssl安装目录<code>/bin</code>目录下的两个动态库拷贝到工作目录下: </p>
<ul>
<li><strong><code>libcrypto-1_1-x64.dll</code></strong></li>
<li><strong><code>libssl-1_1-x64.dll</code></strong></li>
</ul>
<p>测试代码:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;openssl/md5.h&gt;</span>		<span class="comment">// md5 头文件</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">getMD5</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* str, <span class="type">char</span>* result)</span></span><br><span class="line">&#123;</span><br><span class="line">	MD5_CTX ctx;</span><br><span class="line">	<span class="comment">// 初始化</span></span><br><span class="line">	MD5_Init(&amp;ctx);</span><br><span class="line">	<span class="comment">// 添加数据</span></span><br><span class="line">	MD5_Update(&amp;ctx, str, <span class="built_in">strlen</span>(str));</span><br><span class="line">	<span class="comment">// 计算结果</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> md[<span class="number">16</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	MD5_Final(md, &amp;ctx);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">sprintf</span>(&amp;result[i * <span class="number">2</span>], <span class="string">&quot;%02x&quot;</span>, md[i]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> result[<span class="number">33</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	getMD5(<span class="string">&quot;hello, md5&quot;</span>, result);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;md5 value: %s\n&quot;</span>, result);</span><br><span class="line">	system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输出结果: </span><br><span class="line">	md5 value: <span class="number">33b</span>3bc8e05b4fcc16bd531dd9adac166</span><br></pre></td></tr></table></figure>

<h4 id="Linux下安装"><a href="#Linux下安装" class="headerlink" title="Linux下安装"></a>Linux下安装</h4><p><a target="_blank" rel="noopener" href="https://github.com/openssl/openssl/tree/OpenSSL_1_1_1-stable">OpenSSL linux版安装路径</a></p>
<p> <code>git clone https://github.com/openssl/openssl.git</code></p>
<p>进入根目录,安装:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./config</span><br><span class="line">make</span><br><span class="line">make test    (可选)</span><br><span class="line">make install   (使用管理员权限执行该命令)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考<strong>源码安装</strong>的安装流程: </p>
<ol>
<li>以下文件, 里边有安装步骤<ol>
<li>readme</li>
<li>readme.md</li>
<li>INSTALL</li>
</ol>
</li>
<li>找 可执行文件 <code>configure</code><ol>
<li>执行这个可执行文件<ol>
<li>检测安装环境</li>
<li>生成 makefile</li>
</ol>
</li>
</ol>
</li>
<li>执行<code>make</code>命令<ol>
<li>编译源代码<ol>
<li>生成了动态库</li>
<li>静态库</li>
<li>可执行程序</li>
</ol>
</li>
</ol>
</li>
<li>安装 <code>make install</code> (需要管理员权限)<ol>
<li>将第三步生成的动态库&#x2F;动态库&#x2F;可执行程序拷贝到对应的系统目录</li>
</ol>
</li>
</ol>
</blockquote>
<p>验证是否安装成功</p>
<p><code>openssl version -a</code></p>
<h4 id="Linux下使用openssl"><a href="#Linux下使用openssl" class="headerlink" title="Linux下使用openssl"></a>Linux下使用openssl</h4><p>使用的代码与<a href="#win%E4%B8%8B%E4%BD%BF%E7%94%A8openssl">此处代码</a>一样</p>
<p>通过gcc编译源文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gcc md5_test.c -o md5 -lssl -lcrypto</span><br><span class="line">执行该命令, 需要加载openssl的两个动态库    </span><br><span class="line">- libssl.so    </span><br><span class="line">- libcrypto.so</span><br></pre></td></tr></table></figure>

<p>查看生成的可执行程序 md5 运行时需要加载的动态库:</p>
<p><code>ldd md5</code></p>
<p>如果找不到,可以使用定位libcrypto.so   <code>locate libcrypto.so</code>  或者 <code>find / -name &quot;libcrypto.so&quot;</code>等语句找到动态库所在目录</p>
<p>将找到的动态库绝对路径添加到  <code>/etc/ls.so.conf</code>  文件夹中,并使用管理员权限执行命令  <code>ldconfig</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/ld.so.conf</span><br><span class="line">将 找到的动态库绝对路径 添加到文件末尾, 保存退出配置文件</span><br><span class="line">更新配置:</span><br><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/blog/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag"># 数据库</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/blog/2022/07/29/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" rel="prev" title="网络编程">
      <i class="fa fa-chevron-left"></i> 网络编程
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#oracle"><span class="nav-number">1.</span> <span class="nav-text">oracle</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#DBA"><span class="nav-number">1.1.</span> <span class="nav-text">DBA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1"><span class="nav-number">1.2.</span> <span class="nav-text">启动数据库服务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Windows"><span class="nav-number">1.2.1.</span> <span class="nav-text">Windows</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Linux"><span class="nav-number">1.2.2.</span> <span class="nav-text">Linux</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%99%BB%E5%BD%95%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1"><span class="nav-number">1.3.</span> <span class="nav-text">登录数据库服务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E6%9C%BA%E7%99%BB%E9%99%86"><span class="nav-number">1.3.1.</span> <span class="nav-text">本机登陆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9C%E7%A8%8B%E7%99%BB%E9%99%86"><span class="nav-number">1.3.2.</span> <span class="nav-text">远程登陆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#oracle%E5%88%9B%E5%BB%BA%E6%A1%88%E4%BE%8B%E8%84%9A%E6%9C%AC"><span class="nav-number">1.3.3.</span> <span class="nav-text">oracle创建案例脚本</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#sql%E5%92%8Csqlplus"><span class="nav-number">2.</span> <span class="nav-text">sql和sqlplus</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#sqlplus%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">2.1.</span> <span class="nav-text">sqlplus常用命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%A1%E7%90%86%E5%91%98%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="nav-number">2.1.1.</span> <span class="nav-text">管理员创建用户</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL%E8%AF%AD%E8%A8%80%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="nav-number">2.2.</span> <span class="nav-text">SQL语言的类型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1"><span class="nav-number">3.</span> <span class="nav-text">数据库对象</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A8"><span class="nav-number">3.1.</span> <span class="nav-text">表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="nav-number">3.1.1.</span> <span class="nav-text">创建表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8"><span class="nav-number">3.1.2.</span> <span class="nav-text">修改表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%A1%A8"><span class="nav-number">3.1.3.</span> <span class="nav-text">删除表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Oracle%E7%9A%84%E5%9B%9E%E6%94%B6%E7%AB%99"><span class="nav-number">3.1.3.1.</span> <span class="nav-text">Oracle的回收站</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%A4%E7%A7%8D%E5%88%A0%E9%99%A4%E6%96%B9%E5%BC%8F"><span class="nav-number">3.1.3.2.</span> <span class="nav-text">两种删除方式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E7%9A%84%E7%BA%A6%E6%9D%9F"><span class="nav-number">3.1.4.</span> <span class="nav-text">表的约束</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%96%E9%94%AE%E7%9A%84%E5%88%A0%E9%99%A4%E7%9B%B8%E5%85%B3"><span class="nav-number">3.1.4.1.</span> <span class="nav-text">外键的删除相关</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#check%E6%A3%80%E6%9F%A5%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="nav-number">3.1.4.2.</span> <span class="nav-text">check检查性约束</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE"><span class="nav-number">3.2.</span> <span class="nav-text">视图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C"><span class="nav-number">3.2.1.</span> <span class="nav-text">视图相关操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95"><span class="nav-number">3.3.</span> <span class="nav-text">索引</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-number">3.3.1.</span> <span class="nav-text">索引的操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BA%8F%E5%88%97"><span class="nav-number">3.4.</span> <span class="nav-text">序列</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-number">3.4.1.</span> <span class="nav-text">序列的操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%BA%8F%E5%88%97%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">3.4.2.</span> <span class="nav-text">使用序列需要注意的问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8C%E4%B9%89%E8%AF%8D"><span class="nav-number">3.5.</span> <span class="nav-text">同义词</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">3.5.1.</span> <span class="nav-text">使用场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8C%E4%B9%89%E8%AF%8D%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-number">3.5.2.</span> <span class="nav-text">同义词的操作</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#sql%E6%8F%92%E5%85%A5%E7%9B%B8%E5%85%B3"><span class="nav-number">4.</span> <span class="nav-text">sql插入相关</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%B9%E5%A4%84%E7%90%86"><span class="nav-number">4.1.</span> <span class="nav-text">批处理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#sql%E4%BF%AE%E6%94%B9%E7%9B%B8%E5%85%B3"><span class="nav-number">5.</span> <span class="nav-text">sql修改相关</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#sql%E5%88%A0%E9%99%A4%E7%9B%B8%E5%85%B3"><span class="nav-number">6.</span> <span class="nav-text">sql删除相关</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#truncate%E5%92%8Cdelete%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">6.1.</span> <span class="nav-text">truncate和delete的区别</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#sql%E6%9F%A5%E8%AF%A2%E7%9B%B8%E5%85%B3"><span class="nav-number">7.</span> <span class="nav-text">sql查询相关</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%ACselect%E8%AF%AD%E5%8F%A5"><span class="nav-number">7.1.</span> <span class="nav-text">基本select语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%BB%E9%87%8D"><span class="nav-number">7.1.1.</span> <span class="nav-text">去重</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">7.1.2.</span> <span class="nav-text">表达式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%AB%E5%90%8D"><span class="nav-number">7.1.3.</span> <span class="nav-text">别名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4"><span class="nav-number">7.1.4.</span> <span class="nav-text">过滤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">7.1.4.1.</span> <span class="nav-text">比较运算符</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9B%86%E5%90%88%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">7.1.4.2.</span> <span class="nav-text">集合运算符</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A8%A1%E7%B3%8A%E6%9F%A5%E6%89%BE"><span class="nav-number">7.1.4.3.</span> <span class="nav-text">模糊查找</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97"><span class="nav-number">7.1.4.4.</span> <span class="nav-text">逻辑运算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B"><span class="nav-number">7.1.4.5.</span> <span class="nav-text">案例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F"><span class="nav-number">7.1.5.</span> <span class="nav-text">排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E7%BB%84"><span class="nav-number">7.1.6.</span> <span class="nav-text">分组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0%E8%BF%87%E6%BB%A4"><span class="nav-number">7.1.7.</span> <span class="nav-text">分组函数过滤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BC%98%E5%8C%96"><span class="nav-number">7.1.7.1.</span> <span class="nav-text">优化</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="nav-number">7.2.</span> <span class="nav-text">单行函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E5%87%BD%E6%95%B0"><span class="nav-number">7.2.1.</span> <span class="nav-text">字符函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0"><span class="nav-number">7.2.2.</span> <span class="nav-text">数值函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BD%AC%E6%8D%A2%E5%87%BD%E6%95%B0"><span class="nav-number">7.2.3.</span> <span class="nav-text">转换函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#to-char%E5%87%BD%E6%95%B0"><span class="nav-number">7.2.3.1.</span> <span class="nav-text">to_char函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#to-number%E5%87%BD%E6%95%B0"><span class="nav-number">7.2.3.2.</span> <span class="nav-text">to_number函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#to-date%E5%87%BD%E6%95%B0"><span class="nav-number">7.2.3.3.</span> <span class="nav-text">to_date函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#date%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="nav-number">7.2.3.4.</span> <span class="nav-text">date的格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%B6%E9%97%B4%E5%92%8C%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="nav-number">7.2.3.5.</span> <span class="nav-text">时间和日期函数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E7%94%A8%E5%87%BD%E6%95%B0"><span class="nav-number">7.2.4.</span> <span class="nav-text">通用函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0"><span class="nav-number">7.3.</span> <span class="nav-text">分组函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#count%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="nav-number">7.3.0.1.</span> <span class="nav-text">count注意点</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E6%9D%A1%E4%BB%B6%E5%87%BD%E6%95%B0"><span class="nav-number">7.4.</span> <span class="nav-text">条件表达式与条件函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#case%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">7.4.1.</span> <span class="nav-text">case条件表达式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#decode%E5%87%BD%E6%95%B0"><span class="nav-number">7.4.2.</span> <span class="nav-text">decode函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="nav-number">7.5.</span> <span class="nav-text">多表查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF"><span class="nav-number">7.5.1.</span> <span class="nav-text">笛卡尔积</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5%E6%9D%A1%E4%BB%B6"><span class="nav-number">7.5.2.</span> <span class="nav-text">连接条件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5"><span class="nav-number">7.5.2.1.</span> <span class="nav-text">等值连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5"><span class="nav-number">7.5.2.2.</span> <span class="nav-text">不等值连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">7.5.2.3.</span> <span class="nav-text">外连接</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">7.5.2.3.1.</span> <span class="nav-text">右外连接</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B7%A6%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">7.5.2.3.2.</span> <span class="nav-text">左外连接</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E8%BF%9E%E6%8E%A5"><span class="nav-number">7.5.2.4.</span> <span class="nav-text">自连接</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">7.6.</span> <span class="nav-text">子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#where%E5%90%8E%E5%AD%90%E6%9F%A5%E8%AF%A2%E6%A1%88%E4%BE%8B"><span class="nav-number">7.6.1.</span> <span class="nav-text">where后子查询案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#select%E5%90%8E%E5%AD%90%E6%9F%A5%E8%AF%A2%E6%A1%88%E4%BE%8B"><span class="nav-number">7.6.2.</span> <span class="nav-text">select后子查询案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#having%E5%90%8E%E5%AD%90%E6%9F%A5%E8%AF%A2%E6%A1%88%E4%BE%8B"><span class="nav-number">7.6.3.</span> <span class="nav-text">having后子查询案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#from%E5%90%8E%E5%AD%90%E6%9F%A5%E8%AF%A2%E6%A1%88%E4%BE%8B"><span class="nav-number">7.6.4.</span> <span class="nav-text">from后子查询案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">7.6.5.</span> <span class="nav-text">多行子查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">7.6.6.</span> <span class="nav-text">单行子查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2%E4%B8%ADnull"><span class="nav-number">7.6.7.</span> <span class="nav-text">子查询中null</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96"><span class="nav-number">7.6.8.</span> <span class="nav-text">子查询优化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#top-N%E9%97%AE%E9%A2%98"><span class="nav-number">7.6.9.</span> <span class="nav-text">top-N问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9B%86%E5%90%88%E8%BF%90%E7%AE%97"><span class="nav-number">7.7.</span> <span class="nav-text">集合运算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E4%BA%9Btips"><span class="nav-number">7.8.</span> <span class="nav-text">一些tips</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B"><span class="nav-number">7.9.</span> <span class="nav-text">综合案例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1"><span class="nav-number">8.</span> <span class="nav-text">事务</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E7%89%B9%E6%80%A7"><span class="nav-number">8.1.</span> <span class="nav-text">事务的特性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="nav-number">8.2.</span> <span class="nav-text">事务的流程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%90%E4%BA%A4%E4%B8%8E%E5%9B%9E%E6%BB%9A"><span class="nav-number">8.2.1.</span> <span class="nav-text">提交与回滚</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%A7%E5%88%B6%E4%BA%8B%E5%8A%A1"><span class="nav-number">8.3.</span> <span class="nav-text">控制事务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">8.4.</span> <span class="nav-text">隔离级别</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SQL99%E5%AE%9A%E4%B9%894%E4%B8%AD%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="nav-number">8.4.1.</span> <span class="nav-text">SQL99定义4中隔离级别</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#oracle%E5%BC%80%E5%8F%91"><span class="nav-number">9.</span> <span class="nav-text">oracle开发</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Mysql"><span class="nav-number">10.</span> <span class="nav-text">Mysql</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#MySQL%E7%89%88%E6%9C%AC%E5%8F%8A%E4%B8%8B%E8%BD%BD"><span class="nav-number">10.1.</span> <span class="nav-text">MySQL版本及下载</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ret-hat"><span class="nav-number">10.1.1.</span> <span class="nav-text">ret hat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%B8%E8%BD%BD"><span class="nav-number">10.1.1.1.</span> <span class="nav-text">卸载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">10.1.1.2.</span> <span class="nav-text">安装</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="nav-number">10.1.1.2.1.</span> <span class="nav-text">安装客户端</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ubuntu"><span class="nav-number">10.1.2.</span> <span class="nav-text">ubuntu</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-1"><span class="nav-number">10.1.2.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%B8%E8%BD%BD-1"><span class="nav-number">10.1.2.2.</span> <span class="nav-text">卸载</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mysql%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-number">10.2.</span> <span class="nav-text">mysql的基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93CURD"><span class="nav-number">10.2.1.</span> <span class="nav-text">数据库CURD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8CURD"><span class="nav-number">10.2.2.</span> <span class="nav-text">表CURD</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#mysql%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">10.2.2.1.</span> <span class="nav-text">mysql的数据类型</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%9A%84CURD%E6%93%8D%E4%BD%9C"><span class="nav-number">10.2.3.</span> <span class="nav-text">数据的CURD操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql%E7%9A%84%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="nav-number">10.2.4.</span> <span class="nav-text">mysql的分组查询注意点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql%E7%9A%84top-N%E9%97%AE%E9%A2%98"><span class="nav-number">10.2.5.</span> <span class="nav-text">mysql的top-N问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql%E4%B8%AD%E7%9A%84%E5%87%BD%E6%95%B0"><span class="nav-number">10.2.6.</span> <span class="nav-text">mysql中的函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0"><span class="nav-number">10.2.6.1.</span> <span class="nav-text">日期时间函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E5%87%BD%E6%95%B0"><span class="nav-number">10.2.6.1.1.</span> <span class="nav-text">日期格式函数</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="nav-number">10.2.6.2.</span> <span class="nav-text">数学相关函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="nav-number">10.2.6.3.</span> <span class="nav-text">字符串相关函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BD%AC%E6%8D%A2%E5%87%BD%E6%95%B0-1"><span class="nav-number">10.2.6.4.</span> <span class="nav-text">转换函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BB%A4%E7%A9%BA%E5%87%BD%E6%95%B0"><span class="nav-number">10.2.6.5.</span> <span class="nav-text">滤空函数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql%E7%9A%84%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="nav-number">10.2.7.</span> <span class="nav-text">mysql的多表查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%A4%E5%8F%89%E8%BF%9E%E6%8E%A5"><span class="nav-number">10.2.7.1.</span> <span class="nav-text">交叉连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5"><span class="nav-number">10.2.7.2.</span> <span class="nav-text">内连接</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#SQL99%E5%86%99%E6%B3%95"><span class="nav-number">10.2.7.2.1.</span> <span class="nav-text">SQL99写法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#oracle%E5%86%99%E6%B3%95"><span class="nav-number">10.2.7.2.2.</span> <span class="nav-text">oracle写法</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mysql%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">10.2.7.3.</span> <span class="nav-text">mysql外连接</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql%E5%B7%A6%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">10.2.7.3.1.</span> <span class="nav-text">mysql左外连接</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql%E5%8F%B3%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">10.2.7.3.2.</span> <span class="nav-text">mysql右外连接</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql%E6%BB%A1%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">10.2.7.3.3.</span> <span class="nav-text">mysql满外连接</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql%E8%A1%A8%E7%9A%84%E7%BA%A6%E6%9D%9F"><span class="nav-number">10.2.8.</span> <span class="nav-text">mysql表的约束</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mysql%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98"><span class="nav-number">10.3.</span> <span class="nav-text">mysql中文乱码问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MYSQL-API"><span class="nav-number">10.4.</span> <span class="nav-text">MYSQL API</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.1.</span> <span class="nav-text">常用函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#mysql-init%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.1.1.</span> <span class="nav-text">mysql_init函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mysql-real-connect%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.1.2.</span> <span class="nav-text">mysql_real_connect函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mysql-query%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.1.3.</span> <span class="nav-text">mysql_query函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mysql-close%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.1.4.</span> <span class="nav-text">mysql_close函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%96%E7%A0%81%E7%9B%B8%E5%85%B3"><span class="nav-number">10.4.1.5.</span> <span class="nav-text">编码相关</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql-character-set-name%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.1.5.1.</span> <span class="nav-text">mysql_character_set_name函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql-set-character-set%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.1.5.2.</span> <span class="nav-text">mysql_set_character_set函数</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%93%E6%9E%9C%E9%9B%86%E7%9B%B8%E5%85%B3"><span class="nav-number">10.4.1.6.</span> <span class="nav-text">结果集相关</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql-store-result%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.1.6.1.</span> <span class="nav-text">mysql_store_result函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql-fetch-row%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.1.6.2.</span> <span class="nav-text">mysql_fetch_row函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql-free-result%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.1.6.3.</span> <span class="nav-text">mysql_free_result函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%88%97%E6%95%B0%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.1.6.4.</span> <span class="nav-text">获取列数函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E8%A1%A8%E5%A4%B4%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.1.6.5.</span> <span class="nav-text">获取表头函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql-affected-rows%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.1.6.6.</span> <span class="nav-text">mysql_affected_rows函数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%BC%96%E5%86%99%E6%A1%88%E4%BE%8B"><span class="nav-number">10.4.2.</span> <span class="nav-text">mysql客户端编写案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MYSQL%E7%9A%84%E4%BA%8B%E5%8A%A1"><span class="nav-number">10.4.3.</span> <span class="nav-text">MYSQL的事务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3sql%E8%AF%AD%E5%8F%A5"><span class="nav-number">10.4.3.1.</span> <span class="nav-text">相关sql语句</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E6%A1%88%E4%BE%8B"><span class="nav-number">10.4.3.2.</span> <span class="nav-text">代码案例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%84%E5%A4%84%E7%90%86%E7%B1%BBAPI"><span class="nav-number">10.4.4.</span> <span class="nav-text">预处理类API</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%84%E5%A4%84%E7%90%86%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.4.1.</span> <span class="nav-text">预处理相关函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql-stmt-init%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.4.1.1.</span> <span class="nav-text">mysql_stmt_init函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql-stmt-prepare%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.4.1.2.</span> <span class="nav-text">mysql_stmt_prepare函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql-stmt-param-count%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.4.1.3.</span> <span class="nav-text">mysql_stmt_param_count函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql-stmt-bind-param%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.4.1.4.</span> <span class="nav-text">mysql_stmt_bind_param函数</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#MYSQL-BIND%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-number">10.4.4.1.4.1.</span> <span class="nav-text">MYSQL_BIND结构体</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql-stmt-execute%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.4.1.5.</span> <span class="nav-text">mysql_stmt_execute函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql-stmt-error%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.4.1.6.</span> <span class="nav-text">mysql_stmt_error函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mysql-stmt-close%E5%87%BD%E6%95%B0"><span class="nav-number">10.4.4.1.7.</span> <span class="nav-text">mysql_stmt_close函数</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#oracle%E5%92%8Cmysql%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">11.</span> <span class="nav-text">oracle和mysql的区别</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8A%A0%E5%AF%86%E7%9B%B8%E5%85%B3"><span class="nav-number">12.</span> <span class="nav-text">加密相关</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E5%8A%A0%E5%AF%86%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="nav-number">12.1.</span> <span class="nav-text">常用的加密的方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86"><span class="nav-number">12.1.1.</span> <span class="nav-text">对称加密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86"><span class="nav-number">12.1.2.</span> <span class="nav-text">非对称加密</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="nav-number">12.2.</span> <span class="nav-text">常用加密算法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86-1"><span class="nav-number">12.2.1.</span> <span class="nav-text">对称加密</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#DES-x2F-3DES"><span class="nav-number">12.2.1.1.</span> <span class="nav-text">DES&#x2F;3DES</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AES"><span class="nav-number">12.2.1.2.</span> <span class="nav-text">AES</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="nav-number">12.2.1.3.</span> <span class="nav-text">其他对称加密算法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86-1"><span class="nav-number">12.2.2.</span> <span class="nav-text">非对称加密</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#openssl"><span class="nav-number">12.3.</span> <span class="nav-text">openssl</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-2"><span class="nav-number">12.3.1.</span> <span class="nav-text">安装</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#win%E4%B8%8B%E5%AE%89%E8%A3%85"><span class="nav-number">12.3.1.1.</span> <span class="nav-text">win下安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#win%E4%B8%8B%E4%BD%BF%E7%94%A8openssl"><span class="nav-number">12.3.1.2.</span> <span class="nav-text">win下使用openssl</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Linux%E4%B8%8B%E5%AE%89%E8%A3%85"><span class="nav-number">12.3.1.3.</span> <span class="nav-text">Linux下安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Linux%E4%B8%8B%E4%BD%BF%E7%94%A8openssl"><span class="nav-number">12.3.1.4.</span> <span class="nav-text">Linux下使用openssl</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ZEROKO14</p>
  <div class="site-description" itemprop="description">你好，欢迎来到ZEROKO14的个人博客</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives/">
        
          <span class="site-state-item-count">29</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/blog/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/blog/tags/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZEROKO14</span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>-->

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/blog/lib/anime.min.js"></script>
  <script src="/blog/lib/velocity/velocity.min.js"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/blog/js/utils.js"></script>

<script src="/blog/js/motion.js"></script>


<script src="/blog/js/schemes/muse.js"></script>


<script src="/blog/js/next-boot.js"></script>


  <script defer src="/blog/lib/three/three.min.js"></script>
    <script defer src="/blog/lib/three/three-waves.min.js"></script>


  




  
<script src="/blog/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
